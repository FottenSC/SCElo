import{j as e,S as pc,T as Ji,I as mc,a as Qi,b as en,P as gc,C as tn,V as fc,L as rn,c as sn,d as xc,e as bc,f as an,R as vc,g as yc,u as wr,h as Ft,i as nn,k as on,O as ca,l as ha,m as Ur,n as wc,o as ln,D as dn,p as jc,q as cn,r as Nc,s as kc,t as hn,v as un,F as pn,w as mn,x as gn,y as fn,z as _c,A as xn}from"./vendor-radix-BKXXgHV1.js";import{a as Sc,r as b,R as bn,u as vn,L as Ke,f as yn,h as wn,d as Mc,g as Cc,N as jn,i as zt,j as Ac,k as ut,H as Ec}from"./vendor-react-n-KJX0tK.js";import{c as Rc}from"./vendor-supabase-D9Bv8xaS.js";import{H as Nn,a as Tc}from"./vendor-charts-lsOVHnVp.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const y of document.querySelectorAll('link[rel="modulepreload"]'))c(y);new MutationObserver(y=>{for(const x of y)if(x.type==="childList")for(const h of x.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&c(h)}).observe(document,{childList:!0,subtree:!0});function n(y){const x={};return y.integrity&&(x.integrity=y.integrity),y.referrerPolicy&&(x.referrerPolicy=y.referrerPolicy),y.crossOrigin==="use-credentials"?x.credentials="include":y.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function c(y){if(y.ep)return;y.ep=!0;const x=n(y);fetch(y.href,x)}})();var ia={},kn,Ei=Sc;kn=ia.createRoot=Ei.createRoot,ia.hydrateRoot=Ei.hydrateRoot;function pt(r,s){const n=b.useRef(null),c="OFC";b.useEffect(()=>{n.current===null&&(n.current=document.title);const y=r==null?void 0:r.trim();return document.title=y?`${c} - ${y}`:c,()=>{if(n.current!==null){const x=y?`${c} - ${y}`:c;document.title===x&&(document.title=n.current)}}},[r,s==null?void 0:s.preserveOnUnmount])}function _n(r){var s,n,c="";if(typeof r=="string"||typeof r=="number")c+=r;else if(typeof r=="object")if(Array.isArray(r)){var y=r.length;for(s=0;s<y;s++)r[s]&&(n=_n(r[s]))&&(c&&(c+=" "),c+=n)}else for(n in r)r[n]&&(c&&(c+=" "),c+=n);return c}function Sn(){for(var r,s,n=0,c="",y=arguments.length;n<y;n++)(r=arguments[n])&&(s=_n(r))&&(c&&(c+=" "),c+=s);return c}const ua="-",Dc=r=>{const s=zc(r),{conflictingClassGroups:n,conflictingClassGroupModifiers:c}=r;return{getClassGroupId:h=>{const w=h.split(ua);return w[0]===""&&w.length!==1&&w.shift(),Mn(w,s)||Oc(h)},getConflictingClassGroupIds:(h,w)=>{const E=n[h]||[];return w&&c[h]?[...E,...c[h]]:E}}},Mn=(r,s)=>{var h;if(r.length===0)return s.classGroupId;const n=r[0],c=s.nextPart.get(n),y=c?Mn(r.slice(1),c):void 0;if(y)return y;if(s.validators.length===0)return;const x=r.join(ua);return(h=s.validators.find(({validator:w})=>w(x)))==null?void 0:h.classGroupId},Ri=/^\[(.+)\]$/,Oc=r=>{if(Ri.test(r)){const s=Ri.exec(r)[1],n=s==null?void 0:s.substring(0,s.indexOf(":"));if(n)return"arbitrary.."+n}},zc=r=>{const{theme:s,prefix:n}=r,c={nextPart:new Map,validators:[]};return Lc(Object.entries(r.classGroups),n).forEach(([x,h])=>{na(h,c,x,s)}),c},na=(r,s,n,c)=>{r.forEach(y=>{if(typeof y=="string"){const x=y===""?s:Ti(s,y);x.classGroupId=n;return}if(typeof y=="function"){if(Ic(y)){na(y(c),s,n,c);return}s.validators.push({validator:y,classGroupId:n});return}Object.entries(y).forEach(([x,h])=>{na(h,Ti(s,x),n,c)})})},Ti=(r,s)=>{let n=r;return s.split(ua).forEach(c=>{n.nextPart.has(c)||n.nextPart.set(c,{nextPart:new Map,validators:[]}),n=n.nextPart.get(c)}),n},Ic=r=>r.isThemeGetter,Lc=(r,s)=>s?r.map(([n,c])=>{const y=c.map(x=>typeof x=="string"?s+x:typeof x=="object"?Object.fromEntries(Object.entries(x).map(([h,w])=>[s+h,w])):x);return[n,y]}):r,Bc=r=>{if(r<1)return{get:()=>{},set:()=>{}};let s=0,n=new Map,c=new Map;const y=(x,h)=>{n.set(x,h),s++,s>r&&(s=0,c=n,n=new Map)};return{get(x){let h=n.get(x);if(h!==void 0)return h;if((h=c.get(x))!==void 0)return y(x,h),h},set(x,h){n.has(x)?n.set(x,h):y(x,h)}}},Cn="!",Fc=r=>{const{separator:s,experimentalParseClassName:n}=r,c=s.length===1,y=s[0],x=s.length,h=w=>{const E=[];let A=0,R=0,T;for(let M=0;M<w.length;M++){let G=w[M];if(A===0){if(G===y&&(c||w.slice(M,M+x)===s)){E.push(w.slice(R,M)),R=M+x;continue}if(G==="/"){T=M;continue}}G==="["?A++:G==="]"&&A--}const W=E.length===0?w:w.substring(R),q=W.startsWith(Cn),$=q?W.substring(1):W,P=T&&T>R?T-R:void 0;return{modifiers:E,hasImportantModifier:q,baseClassName:$,maybePostfixModifierPosition:P}};return n?w=>n({className:w,parseClassName:h}):h},$c=r=>{if(r.length<=1)return r;const s=[];let n=[];return r.forEach(c=>{c[0]==="["?(s.push(...n.sort(),c),n=[]):n.push(c)}),s.push(...n.sort()),s},Pc=r=>({cache:Bc(r.cacheSize),parseClassName:Fc(r),...Dc(r)}),Gc=/\s+/,Uc=(r,s)=>{const{parseClassName:n,getClassGroupId:c,getConflictingClassGroupIds:y}=s,x=[],h=r.trim().split(Gc);let w="";for(let E=h.length-1;E>=0;E-=1){const A=h[E],{modifiers:R,hasImportantModifier:T,baseClassName:W,maybePostfixModifierPosition:q}=n(A);let $=!!q,P=c($?W.substring(0,q):W);if(!P){if(!$){w=A+(w.length>0?" "+w:w);continue}if(P=c(W),!P){w=A+(w.length>0?" "+w:w);continue}$=!1}const M=$c(R).join(":"),G=T?M+Cn:M,ae=G+P;if(x.includes(ae))continue;x.push(ae);const Y=y(P,$);for(let le=0;le<Y.length;++le){const he=Y[le];x.push(G+he)}w=A+(w.length>0?" "+w:w)}return w};function Wc(){let r=0,s,n,c="";for(;r<arguments.length;)(s=arguments[r++])&&(n=An(s))&&(c&&(c+=" "),c+=n);return c}const An=r=>{if(typeof r=="string")return r;let s,n="";for(let c=0;c<r.length;c++)r[c]&&(s=An(r[c]))&&(n&&(n+=" "),n+=s);return n};function Hc(r,...s){let n,c,y,x=h;function h(E){const A=s.reduce((R,T)=>T(R),r());return n=Pc(A),c=n.cache.get,y=n.cache.set,x=w,w(E)}function w(E){const A=c(E);if(A)return A;const R=Uc(E,n);return y(E,R),R}return function(){return x(Wc.apply(null,arguments))}}const Le=r=>{const s=n=>n[r]||[];return s.isThemeGetter=!0,s},En=/^\[(?:([a-z-]+):)?(.+)\]$/i,qc=/^\d+\/\d+$/,Vc=new Set(["px","full","screen"]),Xc=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Yc=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Zc=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Kc=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Jc=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,At=r=>jr(r)||Vc.has(r)||qc.test(r),It=r=>kr(r,"length",nh),jr=r=>!!r&&!Number.isNaN(Number(r)),Ks=r=>kr(r,"number",jr),Lr=r=>!!r&&Number.isInteger(Number(r)),Qc=r=>r.endsWith("%")&&jr(r.slice(0,-1)),Ae=r=>En.test(r),Lt=r=>Xc.test(r),eh=new Set(["length","size","percentage"]),th=r=>kr(r,eh,Rn),rh=r=>kr(r,"position",Rn),sh=new Set(["image","url"]),ah=r=>kr(r,sh,lh),ih=r=>kr(r,"",oh),Br=()=>!0,kr=(r,s,n)=>{const c=En.exec(r);return c?c[1]?typeof s=="string"?c[1]===s:s.has(c[1]):n(c[2]):!1},nh=r=>Yc.test(r)&&!Zc.test(r),Rn=()=>!1,oh=r=>Kc.test(r),lh=r=>Jc.test(r),dh=()=>{const r=Le("colors"),s=Le("spacing"),n=Le("blur"),c=Le("brightness"),y=Le("borderColor"),x=Le("borderRadius"),h=Le("borderSpacing"),w=Le("borderWidth"),E=Le("contrast"),A=Le("grayscale"),R=Le("hueRotate"),T=Le("invert"),W=Le("gap"),q=Le("gradientColorStops"),$=Le("gradientColorStopPositions"),P=Le("inset"),M=Le("margin"),G=Le("opacity"),ae=Le("padding"),Y=Le("saturate"),le=Le("scale"),he=Le("sepia"),K=Le("skew"),me=Le("space"),L=Le("translate"),X=()=>["auto","contain","none"],oe=()=>["auto","hidden","clip","visible","scroll"],Ne=()=>["auto",Ae,s],H=()=>[Ae,s],ne=()=>["",At,It],F=()=>["auto",jr,Ae],fe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],S=()=>["solid","dashed","dotted","double","none"],D=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],z=()=>["start","end","center","between","around","evenly","stretch"],ce=()=>["","0",Ae],ke=()=>["auto","avoid","all","avoid-page","page","left","right","column"],we=()=>[jr,Ae];return{cacheSize:500,separator:":",theme:{colors:[Br],spacing:[At,It],blur:["none","",Lt,Ae],brightness:we(),borderColor:[r],borderRadius:["none","","full",Lt,Ae],borderSpacing:H(),borderWidth:ne(),contrast:we(),grayscale:ce(),hueRotate:we(),invert:ce(),gap:H(),gradientColorStops:[r],gradientColorStopPositions:[Qc,It],inset:Ne(),margin:Ne(),opacity:we(),padding:H(),saturate:we(),scale:we(),sepia:ce(),skew:we(),space:H(),translate:H()},classGroups:{aspect:[{aspect:["auto","square","video",Ae]}],container:["container"],columns:[{columns:[Lt]}],"break-after":[{"break-after":ke()}],"break-before":[{"break-before":ke()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...fe(),Ae]}],overflow:[{overflow:oe()}],"overflow-x":[{"overflow-x":oe()}],"overflow-y":[{"overflow-y":oe()}],overscroll:[{overscroll:X()}],"overscroll-x":[{"overscroll-x":X()}],"overscroll-y":[{"overscroll-y":X()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[P]}],"inset-x":[{"inset-x":[P]}],"inset-y":[{"inset-y":[P]}],start:[{start:[P]}],end:[{end:[P]}],top:[{top:[P]}],right:[{right:[P]}],bottom:[{bottom:[P]}],left:[{left:[P]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Lr,Ae]}],basis:[{basis:Ne()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ae]}],grow:[{grow:ce()}],shrink:[{shrink:ce()}],order:[{order:["first","last","none",Lr,Ae]}],"grid-cols":[{"grid-cols":[Br]}],"col-start-end":[{col:["auto",{span:["full",Lr,Ae]},Ae]}],"col-start":[{"col-start":F()}],"col-end":[{"col-end":F()}],"grid-rows":[{"grid-rows":[Br]}],"row-start-end":[{row:["auto",{span:[Lr,Ae]},Ae]}],"row-start":[{"row-start":F()}],"row-end":[{"row-end":F()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ae]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ae]}],gap:[{gap:[W]}],"gap-x":[{"gap-x":[W]}],"gap-y":[{"gap-y":[W]}],"justify-content":[{justify:["normal",...z()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...z(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...z(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[ae]}],px:[{px:[ae]}],py:[{py:[ae]}],ps:[{ps:[ae]}],pe:[{pe:[ae]}],pt:[{pt:[ae]}],pr:[{pr:[ae]}],pb:[{pb:[ae]}],pl:[{pl:[ae]}],m:[{m:[M]}],mx:[{mx:[M]}],my:[{my:[M]}],ms:[{ms:[M]}],me:[{me:[M]}],mt:[{mt:[M]}],mr:[{mr:[M]}],mb:[{mb:[M]}],ml:[{ml:[M]}],"space-x":[{"space-x":[me]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[me]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ae,s]}],"min-w":[{"min-w":[Ae,s,"min","max","fit"]}],"max-w":[{"max-w":[Ae,s,"none","full","min","max","fit","prose",{screen:[Lt]},Lt]}],h:[{h:[Ae,s,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ae,s,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ae,s,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ae,s,"auto","min","max","fit"]}],"font-size":[{text:["base",Lt,It]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Ks]}],"font-family":[{font:[Br]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ae]}],"line-clamp":[{"line-clamp":["none",jr,Ks]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",At,Ae]}],"list-image":[{"list-image":["none",Ae]}],"list-style-type":[{list:["none","disc","decimal",Ae]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[G]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[G]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...S(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",At,It]}],"underline-offset":[{"underline-offset":["auto",At,Ae]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:H()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ae]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ae]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[G]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...fe(),rh]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",th]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},ah]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[$]}],"gradient-via-pos":[{via:[$]}],"gradient-to-pos":[{to:[$]}],"gradient-from":[{from:[q]}],"gradient-via":[{via:[q]}],"gradient-to":[{to:[q]}],rounded:[{rounded:[x]}],"rounded-s":[{"rounded-s":[x]}],"rounded-e":[{"rounded-e":[x]}],"rounded-t":[{"rounded-t":[x]}],"rounded-r":[{"rounded-r":[x]}],"rounded-b":[{"rounded-b":[x]}],"rounded-l":[{"rounded-l":[x]}],"rounded-ss":[{"rounded-ss":[x]}],"rounded-se":[{"rounded-se":[x]}],"rounded-ee":[{"rounded-ee":[x]}],"rounded-es":[{"rounded-es":[x]}],"rounded-tl":[{"rounded-tl":[x]}],"rounded-tr":[{"rounded-tr":[x]}],"rounded-br":[{"rounded-br":[x]}],"rounded-bl":[{"rounded-bl":[x]}],"border-w":[{border:[w]}],"border-w-x":[{"border-x":[w]}],"border-w-y":[{"border-y":[w]}],"border-w-s":[{"border-s":[w]}],"border-w-e":[{"border-e":[w]}],"border-w-t":[{"border-t":[w]}],"border-w-r":[{"border-r":[w]}],"border-w-b":[{"border-b":[w]}],"border-w-l":[{"border-l":[w]}],"border-opacity":[{"border-opacity":[G]}],"border-style":[{border:[...S(),"hidden"]}],"divide-x":[{"divide-x":[w]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[w]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[G]}],"divide-style":[{divide:S()}],"border-color":[{border:[y]}],"border-color-x":[{"border-x":[y]}],"border-color-y":[{"border-y":[y]}],"border-color-s":[{"border-s":[y]}],"border-color-e":[{"border-e":[y]}],"border-color-t":[{"border-t":[y]}],"border-color-r":[{"border-r":[y]}],"border-color-b":[{"border-b":[y]}],"border-color-l":[{"border-l":[y]}],"divide-color":[{divide:[y]}],"outline-style":[{outline:["",...S()]}],"outline-offset":[{"outline-offset":[At,Ae]}],"outline-w":[{outline:[At,It]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:ne()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[G]}],"ring-offset-w":[{"ring-offset":[At,It]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",Lt,ih]}],"shadow-color":[{shadow:[Br]}],opacity:[{opacity:[G]}],"mix-blend":[{"mix-blend":[...D(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":D()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[c]}],contrast:[{contrast:[E]}],"drop-shadow":[{"drop-shadow":["","none",Lt,Ae]}],grayscale:[{grayscale:[A]}],"hue-rotate":[{"hue-rotate":[R]}],invert:[{invert:[T]}],saturate:[{saturate:[Y]}],sepia:[{sepia:[he]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[c]}],"backdrop-contrast":[{"backdrop-contrast":[E]}],"backdrop-grayscale":[{"backdrop-grayscale":[A]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[R]}],"backdrop-invert":[{"backdrop-invert":[T]}],"backdrop-opacity":[{"backdrop-opacity":[G]}],"backdrop-saturate":[{"backdrop-saturate":[Y]}],"backdrop-sepia":[{"backdrop-sepia":[he]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[h]}],"border-spacing-x":[{"border-spacing-x":[h]}],"border-spacing-y":[{"border-spacing-y":[h]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ae]}],duration:[{duration:we()}],ease:[{ease:["linear","in","out","in-out",Ae]}],delay:[{delay:we()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ae]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[le]}],"scale-x":[{"scale-x":[le]}],"scale-y":[{"scale-y":[le]}],rotate:[{rotate:[Lr,Ae]}],"translate-x":[{"translate-x":[L]}],"translate-y":[{"translate-y":[L]}],"skew-x":[{"skew-x":[K]}],"skew-y":[{"skew-y":[K]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ae]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ae]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":H()}],"scroll-mx":[{"scroll-mx":H()}],"scroll-my":[{"scroll-my":H()}],"scroll-ms":[{"scroll-ms":H()}],"scroll-me":[{"scroll-me":H()}],"scroll-mt":[{"scroll-mt":H()}],"scroll-mr":[{"scroll-mr":H()}],"scroll-mb":[{"scroll-mb":H()}],"scroll-ml":[{"scroll-ml":H()}],"scroll-p":[{"scroll-p":H()}],"scroll-px":[{"scroll-px":H()}],"scroll-py":[{"scroll-py":H()}],"scroll-ps":[{"scroll-ps":H()}],"scroll-pe":[{"scroll-pe":H()}],"scroll-pt":[{"scroll-pt":H()}],"scroll-pr":[{"scroll-pr":H()}],"scroll-pb":[{"scroll-pb":H()}],"scroll-pl":[{"scroll-pl":H()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ae]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[At,It,Ks]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},ch=Hc(dh);function je(...r){return ch(Sn(r))}const Fe=b.forwardRef(({className:r,...s},n)=>e.jsx("div",{ref:n,className:je("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s}));Fe.displayName="Card";const Ye=({className:r,...s})=>e.jsx("div",{className:je("flex flex-col space-y-1.5 p-6",r),...s}),Ze=({className:r,...s})=>e.jsx("h3",{className:je("text-2xl font-semibold leading-none tracking-tight",r),...s}),it=({className:r,...s})=>e.jsx("p",{className:je("text-sm text-muted-foreground",r),...s}),Pe=({className:r,...s})=>e.jsx("div",{className:je("p-6 pt-0",r),...s}),_r=r=>{let s=0;for(let n=0;n<r.length;n++){const c=r.charCodeAt(n);s=(s<<5)-s+c,s=s&s}return Math.abs(s)},Tn=(r,s)=>Math.floor(r/Math.pow(10,s)%10),oa=(r,s)=>!(Tn(r,s)%2),tt=(r,s,n)=>{const c=r%s;return n&&Tn(r,n)%2===0?-c:c},Kt=(r,s,n)=>s[r%n],hh=r=>{r.slice(0,1)==="#"&&(r=r.slice(1));const s=parseInt(r.substr(0,2),16),n=parseInt(r.substr(2,2),16),c=parseInt(r.substr(4,2),16);return(s*299+n*587+c*114)/1e3>=128?"#000000":"#FFFFFF"},uh=4,Ie=80;function ph(r,s){const n=_r(r),c=s&&s.length;return Array.from({length:uh},(y,x)=>({color:Kt(n+x,s,c),translateX:tt(n*(x+1),Ie/2-(x+17),1),translateY:tt(n*(x+1),Ie/2-(x+17),2),rotate:tt(n*(x+1),360),isSquare:oa(n,2)}))}const Di=({name:r,colors:s,title:n,square:c,size:y,...x})=>{const h=ph(r,s),w=b.useId();return e.jsxs("svg",{viewBox:"0 0 "+Ie+" "+Ie,fill:"none",role:"img",xmlns:"http://www.w3.org/2000/svg",width:y,height:y,...x,children:[n&&e.jsx("title",{children:r}),e.jsx("mask",{id:w,maskUnits:"userSpaceOnUse",x:0,y:0,width:Ie,height:Ie,children:e.jsx("rect",{width:Ie,height:Ie,rx:c?void 0:Ie*2,fill:"#FFFFFF"})}),e.jsxs("g",{mask:`url(#${w})`,children:[e.jsx("rect",{width:Ie,height:Ie,fill:h[0].color}),e.jsx("rect",{x:(Ie-60)/2,y:(Ie-20)/2,width:Ie,height:h[1].isSquare?Ie:Ie/8,fill:h[1].color,transform:"translate("+h[1].translateX+" "+h[1].translateY+") rotate("+h[1].rotate+" "+Ie/2+" "+Ie/2+")"}),e.jsx("circle",{cx:Ie/2,cy:Ie/2,fill:h[2].color,r:Ie/5,transform:"translate("+h[2].translateX+" "+h[2].translateY+")"}),e.jsx("line",{x1:0,y1:Ie/2,x2:Ie,y2:Ie/2,strokeWidth:2,stroke:h[3].color,transform:"translate("+h[3].translateX+" "+h[3].translateY+") rotate("+h[3].rotate+" "+Ie/2+" "+Ie/2+")"})]})]})},Vt=90,mh=5;function gh(r,s){const n=_r(r),c=s&&s.length,y=Array.from({length:mh},(h,w)=>Kt(n+w,s,c)),x=[];return x[0]=y[0],x[1]=y[1],x[2]=y[1],x[3]=y[2],x[4]=y[2],x[5]=y[3],x[6]=y[3],x[7]=y[0],x[8]=y[4],x}const fh=({name:r,colors:s,title:n,square:c,size:y,...x})=>{const h=gh(r,s),w=bn.useId();return e.jsxs("svg",{viewBox:"0 0 "+Vt+" "+Vt,fill:"none",role:"img",xmlns:"http://www.w3.org/2000/svg",width:y,height:y,...x,children:[n&&e.jsx("title",{children:r}),e.jsx("mask",{id:w,maskUnits:"userSpaceOnUse",x:0,y:0,width:Vt,height:Vt,children:e.jsx("rect",{width:Vt,height:Vt,rx:c?void 0:Vt*2,fill:"#FFFFFF"})}),e.jsxs("g",{mask:`url(#${w})`,children:[e.jsx("path",{d:"M0 0h90v45H0z",fill:h[0]}),e.jsx("path",{d:"M0 45h90v45H0z",fill:h[1]}),e.jsx("path",{d:"M83 45a38 38 0 00-76 0h76z",fill:h[2]}),e.jsx("path",{d:"M83 45a38 38 0 01-76 0h76z",fill:h[3]}),e.jsx("path",{d:"M77 45a32 32 0 10-64 0h64z",fill:h[4]}),e.jsx("path",{d:"M77 45a32 32 0 11-64 0h64z",fill:h[5]}),e.jsx("path",{d:"M71 45a26 26 0 00-52 0h52z",fill:h[6]}),e.jsx("path",{d:"M71 45a26 26 0 01-52 0h52z",fill:h[7]}),e.jsx("circle",{cx:45,cy:45,r:23,fill:h[8]})]})]})},xh=64,Xt=80;function bh(r,s){const n=_r(r),c=s&&s.length;return Array.from({length:xh},(y,x)=>Kt(n%(x+1),s,c))}const vh=({name:r,colors:s,title:n,square:c,size:y,...x})=>{const h=bh(r,s),w=b.useId();return e.jsxs("svg",{viewBox:"0 0 "+Xt+" "+Xt,fill:"none",role:"img",xmlns:"http://www.w3.org/2000/svg",width:y,height:y,...x,children:[n&&e.jsx("title",{children:r}),e.jsx("mask",{id:w,"mask-type":"alpha",maskUnits:"userSpaceOnUse",x:0,y:0,width:Xt,height:Xt,children:e.jsx("rect",{width:Xt,height:Xt,rx:c?void 0:Xt*2,fill:"#FFFFFF"})}),e.jsxs("g",{mask:`url(#${w})`,children:[e.jsx("rect",{width:10,height:10,fill:h[0]}),e.jsx("rect",{x:20,width:10,height:10,fill:h[1]}),e.jsx("rect",{x:40,width:10,height:10,fill:h[2]}),e.jsx("rect",{x:60,width:10,height:10,fill:h[3]}),e.jsx("rect",{x:10,width:10,height:10,fill:h[4]}),e.jsx("rect",{x:30,width:10,height:10,fill:h[5]}),e.jsx("rect",{x:50,width:10,height:10,fill:h[6]}),e.jsx("rect",{x:70,width:10,height:10,fill:h[7]}),e.jsx("rect",{y:10,width:10,height:10,fill:h[8]}),e.jsx("rect",{y:20,width:10,height:10,fill:h[9]}),e.jsx("rect",{y:30,width:10,height:10,fill:h[10]}),e.jsx("rect",{y:40,width:10,height:10,fill:h[11]}),e.jsx("rect",{y:50,width:10,height:10,fill:h[12]}),e.jsx("rect",{y:60,width:10,height:10,fill:h[13]}),e.jsx("rect",{y:70,width:10,height:10,fill:h[14]}),e.jsx("rect",{x:20,y:10,width:10,height:10,fill:h[15]}),e.jsx("rect",{x:20,y:20,width:10,height:10,fill:h[16]}),e.jsx("rect",{x:20,y:30,width:10,height:10,fill:h[17]}),e.jsx("rect",{x:20,y:40,width:10,height:10,fill:h[18]}),e.jsx("rect",{x:20,y:50,width:10,height:10,fill:h[19]}),e.jsx("rect",{x:20,y:60,width:10,height:10,fill:h[20]}),e.jsx("rect",{x:20,y:70,width:10,height:10,fill:h[21]}),e.jsx("rect",{x:40,y:10,width:10,height:10,fill:h[22]}),e.jsx("rect",{x:40,y:20,width:10,height:10,fill:h[23]}),e.jsx("rect",{x:40,y:30,width:10,height:10,fill:h[24]}),e.jsx("rect",{x:40,y:40,width:10,height:10,fill:h[25]}),e.jsx("rect",{x:40,y:50,width:10,height:10,fill:h[26]}),e.jsx("rect",{x:40,y:60,width:10,height:10,fill:h[27]}),e.jsx("rect",{x:40,y:70,width:10,height:10,fill:h[28]}),e.jsx("rect",{x:60,y:10,width:10,height:10,fill:h[29]}),e.jsx("rect",{x:60,y:20,width:10,height:10,fill:h[30]}),e.jsx("rect",{x:60,y:30,width:10,height:10,fill:h[31]}),e.jsx("rect",{x:60,y:40,width:10,height:10,fill:h[32]}),e.jsx("rect",{x:60,y:50,width:10,height:10,fill:h[33]}),e.jsx("rect",{x:60,y:60,width:10,height:10,fill:h[34]}),e.jsx("rect",{x:60,y:70,width:10,height:10,fill:h[35]}),e.jsx("rect",{x:10,y:10,width:10,height:10,fill:h[36]}),e.jsx("rect",{x:10,y:20,width:10,height:10,fill:h[37]}),e.jsx("rect",{x:10,y:30,width:10,height:10,fill:h[38]}),e.jsx("rect",{x:10,y:40,width:10,height:10,fill:h[39]}),e.jsx("rect",{x:10,y:50,width:10,height:10,fill:h[40]}),e.jsx("rect",{x:10,y:60,width:10,height:10,fill:h[41]}),e.jsx("rect",{x:10,y:70,width:10,height:10,fill:h[42]}),e.jsx("rect",{x:30,y:10,width:10,height:10,fill:h[43]}),e.jsx("rect",{x:30,y:20,width:10,height:10,fill:h[44]}),e.jsx("rect",{x:30,y:30,width:10,height:10,fill:h[45]}),e.jsx("rect",{x:30,y:40,width:10,height:10,fill:h[46]}),e.jsx("rect",{x:30,y:50,width:10,height:10,fill:h[47]}),e.jsx("rect",{x:30,y:60,width:10,height:10,fill:h[48]}),e.jsx("rect",{x:30,y:70,width:10,height:10,fill:h[49]}),e.jsx("rect",{x:50,y:10,width:10,height:10,fill:h[50]}),e.jsx("rect",{x:50,y:20,width:10,height:10,fill:h[51]}),e.jsx("rect",{x:50,y:30,width:10,height:10,fill:h[52]}),e.jsx("rect",{x:50,y:40,width:10,height:10,fill:h[53]}),e.jsx("rect",{x:50,y:50,width:10,height:10,fill:h[54]}),e.jsx("rect",{x:50,y:60,width:10,height:10,fill:h[55]}),e.jsx("rect",{x:50,y:70,width:10,height:10,fill:h[56]}),e.jsx("rect",{x:70,y:10,width:10,height:10,fill:h[57]}),e.jsx("rect",{x:70,y:20,width:10,height:10,fill:h[58]}),e.jsx("rect",{x:70,y:30,width:10,height:10,fill:h[59]}),e.jsx("rect",{x:70,y:40,width:10,height:10,fill:h[60]}),e.jsx("rect",{x:70,y:50,width:10,height:10,fill:h[61]}),e.jsx("rect",{x:70,y:60,width:10,height:10,fill:h[62]}),e.jsx("rect",{x:70,y:70,width:10,height:10,fill:h[63]})]})]})},$e=36;function yh(r,s){const n=_r(r),c=s&&s.length,y=Kt(n,s,c),x=tt(n,10,1),h=x<5?x+$e/9:x,w=tt(n,10,2),E=w<5?w+$e/9:w;return{wrapperColor:y,faceColor:hh(y),backgroundColor:Kt(n+13,s,c),wrapperTranslateX:h,wrapperTranslateY:E,wrapperRotate:tt(n,360),wrapperScale:1+tt(n,$e/12)/10,isMouthOpen:oa(n,2),isCircle:oa(n,1),eyeSpread:tt(n,5),mouthSpread:tt(n,3),faceRotate:tt(n,10,3),faceTranslateX:h>$e/6?h/2:tt(n,8,1),faceTranslateY:E>$e/6?E/2:tt(n,7,2)}}const Oi=({name:r,colors:s,title:n,square:c,size:y,...x})=>{const h=yh(r,s),w=b.useId();return e.jsxs("svg",{viewBox:"0 0 "+$e+" "+$e,fill:"none",role:"img",xmlns:"http://www.w3.org/2000/svg",width:y,height:y,...x,children:[n&&e.jsx("title",{children:r}),e.jsx("mask",{id:w,maskUnits:"userSpaceOnUse",x:0,y:0,width:$e,height:$e,children:e.jsx("rect",{width:$e,height:$e,rx:c?void 0:$e*2,fill:"#FFFFFF"})}),e.jsxs("g",{mask:`url(#${w})`,children:[e.jsx("rect",{width:$e,height:$e,fill:h.backgroundColor}),e.jsx("rect",{x:"0",y:"0",width:$e,height:$e,transform:"translate("+h.wrapperTranslateX+" "+h.wrapperTranslateY+") rotate("+h.wrapperRotate+" "+$e/2+" "+$e/2+") scale("+h.wrapperScale+")",fill:h.wrapperColor,rx:h.isCircle?$e:$e/6}),e.jsxs("g",{transform:"translate("+h.faceTranslateX+" "+h.faceTranslateY+") rotate("+h.faceRotate+" "+$e/2+" "+$e/2+")",children:[h.isMouthOpen?e.jsx("path",{d:"M15 "+(19+h.mouthSpread)+"c2 1 4 1 6 0",stroke:h.faceColor,fill:"none",strokeLinecap:"round"}):e.jsx("path",{d:"M13,"+(19+h.mouthSpread)+" a1,0.75 0 0,0 10,0",fill:h.faceColor}),e.jsx("rect",{x:14-h.eyeSpread,y:14,width:1.5,height:2,rx:1,stroke:"none",fill:h.faceColor}),e.jsx("rect",{x:20+h.eyeSpread,y:14,width:1.5,height:2,rx:1,stroke:"none",fill:h.faceColor})]})]})]})},wh=4,ot=80;function jh(r,s){const n=_r(r),c=s&&s.length;return Array.from({length:wh},(y,x)=>Kt(n+x,s,c))}const Nh=({name:r,colors:s,title:n,square:c,size:y,...x})=>{const h=jh(r,s),w=r.replace(/\s/g,""),E=b.useId();return e.jsxs("svg",{viewBox:"0 0 "+ot+" "+ot,fill:"none",role:"img",xmlns:"http://www.w3.org/2000/svg",width:y,height:y,...x,children:[n&&e.jsx("title",{children:r}),e.jsx("mask",{id:E,maskUnits:"userSpaceOnUse",x:0,y:0,width:ot,height:ot,children:e.jsx("rect",{width:ot,height:ot,rx:c?void 0:ot*2,fill:"#FFFFFF"})}),e.jsxs("g",{mask:`url(#${E})`,children:[e.jsx("path",{fill:"url(#gradient_paint0_linear_"+w+")",d:"M0 0h80v40H0z"}),e.jsx("path",{fill:"url(#gradient_paint1_linear_"+w+")",d:"M0 40h80v40H0z"})]}),e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"gradient_paint0_linear_"+w,x1:ot/2,y1:0,x2:ot/2,y2:ot/2,gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{stopColor:h[0]}),e.jsx("stop",{offset:1,stopColor:h[1]})]}),e.jsxs("linearGradient",{id:"gradient_paint1_linear_"+w,x1:ot/2,y1:ot/2,x2:ot/2,y2:ot,gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{stopColor:h[2]}),e.jsx("stop",{offset:1,stopColor:h[3]})]})]})]})},kh=3,et=80;function _h(r,s){const n=_r(r),c=s&&s.length;return Array.from({length:kh},(y,x)=>({color:Kt(n+x,s,c),translateX:tt(n*(x+1),et/10,1),translateY:tt(n*(x+1),et/10,2),scale:1.2+tt(n*(x+1),et/20)/10,rotate:tt(n*(x+1),360,1)}))}const Dn=({name:r,colors:s,title:n,square:c,size:y,...x})=>{const h=_h(r,s),w=b.useId();return e.jsxs("svg",{viewBox:"0 0 "+et+" "+et,fill:"none",role:"img",xmlns:"http://www.w3.org/2000/svg",width:y,height:y,...x,children:[n&&e.jsx("title",{children:r}),e.jsx("mask",{id:w,maskUnits:"userSpaceOnUse",x:0,y:0,width:et,height:et,children:e.jsx("rect",{width:et,height:et,rx:c?void 0:et*2,fill:"#FFFFFF"})}),e.jsxs("g",{mask:`url(#${w})`,children:[e.jsx("rect",{width:et,height:et,fill:h[0].color}),e.jsx("path",{filter:`url(#filter_${w})`,d:"M32.414 59.35L50.376 70.5H72.5v-71H33.728L26.5 13.381l19.057 27.08L32.414 59.35z",fill:h[1].color,transform:"translate("+h[1].translateX+" "+h[1].translateY+") rotate("+h[1].rotate+" "+et/2+" "+et/2+") scale("+h[2].scale+")"}),e.jsx("path",{filter:`url(#filter_${w})`,style:{mixBlendMode:"overlay"},d:"M22.216 24L0 46.75l14.108 38.129L78 86l-3.081-59.276-22.378 4.005 12.972 20.186-23.35 27.395L22.215 24z",fill:h[2].color,transform:"translate("+h[2].translateX+" "+h[2].translateY+") rotate("+h[2].rotate+" "+et/2+" "+et/2+") scale("+h[2].scale+")"})]}),e.jsx("defs",{children:e.jsxs("filter",{id:`filter_${w}`,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[e.jsx("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),e.jsx("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),e.jsx("feGaussianBlur",{stdDeviation:7,result:"effect1_foregroundBlur"})]})})]})},Sh={pixel:vh,bauhaus:Di,ring:fh,beam:Oi,sunset:Nh,marble:Dn,geometric:Oi,abstract:Di},Mh=({variant:r="marble",colors:s=["#92A1C6","#146A7C","#F0AB3D","#C271B4","#C20D90"],name:n="Clara Barton",title:c=!1,size:y="40px",square:x=!1,...h})=>{const w=Sh[r]||Dn;return e.jsx(w,{colors:s,name:n,title:c,size:y,square:x,...h})},zi=new Map,On=new Set;function pa(r,s=48,n="default"){if(!r)return"";const c=`${r}-${s}`,y=zi.get(c);if(y)return y;if(On.has(r))return"";const h=`https://unavatar.io/twitter/${r.startsWith("@")?r.slice(1):r}?size=${s}&fallback=false&format=jpeg&quality=80`;return zi.set(c,h),h}function Ch(r){if(r){const s=r.startsWith("@")?r.slice(1):r;On.add(s),console.warn(`[Avatar] Failed to load Twitter avatar for: @${s}`)}}const Ah="http://127.0.0.1:54321",Eh="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0",se=Rc(Ah,Eh),zn=b.createContext(null);function Rh(){const r=b.useContext(zn);if(!r)throw new Error("useAvatarCache must be used within an AvatarCacheProvider");return r}const jt=new Map,gr=new Map;async function Js(r,s=96){const n=r.toLowerCase();if(jt.has(n))return jt.get(n);if(gr.has(n))return gr.get(n);const c=pa(r,s);if(!c)return null;const y=new Promise(x=>{const h=new Image;h.onload=()=>{jt.set(n,c),gr.delete(n),x(c)},h.onerror=()=>{gr.delete(n),x(null)},h.src=c});return gr.set(n,y),y}function Th({children:r}){const[s,n]=b.useState(jt),[c,y]=b.useState(!1);b.useEffect(()=>{let A=!1;async function R(){try{const{data:T,error:W}=await se.from("players").select("twitter").not("twitter","is",null);if(W||!T||A)return;const q=[...new Set(T.map(M=>M.twitter).filter(M=>!!M))],$=5,P=100;for(let M=0;M<q.length&&!A;M+=$){const G=q.slice(M,M+$);await Promise.all(G.map(ae=>Js(ae))),A||n(new Map(jt)),M+$<q.length&&await new Promise(ae=>setTimeout(ae,P))}A||y(!0)}catch(T){console.warn("Failed to preload avatars:",T),A||y(!0)}}return R(),()=>{A=!0}},[]);const x=b.useCallback(A=>jt.has(A.toLowerCase()),[]),h=b.useCallback((A,R=96)=>{if(!A)return null;const T=A.toLowerCase();return jt.has(T)?jt.get(T):(Js(A,R).then(()=>{}),pa(A,R))},[]),w=b.useCallback(A=>{const R=A.toLowerCase();jt.delete(R),gr.delete(R),Js(A).then(()=>{n(new Map(jt))})},[]),E=b.useMemo(()=>({avatarCache:s,isCached:x,getCachedUrl:h,isPreloaded:c,refreshAvatar:w}),[s,x,h,c,w]);return e.jsx(zn.Provider,{value:E,children:r})}function mt({name:r,twitter:s,size:n=40,className:c,variant:y="beam",colors:x=["#92A1C6","#146A7C","#F0AB3D","#C271B4","#C20D90"]}){const[h,w]=b.useState(!1),{getCachedUrl:E}=Rh(),A=s&&!h,R=s?E(s,n*2)||pa(s,n*2):null;return e.jsx("div",{className:je("relative overflow-hidden rounded-full shrink-0",c),style:{width:n,height:n},children:A?e.jsx("img",{src:R,alt:r,className:"h-full w-full object-cover",onError:()=>w(!0)}):e.jsx(Mh,{size:n,name:r,variant:y,colors:x})})}const Ii=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,Li=Sn,In=(r,s)=>n=>{var c;if((s==null?void 0:s.variants)==null)return Li(r,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:y,defaultVariants:x}=s,h=Object.keys(y).map(A=>{const R=n==null?void 0:n[A],T=x==null?void 0:x[A];if(R===null)return null;const W=Ii(R)||Ii(T);return y[A][W]}),w=n&&Object.entries(n).reduce((A,R)=>{let[T,W]=R;return W===void 0||(A[T]=W),A},{}),E=s==null||(c=s.compoundVariants)===null||c===void 0?void 0:c.reduce((A,R)=>{let{class:T,className:W,...q}=R;return Object.entries(q).every($=>{let[P,M]=$;return Array.isArray(M)?M.includes({...x,...w}[P]):{...x,...w}[P]===M})?[...A,T,W]:A},[]);return Li(r,h,E,n==null?void 0:n.class,n==null?void 0:n.className)},Dh=In("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:opacity-50 disabled:pointer-events-none",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",outline:"border border-input bg-background text-foreground hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Ce=b.forwardRef(({className:r,variant:s,size:n,asChild:c=!1,...y},x)=>{const h=c?pc:"button";return e.jsx(h,{className:je(Dh({variant:s,size:n,className:r})),ref:x,...y})});Ce.displayName="Button";function ma({currentPage:r,totalPages:s,onPageChange:n,itemsPerPage:c,totalItems:y}){const x=(r-1)*c+1,h=Math.min(r*c,y),w=()=>{const E=[];if(s<=7)for(let A=1;A<=s;A++)E.push(A);else{E.push(1),r>3&&E.push("...");const A=Math.max(2,r-1),R=Math.min(s-1,r+1);for(let T=A;T<=R;T++)E.push(T);r<s-2&&E.push("..."),E.push(s)}return E};return s<=1?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-2",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",x," to ",h," of ",y," results"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{variant:"outline",size:"sm",onClick:()=>n(r-1),disabled:r===1,children:"Previous"}),e.jsx("div",{className:"flex items-center gap-1",children:w().map((E,A)=>typeof E=="number"?e.jsx(Ce,{variant:r===E?"default":"outline",size:"sm",onClick:()=>n(E),className:"w-10",children:E},A):e.jsx("span",{className:"px-2 text-muted-foreground",children:E},A))}),e.jsx(Ce,{variant:"outline",size:"sm",onClick:()=>n(r+1),disabled:r===s,children:"Next"})]})]})}async function ga(){try{const{data:r,error:s}=await se.from("players").select("id, name, twitter, created, rating, rd, volatility, peak_rating, peak_rating_date, has_played_this_season").order("rating",{ascending:!1});if(s)throw s;return r??[]}catch(r){return console.warn("fetchPlayers failed:",r),[]}}async function Ln(){try{const{data:r,error:s}=await se.from("matches").select("id, player1_id, player2_id, winner_id, player1_score, player2_score, rating_change_p1, rating_change_p2, event_id, match_order, vod_link, season_id").eq("season_id",0).order("id",{ascending:!1});if(s)throw s;return r??[]}catch(r){return console.warn("fetchMatches failed:",r),[]}}async function Oh(){try{const{data:r,error:s}=await se.from("matches").select("id, player1_id, player2_id, winner_id, player1_score, player2_score, rating_change_p1, rating_change_p2, event_id, match_order, vod_link, season_id").eq("season_id",0).not("winner_id","is",null).order("id",{ascending:!1});if(s)throw s;return r??[]}catch(r){return console.warn("fetchCompletedMatches failed:",r),[]}}async function zh(){try{const{data:r,error:s}=await se.from("matches").select("id, player1_id, player2_id, winner_id, player1_score, player2_score, rating_change_p1, rating_change_p2, event_id, match_order, vod_link, season_id").eq("season_id",0).is("winner_id",null).order("match_order",{ascending:!0});if(s)throw s;return r??[]}catch(r){return console.warn("fetchUpcomingMatches failed:",r),[]}}async function Ih(){try{const{data:r,error:s}=await se.from("matches").select("id, player1_id, player2_id, winner_id, player1_score, player2_score, rating_change_p1, rating_change_p2, event_id, match_order, vod_link, season_id").not("winner_id","is",null).order("id",{ascending:!1});if(s)throw s;return r??[]}catch(r){return console.warn("fetchAllCompletedMatches failed:",r),[]}}async function Wr(){try{const{data:r,error:s}=await se.from("events").select("*").order("event_date",{ascending:!1});if(s)throw s;return r??[]}catch(r){return console.warn("fetchEvents failed:",r),[]}}async function Lh(){try{const{data:r,error:s}=await se.from("events").select("*").gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0});if(s)throw s;return r??[]}catch(r){return console.warn("fetchUpcomingEvents failed:",r),[]}}function fs(){const[r,s]=b.useState(null),[n,c]=b.useState(null),[y,x]=b.useState(null);return b.useEffect(()=>{let w=!0;return(async()=>{try{const[E,A]=await Promise.all([ga(),Oh()]);if(!w)return;s(E),c(A)}catch(E){if(!w)return;x(E.message)}})(),()=>{w=!1}},[]),{players:r??[],matches:n??[],loading:r===null||n===null,error:y}}const We=b.forwardRef(({className:r,type:s="text",...n},c)=>e.jsx("input",{type:s,className:je("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",r),ref:c,...n}));We.displayName="Input";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bh=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Bn=(...r)=>r.filter((s,n,c)=>!!s&&s.trim()!==""&&c.indexOf(s)===n).join(" ").trim();/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Fh={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $h=b.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:c,className:y="",children:x,iconNode:h,...w},E)=>b.createElement("svg",{ref:E,...Fh,width:s,height:s,stroke:r,strokeWidth:c?Number(n)*24/Number(s):n,className:Bn("lucide",y),...w},[...h.map(([A,R])=>b.createElement(A,R)),...Array.isArray(x)?x:[x]]));/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=(r,s)=>{const n=b.forwardRef(({className:c,...y},x)=>b.createElement($h,{ref:x,iconNode:s,className:Bn(`lucide-${Bh(r)}`,c),...y}));return n.displayName=`${r}`,n};/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ph=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],br=Be("ArrowDown",Ph);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gh=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],ds=Be("ArrowUpDown",Gh);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uh=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],vr=Be("ArrowUp",Uh);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wh=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Hh=Be("Calendar",Wh);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qh=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Fn=Be("Check",qh);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vh=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],$n=Be("ChevronDown",Vh);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xh=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Yh=Be("ChevronUp",Xh);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zh=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],Kh=Be("ChevronsUpDown",Zh);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jh=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Qh=Be("CircleAlert",Jh);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eu=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Bi=Be("CircleCheck",eu);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tu=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],Fi=Be("Clock",tu);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ru=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Pn=Be("ExternalLink",ru);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const su=[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]],au=Be("Menu",su);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iu=[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]],nu=Be("Moon",iu);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ou=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],fa=Be("Pencil",ou);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lu=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],xa=Be("Plus",lu);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const du=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],xs=Be("RefreshCw",du);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cu=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Gn=Be("Search",cu);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hu=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 3v1",key:"1asbbs"}],["path",{d:"M12 20v1",key:"1wcdkc"}],["path",{d:"M3 12h1",key:"lp3yf2"}],["path",{d:"M20 12h1",key:"1vloll"}],["path",{d:"m18.364 5.636-.707.707",key:"1hakh0"}],["path",{d:"m6.343 17.657-.707.707",key:"18m9nf"}],["path",{d:"m5.636 5.636.707.707",key:"1xv1c5"}],["path",{d:"m17.657 17.657.707.707",key:"vl76zb"}]],uu=Be("SunMedium",hu);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pu=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],ba=Be("Trash2",pu);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mu=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],gu=Be("TrendingUp",mu);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fu=[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]],Un=Be("Trophy",fu);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xu=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],Wn=Be("Undo2",xu);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bu=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],bs=Be("X",bu);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vu=[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]],Hn=Be("Youtube",vu),vs=vc,ys=yc,Hr=b.forwardRef(({className:r,children:s,...n},c)=>e.jsxs(Ji,{ref:c,className:je("flex h-9 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...n,children:[s,e.jsx(mc,{asChild:!0,children:e.jsx($n,{className:"h-4 w-4 opacity-50"})})]}));Hr.displayName=Ji.displayName;const qn=b.forwardRef(({className:r,...s},n)=>e.jsx(Qi,{ref:n,className:je("flex cursor-default items-center justify-center py-1",r),...s,children:e.jsx(Yh,{className:"h-4 w-4"})}));qn.displayName=Qi.displayName;const Vn=b.forwardRef(({className:r,...s},n)=>e.jsx(en,{ref:n,className:je("flex cursor-default items-center justify-center py-1",r),...s,children:e.jsx($n,{className:"h-4 w-4"})}));Vn.displayName=en.displayName;const qr=b.forwardRef(({className:r,children:s,position:n="popper",...c},y)=>e.jsx(gc,{children:e.jsxs(tn,{ref:y,className:je("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:n,...c,children:[e.jsx(qn,{}),e.jsx(fc,{className:je("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),e.jsx(Vn,{})]})}));qr.displayName=tn.displayName;const yu=b.forwardRef(({className:r,...s},n)=>e.jsx(rn,{ref:n,className:je("px-2 py-1.5 text-sm font-semibold",r),...s}));yu.displayName=rn.displayName;const Rt=b.forwardRef(({className:r,children:s,...n},c)=>e.jsxs(sn,{ref:c,className:je("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...n,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(xc,{children:e.jsx(Fn,{className:"h-4 w-4"})})}),e.jsx(bc,{children:s})]}));Rt.displayName=sn.displayName;const wu=b.forwardRef(({className:r,...s},n)=>e.jsx(an,{ref:n,className:je("-mx-1 my-1 h-px bg-muted",r),...s}));wu.displayName=an.displayName;async function ju(){try{const{data:r,error:s}=await se.from("seasons").select("*").eq("status","active").single();if(s&&s.code!=="PGRST116")throw s;return r||null}catch(r){return console.error("Failed to fetch active season:",r),null}}async function Sr(){try{const{data:r,error:s}=await se.from("seasons").select("*").order("id",{ascending:!1});if(s)throw s;return r||[]}catch(r){return console.error("Failed to fetch seasons:",r),[]}}async function Nu(r="Active Season",s){try{s==null||s("Fetching current active season...");const{data:n,error:c}=await se.from("seasons").select("*").eq("status","active").single();if(c)throw c;if(!n)throw new Error("Active season not found");console.log(` Current season: ${n.name}`),s==null||s("Fetching active players...");const{data:y,error:x}=await se.from("players").select("*").not("rating","is",null);if(x)throw x;console.log(` Found ${(y==null?void 0:y.length)||0} active players`),s==null||s("Counting matches...");const{data:h,error:w}=await se.from("matches").select("id").eq("season_id",0);if(w)throw w;console.log(` Found ${(h==null?void 0:h.length)||0} matches in season`),s==null||s("Determining new season ID...");const{data:E,error:A}=await se.from("seasons").select("id").gt("id",0).order("id",{ascending:!1}).limit(1).single();if(A&&A.code!=="PGRST116")throw A;const R=((E==null?void 0:E.id)||0)+1;if(console.log(` Next season ID: ${R}`),s==null||s("Creating player snapshots..."),y&&y.length>0){const G=y.sort((Y,le)=>le.rating-Y.rating).map((Y,le)=>({season_id:R,player_id:Y.id,final_rating:Y.rating,final_rd:Y.rd,final_volatility:Y.volatility,matches_played_count:Y.matches_played||0,peak_rating:Y.peak_rating,peak_rating_date:Y.peak_rating_date,final_rank:le+1})),{error:ae}=await se.from("season_player_snapshots").insert(G);if(ae)throw ae;console.log(` Created ${G.length} snapshots`)}s==null||s("Archiving old season...");const{error:T}=await se.from("seasons").delete().eq("status","active");if(T)throw T;const{error:W}=await se.from("seasons").insert({id:R,name:n.name,status:"archived",start_date:n.start_date,end_date:new Date().toISOString(),description:n.description});if(W)throw W;console.log(` Season ${R} archived`),s==null||s("Updating matches...");const{error:q}=await se.from("matches").update({season_id:R}).eq("season_id",0);if(q)throw q;s==null||s("Updating rating events...");const{error:$}=await se.from("rating_events").update({season_id:R}).eq("season_id",0);if($)throw $;console.log(" Updated matches and events"),s==null||s("Creating new active season...");const{error:P}=await se.from("seasons").insert({id:0,name:r,status:"active",start_date:new Date().toISOString(),description:"Current active season - use id=0 to reference this"});if(P)throw P;console.log(" New active season created (id = 0)"),s==null||s("Resetting player ratings...");const{error:M}=await se.from("players").update({rating:null,rd:null,volatility:null}).neq("id",0);if(M)throw M;return console.log(" All player ratings reset"),s==null||s("Season transition complete!"),{success:!0,newSeasonId:R}}catch(n){const c=n instanceof Error?n.message:String(n);return console.error(" Failed to archive season:",n),{success:!1,error:c}}}async function ku(r){try{const{data:s,error:n}=await se.from("season_player_snapshots").select("*, player:players(id, name)").eq("season_id",r).order("final_rank");if(n)throw n;return s||[]}catch(s){return console.error(`Failed to fetch season ${r} leaderboard:`,s),[]}}async function _u(r,s){try{if(s==null||s("Starting season activation..."),r<=0)throw new Error("Cannot activate the current active season or invalid season ID");s==null||s("Fetching target season...");const{data:n,error:c}=await se.from("seasons").select("*").eq("id",r).single();if(c||!n)throw new Error("Target season not found");if(n.status==="active")throw new Error("Season is already active");console.log(` Activating season: ${n.name}`),s==null||s("Fetching current active season...");const{data:y,error:x}=await se.from("seasons").select("*").eq("status","active").single();if(x||!y)throw new Error("Current active season not found");console.log(` Current active season: ${y.name}`),s==null||s("Determining new IDs...");const{data:h}=await se.from("seasons").select("id").gt("id",0).order("id",{ascending:!1}).limit(1).single(),w=((h==null?void 0:h.id)||0)+1;console.log(` Current active season will get ID: ${w}`),s==null||s("Archiving current active season...");const{error:E}=await se.from("seasons").update({id:w,status:"archived",end_date:new Date().toISOString()}).eq("status","active");if(E)throw E;console.log(` Current active season archived with ID ${w}`),s==null||s("Updating current season matches...");const{error:A}=await se.from("matches").update({season_id:w}).eq("season_id",0);if(A)throw A;s==null||s("Updating current season rating events...");const{error:R}=await se.from("rating_events").update({season_id:w}).eq("season_id",0);if(R)throw R;console.log(" Matches and events updated"),s==null||s("Restoring player ratings from season snapshots...");const{data:T,error:W}=await se.from("season_player_snapshots").select("*").eq("season_id",r);if(W)throw W;if(T&&T.length>0){for(const M of T){const{error:G}=await se.from("players").update({rating:M.final_rating,rd:M.final_rd,volatility:M.final_volatility}).eq("id",M.player_id);G&&console.warn(` Failed to update player ${M.player_id}:`,G)}console.log(` Restored ratings for ${T.length} players`)}s==null||s("Converting target season to active...");const{error:q}=await se.from("seasons").update({id:0,status:"active",end_date:null}).eq("id",r);if(q)throw q;console.log(" Target season is now active"),s==null||s("Updating target season matches...");const{error:$}=await se.from("matches").update({season_id:0}).eq("season_id",r);if($)throw $;s==null||s("Updating target season rating events...");const{error:P}=await se.from("rating_events").update({season_id:0}).eq("season_id",r);if(P)throw P;return console.log(" All matches and events restored for active season"),s==null||s("Season activation complete!"),{success:!0}}catch(n){const c=n instanceof Error?n.message:String(n);return console.error(" Failed to activate season:",n),{success:!1,error:c}}}const Fr=25;function $i(r,s=0){return r.toLocaleString(void 0,{maximumFractionDigits:s,minimumFractionDigits:s})}function Su(){pt("Leaderboard");const{players:r,matches:s,loading:n,error:c}=fs(),[y,x]=vn(),[h,w]=b.useState([]),[E,A]=b.useState(null),[R,T]=b.useState([]),[W,q]=b.useState(!1);b.useEffect(()=>{(async()=>{const S=await Sr();w(S);const D=S.find(z=>z.status==="active");D&&A(D.id)})()},[]),b.useEffect(()=>{const S=h.find(z=>z.status==="active"),D=S&&E===S.id;!E||D||(async()=>{q(!0);const z=await ku(E);T(z),q(!1)})()},[E,h]);const[$,P]=b.useState(()=>{const S=y.get("page");return S?parseInt(S,10):1}),[M,G]=b.useState(()=>y.get("search")||""),[ae,Y]=b.useState(()=>{const S=y.get("sort");return S&&["rating","rd","matches","name"].includes(S)?S:"rating"}),[le,he]=b.useState(()=>{const S=y.get("dir");return S==="asc"||S==="desc"?S:"desc"});b.useEffect(()=>{const S=new URLSearchParams;$!==1&&S.set("page",$.toString()),M&&S.set("search",M),ae!=="rating"&&S.set("sort",ae),le!=="desc"&&S.set("dir",le);const D=S.toString(),z=y.toString();D!==z&&x(S)},[$,M,ae,le,x,y]);const K=b.useMemo(()=>{const S=h.find(z=>z.status==="active"),D=S&&E===S.id;return E===null?{players:r.filter(z=>z.rating!==null&&z.rd!==null&&z.volatility!==null),isArchived:!1,isAllSeasons:!0}:D?{players:r.filter(z=>z.has_played_this_season&&z.rating!==null&&z.rd!==null&&z.volatility!==null),isArchived:!1,isAllSeasons:!1}:{players:R.map(z=>{var ce;return{id:z.player_id,name:((ce=z.player)==null?void 0:ce.name)||`Player ${z.player_id}`,rating:z.final_rating,rd:z.final_rd,volatility:z.final_volatility,matches_played:z.matches_played_count,peak_rating:z.peak_rating,peak_rating_date:z.peak_rating_date}}),isArchived:!0,isAllSeasons:!1}},[E,h,r,R,s]),{rankedPlayers:me,playerMatchCounts:L,playerRankings:X}=b.useMemo(()=>{const S=K.players,D=new Map;if(!K.isArchived&&s)for(const ce of s)D.set(ce.player1_id,(D.get(ce.player1_id)??0)+1),D.set(ce.player2_id,(D.get(ce.player2_id)??0)+1);else if(K.isArchived)for(const ce of S)D.set(ce.id,ce.matches_played||0);const z=new Map;return S.forEach((ce,ke)=>{z.set(ce.id,ke+1)}),{rankedPlayers:S,playerMatchCounts:D,playerRankings:z}},[K,s]),oe=b.useMemo(()=>{let S=me.filter(D=>D.rating!==null&&D.rd!==null&&D.volatility!==null);if(M.trim()){const D=M.trim().toLowerCase();S=S.filter(z=>z.name.toLowerCase().includes(D))}return S},[me,M]),Ne=b.useMemo(()=>{const S=[...oe];return S.sort((D,z)=>{const ce=L.get(D.id)??0,ke=L.get(z.id)??0;let we=0;switch(ae){case"rating":we=(D.rating??0)-(z.rating??0);break;case"rd":we=(D.rd??0)-(z.rd??0);break;case"matches":we=ce-ke;break;case"name":we=D.name.localeCompare(z.name);break}return le==="asc"?we:-we}),S},[oe,ae,le,L]),H=S=>{ae===S?he(D=>D==="asc"?"desc":"asc"):(Y(S),he(S==="name"?"asc":"desc")),P(1)},ne=Math.ceil(Ne.length/Fr),F=b.useMemo(()=>{const S=($-1)*Fr,D=S+Fr;return Ne.slice(S,D)},[Ne,$]),fe=S=>{const D=F[S];return D?X.get(D.id)??0:0};return $>ne&&ne>0&&P(1),e.jsxs("section",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-primary/30 pb-4",children:[e.jsx("h1",{className:"text-4xl font-heading font-bold text-primary drop-shadow-[0_0_10px_rgba(234,179,8,0.3)] uppercase tracking-widest",children:"Leaderboard"}),e.jsx("div",{className:"h-1 w-24 bg-primary/50 rounded-full"})]}),n&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}),c&&e.jsxs("div",{className:"text-destructive text-center py-8 font-heading",children:["Error loading data: ",c]}),!n&&!c&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-4 bg-card/50 p-4 rounded-lg border border-border/30 backdrop-blur-sm",children:[e.jsx("div",{className:"w-full md:w-auto flex-1",children:e.jsxs(vs,{value:E===null?"all":E.toString(),onValueChange:S=>A(S==="all"?null:parseInt(S,10)),children:[e.jsx(Hr,{className:"w-full bg-background/50 border-primary/30 focus:ring-primary/50",children:e.jsx(ys,{placeholder:"Select a season"})}),e.jsxs(qr,{children:[e.jsx(Rt,{value:"all",children:"All seasons"}),h.filter(S=>S.status==="active").map(S=>e.jsx(Rt,{value:S.id.toString(),children:S.name},S.id)),h.filter(S=>S.status==="archived").sort((S,D)=>S.id-D.id).map(S=>e.jsxs(Rt,{value:S.id.toString(),children:[S.name," (Archived)"]},S.id))]})]})}),e.jsx("div",{className:"w-full md:w-auto flex-1",children:e.jsx(We,{placeholder:"Search for player",value:M,onChange:S=>{P(1),G(S.target.value)},className:"w-full bg-background/50 border-primary/30 focus:ring-primary/50"})})]}),W&&e.jsx("p",{className:"text-muted-foreground text-center italic",children:"Loading season data..."}),e.jsxs(Fe,{className:"bg-card/80 backdrop-blur-md border-border/60 shadow-lg overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-primary/50 to-transparent"}),e.jsx(Ye,{className:"border-b border-border/30 bg-muted/20",children:e.jsxs(Ze,{className:"font-heading uppercase tracking-widest text-lg flex items-center gap-2",children:[e.jsx("span",{className:"text-primary",children:""})," Current Standings"]})}),e.jsx(Pe,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"text-left text-muted-foreground bg-muted/30 font-heading uppercase tracking-wider text-xs",children:e.jsxs("tr",{children:[!K.isAllSeasons&&e.jsx("th",{className:"py-3 px-4 w-20 text-center",children:"Rank"}),e.jsx("th",{className:"py-3 px-4",children:e.jsxs("button",{className:"inline-flex items-center gap-1 hover:text-primary transition-colors",onClick:()=>H("name"),children:[e.jsx("span",{className:"hidden sm:inline",children:"Warrior"}),e.jsx("span",{className:"sm:hidden",children:"Name"}),ae==="name"?le==="asc"?e.jsx(vr,{size:14}):e.jsx(br,{size:14}):e.jsx(ds,{size:14,className:"opacity-50"})]})}),!K.isAllSeasons&&e.jsx("th",{className:"py-3 px-4 text-right",children:e.jsxs("button",{className:"inline-flex items-center gap-1 hover:text-primary transition-colors ml-auto",onClick:()=>H("rating"),children:[e.jsx("span",{className:"hidden sm:inline",children:"Rating"}),e.jsx("span",{className:"sm:hidden",children:"Rtng"}),ae==="rating"?le==="asc"?e.jsx(vr,{size:14}):e.jsx(br,{size:14}):e.jsx(ds,{size:14,className:"opacity-50"})]})}),!K.isAllSeasons&&e.jsx("th",{className:"py-3 px-4 text-right hidden sm:table-cell",children:e.jsxs("button",{className:"inline-flex items-center gap-1 hover:text-primary transition-colors ml-auto",onClick:()=>H("rd"),title:"Rating Deviation",children:[e.jsx("span",{children:"Deviation"}),ae==="rd"?le==="asc"?e.jsx(vr,{size:14}):e.jsx(br,{size:14}):e.jsx(ds,{size:14,className:"opacity-50"})]})}),e.jsx("th",{className:"py-3 px-4 text-right hidden sm:table-cell",children:e.jsxs("button",{className:"inline-flex items-center gap-1 hover:text-primary transition-colors ml-auto",onClick:()=>H("matches"),children:[e.jsx("span",{children:"Battles"}),ae==="matches"?le==="asc"?e.jsx(vr,{size:14}):e.jsx(br,{size:14}):e.jsx(ds,{size:14,className:"opacity-50"})]})})]})}),e.jsx("tbody",{className:"divide-y divide-border/20",children:Ne.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:K.isAllSeasons?2:5,className:"py-12 text-center text-muted-foreground font-heading italic",children:M?`No warriors found matching "${M}"`:"No warriors found."})}):F.map((S,D)=>{const z=fe(D),ce=L.get(S.id)??0,ke=!K.isAllSeasons&&z<=3;return e.jsxs("tr",{className:`group transition-colors hover:bg-primary/5 ${ke?"bg-primary/5":""}`,children:[!K.isAllSeasons&&e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsxs("div",{className:`font-heading font-bold text-base ${z===1?"text-yellow-500 drop-shadow-[0_0_5px_rgba(234,179,8,0.5)]":z===2?"text-gray-300 drop-shadow-[0_0_5px_rgba(209,213,219,0.5)]":z===3?"text-amber-700 drop-shadow-[0_0_5px_rgba(180,83,9,0.5)]":"text-muted-foreground"}`,children:["#",z]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs(Ke,{className:"flex items-center gap-3 group/link",to:`/players/${S.id}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:`absolute inset-0 rounded-full blur-sm opacity-0 group-hover/link:opacity-100 transition-opacity ${!K.isAllSeasons&&z===1?"bg-yellow-500/50":"bg-primary/30"}`}),e.jsx(mt,{name:S.name,twitter:S.twitter,size:40,className:`h-10 w-10 border-2 relative z-10 transition-colors ${K.isAllSeasons?"border-border group-hover/link:border-primary":z===1?"border-yellow-500":z===2?"border-gray-300":z===3?"border-amber-700":"border-border group-hover/link:border-primary"}`})]}),e.jsx("span",{className:`font-heading font-bold text-base transition-colors ${!K.isAllSeasons&&z<=3?"text-foreground":"text-foreground/90 group-hover/link:text-primary"}`,children:S.name})]})}),!K.isAllSeasons&&e.jsx("td",{className:"py-3 px-4 text-right font-mono font-bold text-lg text-primary",children:$i(S.rating??0,0)}),!K.isAllSeasons&&e.jsx("td",{className:"py-3 px-4 text-right hidden sm:table-cell text-muted-foreground font-mono",children:$i(S.rd??0,0)}),e.jsx("td",{className:"py-3 px-4 text-right hidden sm:table-cell text-foreground font-bold",children:ce})]},S.id)})})]})})})]})]}),!n&&Ne.length>Fr&&e.jsx(ma,{currentPage:$,totalPages:ne,onPageChange:P,itemsPerPage:Fr,totalItems:Ne.length})]})}var Pi=1,Mu=.9,Cu=.8,Au=.17,Qs=.1,ea=.999,Eu=.9999,Ru=.99,Tu=/[\\\/_+.#"@\[\(\{&]/,Du=/[\\\/_+.#"@\[\(\{&]/g,Ou=/[\s-]/,Xn=/[\s-]/g;function la(r,s,n,c,y,x,h){if(x===s.length)return y===r.length?Pi:Ru;var w=`${y},${x}`;if(h[w]!==void 0)return h[w];for(var E=c.charAt(x),A=n.indexOf(E,y),R=0,T,W,q,$;A>=0;)T=la(r,s,n,c,A+1,x+1,h),T>R&&(A===y?T*=Pi:Tu.test(r.charAt(A-1))?(T*=Cu,q=r.slice(y,A-1).match(Du),q&&y>0&&(T*=Math.pow(ea,q.length))):Ou.test(r.charAt(A-1))?(T*=Mu,$=r.slice(y,A-1).match(Xn),$&&y>0&&(T*=Math.pow(ea,$.length))):(T*=Au,y>0&&(T*=Math.pow(ea,A-y))),r.charAt(A)!==s.charAt(x)&&(T*=Eu)),(T<Qs&&n.charAt(A-1)===c.charAt(x+1)||c.charAt(x+1)===c.charAt(x)&&n.charAt(A-1)!==c.charAt(x))&&(W=la(r,s,n,c,A+1,x+2,h),W*Qs>T&&(T=W*Qs)),T>R&&(R=T),A=n.indexOf(E,A+1);return h[w]=R,R}function Gi(r){return r.toLowerCase().replace(Xn," ")}function zu(r,s,n){return r=n&&n.length>0?`${r+" "+n.join(" ")}`:r,la(r,s,Gi(r),Gi(s),0,0,{})}var $r='[cmdk-group=""]',ta='[cmdk-group-items=""]',Iu='[cmdk-group-heading=""]',Yn='[cmdk-item=""]',Ui=`${Yn}:not([aria-disabled="true"])`,da="cmdk-item-select",fr="data-value",Lu=(r,s,n)=>zu(r,s,n),Zn=b.createContext(void 0),Vr=()=>b.useContext(Zn),Kn=b.createContext(void 0),va=()=>b.useContext(Kn),Jn=b.createContext(void 0),Qn=b.forwardRef((r,s)=>{let n=xr(()=>{var B,ge;return{search:"",value:(ge=(B=r.value)!=null?B:r.defaultValue)!=null?ge:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),c=xr(()=>new Set),y=xr(()=>new Map),x=xr(()=>new Map),h=xr(()=>new Set),w=eo(r),{label:E,children:A,value:R,onValueChange:T,filter:W,shouldFilter:q,loop:$,disablePointerSelection:P=!1,vimBindings:M=!0,...G}=r,ae=wr(),Y=wr(),le=wr(),he=b.useRef(null),K=Xu();Jt(()=>{if(R!==void 0){let B=R.trim();n.current.value=B,me.emit()}},[R]),Jt(()=>{K(6,ne)},[]);let me=b.useMemo(()=>({subscribe:B=>(h.current.add(B),()=>h.current.delete(B)),snapshot:()=>n.current,setState:(B,ge,ye)=>{var xe,U,ve,Re;if(!Object.is(n.current[B],ge)){if(n.current[B]=ge,B==="search")H(),oe(),K(1,Ne);else if(B==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let Te=document.getElementById(le);Te?Te.focus():(xe=document.getElementById(ae))==null||xe.focus()}if(K(7,()=>{var Te;n.current.selectedItemId=(Te=F())==null?void 0:Te.id,me.emit()}),ye||K(5,ne),((U=w.current)==null?void 0:U.value)!==void 0){let Te=ge??"";(Re=(ve=w.current).onValueChange)==null||Re.call(ve,Te);return}}me.emit()}},emit:()=>{h.current.forEach(B=>B())}}),[]),L=b.useMemo(()=>({value:(B,ge,ye)=>{var xe;ge!==((xe=x.current.get(B))==null?void 0:xe.value)&&(x.current.set(B,{value:ge,keywords:ye}),n.current.filtered.items.set(B,X(ge,ye)),K(2,()=>{oe(),me.emit()}))},item:(B,ge)=>(c.current.add(B),ge&&(y.current.has(ge)?y.current.get(ge).add(B):y.current.set(ge,new Set([B]))),K(3,()=>{H(),oe(),n.current.value||Ne(),me.emit()}),()=>{x.current.delete(B),c.current.delete(B),n.current.filtered.items.delete(B);let ye=F();K(4,()=>{H(),(ye==null?void 0:ye.getAttribute("id"))===B&&Ne(),me.emit()})}),group:B=>(y.current.has(B)||y.current.set(B,new Set),()=>{x.current.delete(B),y.current.delete(B)}),filter:()=>w.current.shouldFilter,label:E||r["aria-label"],getDisablePointerSelection:()=>w.current.disablePointerSelection,listId:ae,inputId:le,labelId:Y,listInnerRef:he}),[]);function X(B,ge){var ye,xe;let U=(xe=(ye=w.current)==null?void 0:ye.filter)!=null?xe:Lu;return B?U(B,n.current.search,ge):0}function oe(){if(!n.current.search||w.current.shouldFilter===!1)return;let B=n.current.filtered.items,ge=[];n.current.filtered.groups.forEach(xe=>{let U=y.current.get(xe),ve=0;U.forEach(Re=>{let Te=B.get(Re);ve=Math.max(Te,ve)}),ge.push([xe,ve])});let ye=he.current;fe().sort((xe,U)=>{var ve,Re;let Te=xe.getAttribute("id"),Je=U.getAttribute("id");return((ve=B.get(Je))!=null?ve:0)-((Re=B.get(Te))!=null?Re:0)}).forEach(xe=>{let U=xe.closest(ta);U?U.appendChild(xe.parentElement===U?xe:xe.closest(`${ta} > *`)):ye.appendChild(xe.parentElement===ye?xe:xe.closest(`${ta} > *`))}),ge.sort((xe,U)=>U[1]-xe[1]).forEach(xe=>{var U;let ve=(U=he.current)==null?void 0:U.querySelector(`${$r}[${fr}="${encodeURIComponent(xe[0])}"]`);ve==null||ve.parentElement.appendChild(ve)})}function Ne(){let B=fe().find(ye=>ye.getAttribute("aria-disabled")!=="true"),ge=B==null?void 0:B.getAttribute(fr);me.setState("value",ge||void 0)}function H(){var B,ge,ye,xe;if(!n.current.search||w.current.shouldFilter===!1){n.current.filtered.count=c.current.size;return}n.current.filtered.groups=new Set;let U=0;for(let ve of c.current){let Re=(ge=(B=x.current.get(ve))==null?void 0:B.value)!=null?ge:"",Te=(xe=(ye=x.current.get(ve))==null?void 0:ye.keywords)!=null?xe:[],Je=X(Re,Te);n.current.filtered.items.set(ve,Je),Je>0&&U++}for(let[ve,Re]of y.current)for(let Te of Re)if(n.current.filtered.items.get(Te)>0){n.current.filtered.groups.add(ve);break}n.current.filtered.count=U}function ne(){var B,ge,ye;let xe=F();xe&&(((B=xe.parentElement)==null?void 0:B.firstChild)===xe&&((ye=(ge=xe.closest($r))==null?void 0:ge.querySelector(Iu))==null||ye.scrollIntoView({block:"nearest"})),xe.scrollIntoView({block:"nearest"}))}function F(){var B;return(B=he.current)==null?void 0:B.querySelector(`${Yn}[aria-selected="true"]`)}function fe(){var B;return Array.from(((B=he.current)==null?void 0:B.querySelectorAll(Ui))||[])}function S(B){let ge=fe()[B];ge&&me.setState("value",ge.getAttribute(fr))}function D(B){var ge;let ye=F(),xe=fe(),U=xe.findIndex(Re=>Re===ye),ve=xe[U+B];(ge=w.current)!=null&&ge.loop&&(ve=U+B<0?xe[xe.length-1]:U+B===xe.length?xe[0]:xe[U+B]),ve&&me.setState("value",ve.getAttribute(fr))}function z(B){let ge=F(),ye=ge==null?void 0:ge.closest($r),xe;for(;ye&&!xe;)ye=B>0?qu(ye,$r):Vu(ye,$r),xe=ye==null?void 0:ye.querySelector(Ui);xe?me.setState("value",xe.getAttribute(fr)):D(B)}let ce=()=>S(fe().length-1),ke=B=>{B.preventDefault(),B.metaKey?ce():B.altKey?z(1):D(1)},we=B=>{B.preventDefault(),B.metaKey?S(0):B.altKey?z(-1):D(-1)};return b.createElement(Ft.div,{ref:s,tabIndex:-1,...G,"cmdk-root":"",onKeyDown:B=>{var ge;(ge=G.onKeyDown)==null||ge.call(G,B);let ye=B.nativeEvent.isComposing||B.keyCode===229;if(!(B.defaultPrevented||ye))switch(B.key){case"n":case"j":{M&&B.ctrlKey&&ke(B);break}case"ArrowDown":{ke(B);break}case"p":case"k":{M&&B.ctrlKey&&we(B);break}case"ArrowUp":{we(B);break}case"Home":{B.preventDefault(),S(0);break}case"End":{B.preventDefault(),ce();break}case"Enter":{B.preventDefault();let xe=F();if(xe){let U=new Event(da);xe.dispatchEvent(U)}}}}},b.createElement("label",{"cmdk-label":"",htmlFor:L.inputId,id:L.labelId,style:Zu},E),ws(r,B=>b.createElement(Kn.Provider,{value:me},b.createElement(Zn.Provider,{value:L},B))))}),Bu=b.forwardRef((r,s)=>{var n,c;let y=wr(),x=b.useRef(null),h=b.useContext(Jn),w=Vr(),E=eo(r),A=(c=(n=E.current)==null?void 0:n.forceMount)!=null?c:h==null?void 0:h.forceMount;Jt(()=>{if(!A)return w.item(y,h==null?void 0:h.id)},[A]);let R=to(y,x,[r.value,r.children,x],r.keywords),T=va(),W=Bt(K=>K.value&&K.value===R.current),q=Bt(K=>A||w.filter()===!1?!0:K.search?K.filtered.items.get(y)>0:!0);b.useEffect(()=>{let K=x.current;if(!(!K||r.disabled))return K.addEventListener(da,$),()=>K.removeEventListener(da,$)},[q,r.onSelect,r.disabled]);function $(){var K,me;P(),(me=(K=E.current).onSelect)==null||me.call(K,R.current)}function P(){T.setState("value",R.current,!0)}if(!q)return null;let{disabled:M,value:G,onSelect:ae,forceMount:Y,keywords:le,...he}=r;return b.createElement(Ft.div,{ref:Ur(x,s),...he,id:y,"cmdk-item":"",role:"option","aria-disabled":!!M,"aria-selected":!!W,"data-disabled":!!M,"data-selected":!!W,onPointerMove:M||w.getDisablePointerSelection()?void 0:P,onClick:M?void 0:$},r.children)}),Fu=b.forwardRef((r,s)=>{let{heading:n,children:c,forceMount:y,...x}=r,h=wr(),w=b.useRef(null),E=b.useRef(null),A=wr(),R=Vr(),T=Bt(q=>y||R.filter()===!1?!0:q.search?q.filtered.groups.has(h):!0);Jt(()=>R.group(h),[]),to(h,w,[r.value,r.heading,E]);let W=b.useMemo(()=>({id:h,forceMount:y}),[y]);return b.createElement(Ft.div,{ref:Ur(w,s),...x,"cmdk-group":"",role:"presentation",hidden:T?void 0:!0},n&&b.createElement("div",{ref:E,"cmdk-group-heading":"","aria-hidden":!0,id:A},n),ws(r,q=>b.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?A:void 0},b.createElement(Jn.Provider,{value:W},q))))}),$u=b.forwardRef((r,s)=>{let{alwaysRender:n,...c}=r,y=b.useRef(null),x=Bt(h=>!h.search);return!n&&!x?null:b.createElement(Ft.div,{ref:Ur(y,s),...c,"cmdk-separator":"",role:"separator"})}),Pu=b.forwardRef((r,s)=>{let{onValueChange:n,...c}=r,y=r.value!=null,x=va(),h=Bt(A=>A.search),w=Bt(A=>A.selectedItemId),E=Vr();return b.useEffect(()=>{r.value!=null&&x.setState("search",r.value)},[r.value]),b.createElement(Ft.input,{ref:s,...c,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":E.listId,"aria-labelledby":E.labelId,"aria-activedescendant":w,id:E.inputId,type:"text",value:y?r.value:h,onChange:A=>{y||x.setState("search",A.target.value),n==null||n(A.target.value)}})}),Gu=b.forwardRef((r,s)=>{let{children:n,label:c="Suggestions",...y}=r,x=b.useRef(null),h=b.useRef(null),w=Bt(A=>A.selectedItemId),E=Vr();return b.useEffect(()=>{if(h.current&&x.current){let A=h.current,R=x.current,T,W=new ResizeObserver(()=>{T=requestAnimationFrame(()=>{let q=A.offsetHeight;R.style.setProperty("--cmdk-list-height",q.toFixed(1)+"px")})});return W.observe(A),()=>{cancelAnimationFrame(T),W.unobserve(A)}}},[]),b.createElement(Ft.div,{ref:Ur(x,s),...y,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":w,"aria-label":c,id:E.listId},ws(r,A=>b.createElement("div",{ref:Ur(h,E.listInnerRef),"cmdk-list-sizer":""},A)))}),Uu=b.forwardRef((r,s)=>{let{open:n,onOpenChange:c,overlayClassName:y,contentClassName:x,container:h,...w}=r;return b.createElement(nn,{open:n,onOpenChange:c},b.createElement(on,{container:h},b.createElement(ca,{"cmdk-overlay":"",className:y}),b.createElement(ha,{"aria-label":r.label,"cmdk-dialog":"",className:x},b.createElement(Qn,{ref:s,...w}))))}),Wu=b.forwardRef((r,s)=>Bt(n=>n.filtered.count===0)?b.createElement(Ft.div,{ref:s,...r,"cmdk-empty":"",role:"presentation"}):null),Hu=b.forwardRef((r,s)=>{let{progress:n,children:c,label:y="Loading...",...x}=r;return b.createElement(Ft.div,{ref:s,...x,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":y},ws(r,h=>b.createElement("div",{"aria-hidden":!0},h)))}),lt=Object.assign(Qn,{List:Gu,Item:Bu,Input:Pu,Group:Fu,Separator:$u,Dialog:Uu,Empty:Wu,Loading:Hu});function qu(r,s){let n=r.nextElementSibling;for(;n;){if(n.matches(s))return n;n=n.nextElementSibling}}function Vu(r,s){let n=r.previousElementSibling;for(;n;){if(n.matches(s))return n;n=n.previousElementSibling}}function eo(r){let s=b.useRef(r);return Jt(()=>{s.current=r}),s}var Jt=typeof window>"u"?b.useEffect:b.useLayoutEffect;function xr(r){let s=b.useRef();return s.current===void 0&&(s.current=r()),s}function Bt(r){let s=va(),n=()=>r(s.snapshot());return b.useSyncExternalStore(s.subscribe,n,n)}function to(r,s,n,c=[]){let y=b.useRef(),x=Vr();return Jt(()=>{var h;let w=(()=>{var A;for(let R of n){if(typeof R=="string")return R.trim();if(typeof R=="object"&&"current"in R)return R.current?(A=R.current.textContent)==null?void 0:A.trim():y.current}})(),E=c.map(A=>A.trim());x.value(r,w,E),(h=s.current)==null||h.setAttribute(fr,w),y.current=w}),y}var Xu=()=>{let[r,s]=b.useState(),n=xr(()=>new Map);return Jt(()=>{n.current.forEach(c=>c()),n.current=new Map},[r]),(c,y)=>{n.current.set(c,y),s({})}};function Yu(r){let s=r.type;return typeof s=="function"?s(r.props):"render"in s?s.render(r.props):r}function ws({asChild:r,children:s},n){return r&&b.isValidElement(s)?b.cloneElement(Yu(s),{ref:s.ref},n(s.props.children)):n(s)}var Zu={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Nr=nn,Ku=on,ro=b.forwardRef(({className:r,...s},n)=>e.jsx(ca,{ref:n,className:je("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...s}));ro.displayName=ca.displayName;const Qt=b.forwardRef(({className:r,children:s,...n},c)=>e.jsxs(Ku,{children:[e.jsx(ro,{}),e.jsxs(ha,{ref:c,className:je("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...n,children:[s,e.jsxs(wc,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(bs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Qt.displayName=ha.displayName;const er=({className:r,...s})=>e.jsx("div",{className:je("flex flex-col space-y-1.5 text-center sm:text-left",r),...s});er.displayName="DialogHeader";const Xr=({className:r,...s})=>e.jsx("div",{className:je("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...s});Xr.displayName="DialogFooter";const tr=b.forwardRef(({className:r,...s},n)=>e.jsx(ln,{ref:n,className:je("text-lg font-semibold leading-none tracking-tight",r),...s}));tr.displayName=ln.displayName;const Yr=b.forwardRef(({className:r,...s},n)=>e.jsx(dn,{ref:n,className:je("text-sm text-muted-foreground",r),...s}));Yr.displayName=dn.displayName;const so=b.forwardRef(({className:r,...s},n)=>e.jsx(lt,{ref:n,className:je("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",r),...s}));so.displayName=lt.displayName;const ao=b.forwardRef(({className:r,...s},n)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(Gn,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(lt.Input,{ref:n,className:je("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",r),...s})]}));ao.displayName=lt.Input.displayName;const io=b.forwardRef(({className:r,...s},n)=>e.jsx(lt.List,{ref:n,className:je("max-h-[300px] overflow-y-auto overflow-x-hidden",r),...s}));io.displayName=lt.List.displayName;const no=b.forwardRef((r,s)=>e.jsx(lt.Empty,{ref:s,className:"py-6 text-center text-sm",...r}));no.displayName=lt.Empty.displayName;const oo=b.forwardRef(({className:r,...s},n)=>e.jsx(lt.Group,{ref:n,className:je("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",r),...s}));oo.displayName=lt.Group.displayName;const Ju=b.forwardRef(({className:r,...s},n)=>e.jsx(lt.Separator,{ref:n,className:je("-mx-1 h-px bg-border",r),...s}));Ju.displayName=lt.Separator.displayName;const lo=b.forwardRef(({className:r,...s},n)=>e.jsx(lt.Item,{ref:n,className:je("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50",r),...s}));lo.displayName=lt.Item.displayName;const Qu=Nc,ep=kc,co=b.forwardRef(({className:r,align:s="center",sideOffset:n=4,...c},y)=>e.jsx(jc,{children:e.jsx(cn,{ref:y,align:s,sideOffset:n,className:je("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...c})}));co.displayName=cn.displayName;function Et({options:r,value:s,onValueChange:n,placeholder:c="Select option...",searchPlaceholder:y="Search...",emptyText:x="No option found.",className:h}){const[w,E]=b.useState(!1),A=r.find(R=>R.value===s);return e.jsxs(Qu,{open:w,onOpenChange:E,children:[e.jsx(ep,{asChild:!0,children:e.jsxs(Ce,{variant:"outline",role:"combobox","aria-expanded":w,className:je("w-full justify-between",h),children:[A?A.label:c,e.jsx(Kh,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(co,{className:"w-full p-0",align:"start",children:e.jsxs(so,{children:[e.jsx(ao,{placeholder:y}),e.jsxs(io,{children:[e.jsx(no,{children:x}),e.jsx(oo,{children:r.map(R=>e.jsxs(lo,{value:R.label,keywords:[R.label,R.value],onSelect:()=>{n(R.value),E(!1)},children:[e.jsx(Fn,{className:je("mr-2 h-4 w-4",s===R.value?"opacity-100":"opacity-0")}),R.label]},R.value))})]})]})})]})}const ho=b.createContext(void 0);function js(){const r=b.useContext(ho);if(!r)throw new Error("useMatchModal must be used within MatchModalProvider");return r}function tp({children:r}){const[s,n]=b.useState(null),c=b.useCallback(h=>{n(h)},[]),y=b.useCallback(()=>{n(null)},[]),x=b.useMemo(()=>({matchId:s,openMatch:c,closeMatch:y}),[s,c,y]);return e.jsx(ho.Provider,{value:x,children:r})}const Pr=25;function rp(){pt("Matches");const{players:r,matches:s,loading:n}=fs(),[c,y]=vn(),[x,h]=b.useState([]),[w,E]=b.useState([]),{openMatch:A}=js(),R=yn(),[T,W]=b.useState(()=>{const L=c.get("season");if(L===null||L==="all")return null;const X=parseInt(L,10);return Number.isFinite(X)?X:null}),[q,$]=b.useState(()=>c.get("search")||""),[P,M]=b.useState(()=>{const L=c.get("page");return L?parseInt(L,10):1});b.useEffect(()=>{const L=new URLSearchParams;P!==1&&L.set("page",P.toString()),q&&L.set("search",q),T!==null?L.set("season",String(T)):L.set("season","all");const X=L.toString(),oe=c.toString();X!==oe&&y(L)},[P,q,T,y,c]),b.useEffect(()=>{let L=!0;return(async()=>{const X=await Wr();L&&h(X)})(),()=>{L=!1}},[]),b.useEffect(()=>{let L=!0;return(async()=>{const X=await Sr();L&&E(X)})(),()=>{L=!1}},[]);const G=new Map(r.map(L=>[L.id,L])),ae=new Map(x.map(L=>[L.id,L])),le=[...s].sort((L,X)=>X.id-L.id).filter(L=>{var H,ne;const X=((H=G.get(L.player1_id))==null?void 0:H.name)??"",oe=((ne=G.get(L.player2_id))==null?void 0:ne.name)??"",Ne=q.toLowerCase();return X.toLowerCase().includes(Ne)||oe.toLowerCase().includes(Ne)}),he=T===null?le:le.filter(L=>L.season_id===T),K=Math.ceil(he.length/Pr),me=b.useMemo(()=>{const L=(P-1)*Pr,X=L+Pr;return he.slice(L,X)},[he,P]);return b.useEffect(()=>{M(1)},[q]),b.useEffect(()=>{M(1)},[T]),e.jsxs("section",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h2",{className:"text-4xl md:text-5xl font-heading font-bold text-transparent bg-clip-text bg-gradient-to-r from-primary via-primary/80 to-primary/50 drop-shadow-sm",children:"Matches"}),e.jsx("p",{className:"text-muted-foreground font-body text-lg",children:"Battle history and upcoming bouts."})]}),n&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 sm:items-center bg-card/30 p-4 rounded-lg border border-border/40 backdrop-blur-sm",children:[e.jsx("div",{className:"max-w-md w-full",children:e.jsx(We,{placeholder:"Filter by player name...",value:q,onChange:L=>$(L.target.value),className:"bg-background/50 border-primary/30 focus:ring-primary/50 font-body"})}),e.jsx("div",{className:"w-full sm:w-64",children:e.jsx(Et,{value:T===null?"all":String(T),onValueChange:L=>{W(L==="all"?null:parseInt(L,10))},placeholder:"Select season...",searchPlaceholder:"Search seasons...",options:[{value:"all",label:"All seasons"},...w.filter(L=>L.status==="active").map(L=>({value:String(L.id),label:`${L.name} (Active)`})),...w.filter(L=>L.status==="archived").sort((L,X)=>L.id-X.id).map(L=>({value:String(L.id),label:`${L.name} (Archived)`}))],className:"w-full"})})]}),me.length===0?e.jsx(Fe,{className:"bg-card/40 backdrop-blur-sm border-border/40",children:e.jsxs(Pe,{className:"py-12 flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:""}),e.jsx("p",{className:"text-muted-foreground font-heading uppercase tracking-wider text-lg",children:q?`No matches found for "${q}"`:"No matches found"})]})}):e.jsx(Fe,{className:"bg-card/50 backdrop-blur-sm border-border/50 overflow-hidden",children:e.jsx("div",{className:"divide-y divide-border/30",children:me.map(L=>{const X=G.get(L.player1_id),oe=G.get(L.player2_id),Ne=L.event_id?ae.get(L.event_id):null,H=L.winner_id!==null,ne=L.winner_id===L.player1_id;return!X||!oe?null:e.jsxs("button",{onClick:()=>A(L.id),className:"w-full text-left hover:bg-muted/30 transition-colors cursor-pointer focus:outline-none focus:bg-muted/30 px-4 py-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 md:gap-6",children:[e.jsxs("div",{onClick:F=>{F.stopPropagation(),R(`/players/${X.id}`)},className:"flex items-center gap-2 md:gap-3 flex-1 min-w-0 justify-end cursor-pointer group/p1",children:[e.jsx("span",{className:`font-heading font-bold text-sm md:text-base truncate transition-colors group-hover/p1:text-primary ${H&&ne?"text-yellow-500":""}`,children:X.name}),e.jsx(mt,{name:X.name,twitter:X.twitter,size:40,className:`h-10 w-10 shrink-0 border-2 transition-colors group-hover/p1:border-primary ${H&&ne?"border-yellow-500":"border-border"}`})]}),e.jsx("div",{className:"flex items-center justify-center shrink-0 min-w-[70px] md:min-w-[90px]",children:H?e.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2",children:[e.jsx("span",{className:`font-heading font-black text-lg md:text-2xl ${ne?"text-yellow-500":"text-muted-foreground"}`,children:L.player1_score??"?"}),e.jsx("span",{className:"text-muted-foreground text-sm md:text-base",children:"-"}),e.jsx("span",{className:`font-heading font-black text-lg md:text-2xl ${ne?"text-muted-foreground":"text-yellow-500"}`,children:L.player2_score??"?"})]}):e.jsx("span",{className:"text-muted-foreground font-heading font-bold text-sm md:text-lg uppercase",children:"vs"})}),e.jsxs("div",{onClick:F=>{F.stopPropagation(),R(`/players/${oe.id}`)},className:"flex items-center gap-2 md:gap-3 flex-1 min-w-0 justify-start cursor-pointer group/p2",children:[e.jsx(mt,{name:oe.name,twitter:oe.twitter,size:40,className:`h-10 w-10 shrink-0 border-2 transition-colors group-hover/p2:border-primary ${H&&!ne?"border-yellow-500":"border-border"}`}),e.jsx("span",{className:`font-heading font-bold text-sm md:text-base truncate transition-colors group-hover/p2:text-primary ${H&&!ne?"text-yellow-500":""}`,children:oe.name})]})]}),e.jsx("div",{className:"text-xs text-muted-foreground text-center mt-1.5 truncate h-4",children:Ne?Ne.title:"No event"})]},L.id)})})}),he.length>Pr&&e.jsx("div",{className:"flex justify-center pt-8",children:e.jsx(ma,{currentPage:P,totalPages:K,onPageChange:M,itemsPerPage:Pr,totalItems:he.length})})]})}function sp(){pt("Events");const[r,s]=b.useState([]),[n,c]=b.useState([]),[y,x]=b.useState(!0);b.useEffect(()=>{let w=!0;return(async()=>{const[E,A]=await Promise.all([Wr(),Ln()]);w&&(s(E),c(A),x(!1))})(),()=>{w=!1}},[]);const h=b.useMemo(()=>r.length?r.map(w=>{const E=n.filter(R=>R.event_id===w.id),A=E.filter(R=>R.winner_id!==null);return{...w,matchCount:E.length,completedCount:A.length}}):[],[r,n]);return y?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Events"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]}):h.length===0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Events"}),e.jsx(Fe,{children:e.jsx(Pe,{className:"pt-6",children:e.jsx("p",{className:"text-muted-foreground",children:"No events found."})})})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-heading font-bold text-transparent bg-clip-text bg-gradient-to-r from-primary via-primary/80 to-primary/50 drop-shadow-sm",children:"Events"}),e.jsx("p",{className:"text-muted-foreground font-body text-lg max-w-2xl",children:"Upcoming tournaments and past battle records."})]}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:h.map(w=>{const E=new Date(w.event_date)<new Date;return e.jsx(Ke,{to:`/events/${w.id}`,className:"group block h-full",children:e.jsxs(Fe,{className:"h-full bg-card/40 backdrop-blur-sm border-border/40 hover:bg-card/60 hover:border-primary/50 transition-all duration-300 hover:shadow-[0_0_20px_rgba(var(--primary-rgb),0.15)] overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-primary/0 to-transparent group-hover:via-primary/50 transition-all duration-500"}),e.jsxs(Ye,{className:"pb-3",children:[e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsx(Ze,{className:"font-heading text-xl font-bold tracking-wide group-hover:text-primary transition-colors line-clamp-2",children:w.title}),E?e.jsx("span",{className:"shrink-0 text-[10px] font-bold uppercase tracking-widest text-muted-foreground px-2 py-1 bg-muted/50 rounded border border-border/50",children:"Past"}):e.jsx("span",{className:"shrink-0 text-[10px] font-bold uppercase tracking-widest text-green-500 px-2 py-1 bg-green-500/10 rounded border border-green-500/20 animate-pulse",children:"Upcoming"})]}),e.jsx(it,{className:"font-mono text-xs uppercase tracking-wider mt-1",children:new Date(w.event_date).toLocaleString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})})]}),e.jsxs(Pe,{children:[w.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-4 line-clamp-2 border-l-2 border-primary/20 pl-3 italic",children:w.description}),e.jsxs("div",{className:"flex items-center justify-between mt-auto pt-4 border-t border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs text-muted-foreground uppercase tracking-wider font-bold",children:"Matches"}),e.jsx("span",{className:"font-heading font-bold text-lg",children:w.matchCount})]}),w.matchCount>0&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs text-muted-foreground uppercase tracking-wider font-bold",children:"Completed"}),e.jsx("span",{className:"font-heading font-bold text-lg text-primary",children:w.completedCount})]})]}),w.stream_url&&e.jsx("div",{className:`text-xs font-bold uppercase tracking-wider flex items-center gap-1 ${E?"text-muted-foreground":"text-red-500"}`,children:E?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""})," VOD"]}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"relative flex h-2 w-2 mr-1",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-red-500"})]}),"Live"]})})]})]})]})},w.id)})})]})}const us=.5,ps=173.7178;function ra(r){return 1/Math.sqrt(1+3*r*r/(Math.PI*Math.PI))}function sa(r,s,n){return 1/(1+Math.exp(-n*(r-s)))}function cs(r){return{mu:(r.rating-1500)/ps,phi:r.rd/ps,sigma:r.vol}}function ap(r,s,n){return{rating:r*ps+1500,rd:s*ps,vol:n}}function Wi(r,s){if(s.length===0)return r;const{mu:n,phi:c,sigma:y}=cs(r),h=1/s.reduce((he,K)=>{const me=cs(K.opponent),L=ra(me.phi),X=sa(n,me.mu,L);return he+L*L*X*(1-X)},0),w=h*s.reduce((he,K)=>{const me=cs(K.opponent),L=ra(me.phi),X=sa(n,me.mu,L);return he+L*(K.score-X)},0),E=Math.log(y*y),A=1e-6;let R=E,T;if(w*w>c*c+h)T=Math.log(Math.max(w*w-c*c-h,A));else{let he=1;const K=1e3;for(;hs(E-he*us,w,c,h,E)<0&&he<K;)he++;if(he>=K)return r;T=E-he*us}let W=hs(R,w,c,h,E),q=hs(T,w,c,h,E),$=0;const P=100;for(;Math.abs(T-R)>A&&$<P;){const he=R+(R-T)*W/(q-W),K=hs(he,w,c,h,E);K*q<0?(R=T,W=q):W/=2,T=he,q=K,$++}if($>=P||!isFinite(R))return r;const M=Math.exp(R/2),G=Math.sqrt(c*c+M*M),ae=1/Math.sqrt(1/(G*G)+1/h),Y=n+ae*ae*s.reduce((he,K)=>{const me=cs(K.opponent),L=ra(me.phi),X=sa(n,me.mu,L);return he+L*(K.score-X)},0),le=ap(Y,ae,M);return!isFinite(le.rating)||!isFinite(le.rd)||!isFinite(le.vol)?r:le}function hs(r,s,n,c,y){const x=Math.exp(r),h=x*(s*s-n*n-c-x),w=2*(n*n+c+x)*(n*n+c+x);return h/w-(r-y)/(us*us)}function Hi(r,s){const n=r.rating??1500,c={rating:n,rd:r.rd??350,vol:r.volatility??.06},y={rating:s.rating??1500,rd:s.rd??350,vol:s.volatility??.06},x=Wi(c,[{opponent:y,score:1}]),h=x.rating-n,w=Wi(c,[{opponent:y,score:0}]),E=w.rating-n;return{winRatingChange:h,loseRatingChange:E,winNewRating:x.rating,loseNewRating:w.rating}}function ip(r,s){return{player1:Hi(r,s),player2:Hi(s,r)}}function yr(r){return`${r>=0?"+":""}${r.toFixed(1)}`}function aa(r){return r.includes("youtube.com")||r.includes("youtu.be")?e.jsx(Hn,{size:14}):r.includes("twitch.tv")?e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",className:"inline-block",children:e.jsx("path",{d:"M11.571 4.714h1.715v5.143H11.57zm4.715 0H18v5.143h-1.714zM6 0L1.714 4.286v15.428h5.143V24l4.286-4.286h3.428L22.286 12V0zm14.571 11.143l-3.428 3.428h-3.429l-3 3v-3H6.857V1.714h13.714Z"})}):e.jsx(Pn,{size:14})}function np({match:r,player1:s,player2:n,showMatchNumber:c,matchNumber:y,event:x,showEventLink:h=!1,showLinksInHeader:w=!1}){const{openMatch:E}=js(),A=r.winner_id!==null,R=r.winner_id===r.player1_id,T=h&&x||r.vod_link;return e.jsxs("div",{className:"group relative p-4 border border-border/40 rounded-lg space-y-3 bg-card/40 backdrop-blur-sm hover:bg-card/60 transition-all duration-300 hover:border-primary/50 hover:shadow-[0_0_15px_rgba(var(--primary-rgb),0.2)] overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-gradient-to-b from-transparent via-primary/0 to-transparent group-hover:via-primary/50 transition-all duration-500"}),(c||w&&T)&&e.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap border-b border-white/5 pb-2 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[w&&T&&e.jsxs(e.Fragment,{children:[h&&x&&e.jsx(Ke,{className:"text-primary hover:text-primary/80 hover:underline inline-flex items-center gap-1 font-heading font-bold tracking-wide transition-colors",to:`/events/${x.id}`,children:x.title}),r.vod_link&&!c&&e.jsxs("a",{href:r.vod_link,target:"_blank",rel:"noopener noreferrer",className:"text-red-500 hover:text-red-400 hover:underline inline-flex items-center gap-1 font-bold transition-colors",children:[aa(r.vod_link),"Watch"]})]}),c&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs font-heading font-bold uppercase tracking-widest text-muted-foreground",children:["Match ",y]}),A&&e.jsx("div",{className:"text-[10px] font-bold uppercase tracking-wider text-green-500 px-1.5 py-0.5 bg-green-500/10 rounded border border-green-500/20",children:"Completed"})]})]}),c&&r.vod_link&&e.jsxs("a",{href:r.vod_link,target:"_blank",rel:"noopener noreferrer",className:"text-red-500 hover:text-red-400 hover:underline inline-flex items-center gap-1 text-xs font-bold uppercase tracking-wider transition-colors",children:[aa(r.vod_link),"Watch"]})]}),e.jsxs("div",{className:`relative flex items-center justify-between p-2 rounded-md transition-colors ${A&&R?"bg-gradient-to-r from-yellow-500/10 to-transparent border-l-2 border-yellow-500":"hover:bg-white/5"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx(mt,{name:s.name,twitter:s.twitter,size:48,className:`h-12 w-12 shrink-0 border-2 ${A&&R?"border-yellow-500 shadow-[0_0_10px_rgba(234,179,8,0.3)]":"border-border"}`}),e.jsxs("div",{className:"min-w-0",children:[e.jsx(Ke,{to:`/players/${s.id}`,className:"group/player",children:e.jsxs("div",{className:`font-heading font-bold text-lg flex items-center gap-2 flex-wrap transition-colors ${A&&R?"text-yellow-500":"text-foreground group-hover/player:text-primary"}`,children:[A&&R&&e.jsx("span",{className:"text-yellow-500",children:""}),e.jsx("span",{className:"truncate",children:s.name})]})}),e.jsxs("div",{className:"text-xs font-mono text-muted-foreground",children:["Rating: ",s.rating===null?"Unrated":Math.round(s.rating)]})]})]}),A&&e.jsx("div",{className:"text-sm font-bold font-mono shrink-0",children:e.jsx("span",{className:r.rating_change_p1&&r.rating_change_p1>=0?"text-green-500":"text-red-500",children:r.rating_change_p1!==null&&r.rating_change_p1!==void 0?yr(r.rating_change_p1):""})})]}),A?e.jsxs("button",{onClick:()=>E(r.id),className:"relative flex items-center justify-center gap-4 font-heading font-black cursor-pointer w-full py-1 hover:scale-105 transition-transform",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent opacity-0 hover:opacity-100 transition-opacity"}),e.jsx("span",{className:R?"text-yellow-500 text-3xl drop-shadow-[0_0_10px_rgba(234,179,8,0.5)]":"text-muted-foreground text-2xl",children:r.player1_score??"?"}),e.jsx("span",{className:"text-muted-foreground/50 text-xl",children:"-"}),e.jsx("span",{className:R?"text-muted-foreground text-2xl":"text-yellow-500 text-3xl drop-shadow-[0_0_10px_rgba(234,179,8,0.5)]",children:r.player2_score??"?"})]}):e.jsx("div",{className:"flex items-center justify-center py-2",children:e.jsx("span",{className:"text-2xl font-heading font-black text-transparent bg-clip-text bg-gradient-to-b from-muted-foreground to-muted-foreground/50 italic pr-1",children:"VS"})}),e.jsxs("div",{className:`relative flex items-center justify-between p-2 rounded-md transition-colors ${A&&!R?"bg-gradient-to-r from-yellow-500/10 to-transparent border-l-2 border-yellow-500":"hover:bg-white/5"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx(mt,{name:n.name,twitter:n.twitter,size:48,className:`h-12 w-12 shrink-0 border-2 ${A&&!R?"border-yellow-500 shadow-[0_0_10px_rgba(234,179,8,0.3)]":"border-border"}`}),e.jsxs("div",{className:"min-w-0",children:[e.jsx(Ke,{to:`/players/${n.id}`,className:"group/player",children:e.jsxs("div",{className:`font-heading font-bold text-lg flex items-center gap-2 flex-wrap transition-colors ${A&&!R?"text-yellow-500":"text-foreground group-hover/player:text-primary"}`,children:[A&&!R&&e.jsx("span",{className:"text-yellow-500",children:""}),e.jsx("span",{className:"truncate",children:n.name})]})}),e.jsxs("div",{className:"text-xs font-mono text-muted-foreground",children:["Rating: ",n.rating===null?"Unrated":Math.round(n.rating)]})]})]}),A&&e.jsx("div",{className:"text-sm font-bold font-mono shrink-0",children:e.jsx("span",{className:r.rating_change_p2&&r.rating_change_p2>=0?"text-green-500":"text-red-500",children:r.rating_change_p2!==null&&r.rating_change_p2!==void 0?yr(r.rating_change_p2):""})})]}),!w&&!c&&T&&e.jsxs("div",{className:"flex items-center justify-center gap-4 text-xs font-bold uppercase tracking-wider text-muted-foreground border-t border-white/5 pt-3 mt-2",children:[h&&x&&e.jsxs(Ke,{className:"text-primary hover:text-primary/80 hover:underline inline-flex items-center gap-1 transition-colors",to:`/events/${x.id}`,children:["Event: ",x.title]}),r.vod_link&&e.jsxs("a",{href:r.vod_link,target:"_blank",rel:"noopener noreferrer",className:"text-red-500 hover:text-red-400 hover:underline inline-flex items-center gap-1 transition-colors",children:[aa(r.vod_link),"Watch"]})]})]})}function op(){const{id:r}=wn(),[s,n]=b.useState([]),[c,y]=b.useState(null),[x,h]=b.useState([]),[w,E]=b.useState(!0);b.useEffect(()=>{let T=!0;return(async()=>{const[W,q,$]=await Promise.all([ga(),Wr(),Ln()]);if(!T)return;n(W);const P=q.find(M=>M.id===Number(r));y(P||null),h($.filter(M=>M.event_id===Number(r))),E(!1)})(),()=>{T=!1}},[r]);const A=b.useMemo(()=>{if(!s.length||!x.length)return[];const T=new Map(s.map(W=>[W.id,W]));return x.map(W=>({...W,player1:T.get(W.player1_id),player2:T.get(W.player2_id)})).sort((W,q)=>(W.match_order??0)-(q.match_order??0))},[s,x]);if(w)return pt("Event"),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsx(Ke,{to:"/events",children:e.jsx(Ce,{variant:"outline",size:"sm",children:" Back to Events"})})}),e.jsx("h1",{className:"text-3xl font-bold",children:"Loading..."})]});if(!c)return pt("Event Not Found"),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsx(Ke,{to:"/events",children:e.jsx(Ce,{variant:"outline",size:"sm",children:" Back to Events"})})}),e.jsx("h1",{className:"text-3xl font-bold",children:"Event Not Found"}),e.jsx("p",{className:"text-muted-foreground",children:"The event you're looking for doesn't exist."})]});const R=new Date(c.event_date)<new Date;return pt(`Event - ${c.title}`),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsx(Ke,{to:"/events",children:e.jsx(Ce,{variant:"ghost",size:"sm",className:"hover:bg-primary/10 hover:text-primary transition-colors font-heading uppercase tracking-wider font-bold",children:" Back to Events"})})}),e.jsxs(Fe,{className:"bg-card/80 backdrop-blur-md border-border/60 shadow-lg overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-primary/50 to-transparent"}),e.jsx(Ye,{className:"border-b border-border/30 bg-muted/20 relative z-10",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs(Ze,{className:"flex items-center gap-3 font-heading text-3xl font-bold tracking-wide text-primary drop-shadow-md",children:[c.title,R&&e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest text-muted-foreground px-2 py-1 bg-muted/50 rounded border border-border/50",children:"Past Event"})]}),e.jsx(it,{className:"font-body text-lg mt-1",children:new Date(c.event_date).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"})}),c.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-4 max-w-2xl leading-relaxed border-l-2 border-primary/30 pl-4 italic",children:c.description})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full md:w-auto",children:[c.stream_url&&e.jsxs("a",{href:c.stream_url,target:"_blank",rel:"noopener noreferrer",className:"px-6 py-2 bg-primary text-primary-foreground rounded hover:bg-primary/90 transition-all shadow-lg hover:shadow-primary/25 font-heading font-bold uppercase tracking-wider text-sm text-center flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-lg",children:""})," ",R?"Stream VOD":"Watch Stream"]}),c.vod_link&&e.jsxs("a",{href:c.vod_link,target:"_blank",rel:"noopener noreferrer",className:"px-6 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-all shadow-lg hover:shadow-red-600/25 font-heading font-bold uppercase tracking-wider text-sm text-center flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-lg",children:""})," Event VOD"]})]})]})}),e.jsx(Pe,{className:"p-6 relative z-10",children:A.length===0?e.jsx("div",{className:"text-center py-12 border-2 border-dashed border-border/30 rounded-lg bg-card/30",children:e.jsx("p",{className:"text-muted-foreground font-heading uppercase tracking-wider",children:"No matches scheduled for this event yet."})}):e.jsx("div",{className:"space-y-4",children:A.map((T,W)=>{const{player1:q,player2:$}=T;return!q||!$?e.jsx("div",{className:"p-4 border border-border/40 rounded-lg bg-card/30 backdrop-blur-sm",children:e.jsxs("p",{className:"text-muted-foreground italic",children:["Match ",W+1,": Player data not found"]})},T.id):e.jsx(np,{match:T,player1:q,player2:$,event:c,showMatchNumber:!0,matchNumber:W+1,showEventLink:!1},T.id)})})}),e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-primary/5 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 pointer-events-none"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-blue-500/5 rounded-full blur-3xl translate-y-1/2 -translate-x-1/2 pointer-events-none"})]})]})}function lp(){return pt("Profile"),e.jsx("div",{className:"container py-20 flex justify-center",children:e.jsxs("div",{className:"max-w-md w-full bg-card/80 backdrop-blur-xl border border-border/60 shadow-[0_0_50px_rgba(0,0,0,0.5)] rounded-lg p-8 text-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-primary to-transparent"}),e.jsx("h2",{className:"text-3xl font-heading font-bold text-primary mb-4",children:"Profile"}),e.jsx("p",{className:"text-muted-foreground font-body text-lg",children:"Coming soon."}),e.jsx("div",{className:"mt-8 h-1 w-16 bg-primary/30 mx-auto rounded-full"})]})})}var uo={exports:{}};(function(r,s){(function(n,c){r.exports=c(n._Highcharts,n._Highcharts.Point,n._Highcharts.Axis,n._Highcharts.Color,n._Highcharts.SeriesRegistry,n._Highcharts.RendererRegistry,n._Highcharts.SVGRenderer,n._Highcharts.SVGElement,n._Highcharts.Templating,n._Highcharts.Chart,n._Highcharts.Series.types.column,n._Highcharts.Series,n._Highcharts.StackItem)})(typeof window>"u"?Mc:window,(n,c,y,x,h,w,E,A,R,T,W,q,$)=>(()=>{let P,M,G,ae;var Y,le,he,K,me,L,X,oe,Ne={28:u=>{u.exports=A},184:u=>{u.exports=$},260:u=>{u.exports=c},448:u=>{u.exports=W},512:u=>{u.exports=h},532:u=>{u.exports=y},540:u=>{u.exports=E},608:u=>{u.exports=w},620:u=>{u.exports=x},820:u=>{u.exports=q},944:u=>{u.exports=n},960:u=>{u.exports=T},984:u=>{u.exports=R}},H={};function ne(u){var t=H[u];if(t!==void 0)return t.exports;var a=H[u]={exports:{}};return Ne[u](a,a.exports,ne),a.exports}ne.n=u=>{var t=u&&u.__esModule?()=>u.default:()=>u;return ne.d(t,{a:t}),t},ne.d=(u,t)=>{for(var a in t)ne.o(t,a)&&!ne.o(u,a)&&Object.defineProperty(u,a,{enumerable:!0,get:t[a]})},ne.o=(u,t)=>Object.prototype.hasOwnProperty.call(u,t);var F={};ne.d(F,{default:()=>uc});var fe=ne(944),S=ne.n(fe),D=ne(260);let{tooltipFormatter:z}=ne.n(D)().prototype,{addEvent:ce,arrayMax:ke,arrayMin:we,correctFloat:B,defined:ge,isArray:ye,isNumber:xe,isString:U,pick:ve}=S();(function(u){function t(v,d,g){!this.isXAxis&&(this.series.forEach(function(m){v==="compare"&&typeof d!="boolean"?m.setCompare(d,!1):v!=="cumulative"||U(d)||m.setCumulative(d,!1)}),ve(g,!0)&&this.chart.redraw())}function a(v){let d=this,{numberFormatter:g}=d.series.chart,m=function(_){v=v.replace("{point."+_+"}",(d[_]>0&&_==="change"?"+":"")+g(d[_],ve(d.series.tooltipOptions.changeDecimals,2)))};return ge(d.change)&&m("change"),ge(d.cumulativeSum)&&m("cumulativeSum"),z.apply(this,[v])}function i(){let v,d=this.options.compare;(d==="percent"||d==="value"||this.options.cumulative)&&(v=new f(this),d==="percent"||d==="value"?v.initCompare(d):v.initCumulative()),this.dataModify=v}function o(v){let d=v.dataExtremes,g=d.activeYData;if(this.dataModify&&d){let m;this.options.compare?m=[this.dataModify.modifyValue(d.dataMin),this.dataModify.modifyValue(d.dataMax)]:this.options.cumulative&&ye(g)&&g.length>=2&&(m=f.getCumulativeExtremes(g)),m&&(d.dataMin=we(m),d.dataMax=ke(m))}}function l(v,d){this.options.compare=this.userOptions.compare=v,this.update({},ve(d,!0)),this.dataModify&&(v==="value"||v==="percent")?this.dataModify.initCompare(v):this.points.forEach(g=>{delete g.change})}function p(){let v=this.getColumn(this.pointArrayMap&&(this.options.pointValKey||this.pointValKey)||"y",!0);if(this.xAxis&&v.length&&this.dataModify){let d=this.getColumn("x",!0),g=this.dataTable.rowCount,m=+(this.options.compareStart!==!0);for(let _=0;_<g-m;_++){let C=v[_];if(xe(C)&&C!==0&&d[_+m]>=(this.xAxis.min||0)){this.dataModify.compareValue=C;break}}}}function j(v,d){this.setModifier("compare",v,d)}function N(v,d){v=ve(v,!1),this.options.cumulative=this.userOptions.cumulative=v,this.update({},ve(d,!0)),this.dataModify?this.dataModify.initCumulative():this.points.forEach(g=>{delete g.cumulativeSum})}function k(v,d){this.setModifier("cumulative",v,d)}u.compose=function(v,d,g){let m=d.prototype,_=g.prototype,C=v.prototype;return C.setCompare||(C.setCompare=l,C.setCumulative=N,ce(v,"afterInit",i),ce(v,"afterGetExtremes",o),ce(v,"afterProcessData",p)),m.setCompare||(m.setCompare=j,m.setModifier=t,m.setCumulative=k,_.tooltipFormatter=a),v};class f{constructor(d){this.series=d}modifyValue(){return 0}static getCumulativeExtremes(d){let g=1/0,m=-1/0;return d.reduce((_,C)=>{let O=_+C;return g=Math.min(g,O,_),m=Math.max(m,O,_),O}),[g,m]}initCompare(d){this.modifyValue=function(g,m){g===null&&(g=0);let _=this.compareValue;if(g!==void 0&&_!==void 0){if(d==="value"?g-=_:g=g/_*100-100*(this.series.options.compareBase!==100),m!==void 0){let C=this.series.points[m];C&&(C.change=g)}return g}return 0}}initCumulative(){this.modifyValue=function(d,g){if(d===null&&(d=0),d!==void 0&&g!==void 0){let m=g>0?this.series.points[g-1]:null;m&&m.cumulativeSum&&(d=B(m.cumulativeSum+d));let _=this.series.points[g],C=_.series.options.cumulativeStart,O=_.x<=this.series.xAxis.max&&_.x>=this.series.xAxis.min;return _&&(!C||O?_.cumulativeSum=d:_.cumulativeSum=void 0),d}return 0}}}u.Additions=f})(Y||(Y={}));let Re=Y;var Te=ne(532),Je=ne.n(Te);let{isTouchDevice:He}=S(),{addEvent:ht,merge:Mr,pick:Cr}=S(),rr=[];function Ms(){this.navigator&&this.navigator.setBaseSeries(null,!1)}function sr(){var l;let u,t,a,i=this.legend,o=this.navigator;if(o){u=i&&i.options,t=o.xAxis,a=o.yAxis;let{scrollbarHeight:p,scrollButtonSize:j}=o;this.inverted?(o.left=o.opposite?this.chartWidth-p-o.height:this.spacing[3]+p,o.top=this.plotTop+j):(o.left=Cr(t.left,this.plotLeft+j),o.top=o.navigatorOptions.top||this.chartHeight-o.height-p-(((l=this.scrollbar)==null?void 0:l.options.margin)||0)-this.spacing[2]-(this.rangeSelector&&this.extraBottomMargin?this.rangeSelector.getHeight():0)-(u&&u.verticalAlign==="bottom"&&u.layout!=="proximate"&&u.enabled&&!u.floating?i.legendHeight+Cr(u.margin,10):0)-(this.titleOffset?this.titleOffset[2]:0)),t&&a&&(this.inverted?t.options.left=a.options.left=o.left:t.options.top=a.options.top=o.top,t.setAxisSize(),a.setAxisSize())}}function gt(u){!this.navigator&&!this.scroller&&(this.options.navigator.enabled||this.options.scrollbar.enabled)&&(this.scroller=this.navigator=new P(this),Cr(u.redraw,!0)&&this.redraw(u.animation))}function Zr(){let u=this.options;(u.navigator.enabled||u.scrollbar.enabled)&&(this.scroller=this.navigator=new P(this))}function _o(){let u=this.options,t=u.navigator,a=u.rangeSelector;if((t&&t.enabled||a&&a.enabled)&&(!He&&this.zooming.type==="x"||He&&this.zooming.pinchType==="x"))return!1}function So(u){let t=u.navigator;if(t&&u.xAxis[0]){let a=u.xAxis[0].getExtremes();t.render(a.min,a.max)}}function Mo(u){let t=u.options.navigator||{},a=u.options.scrollbar||{};!this.navigator&&!this.scroller&&(t.enabled||a.enabled)&&(Mr(!0,this.options.navigator,t),Mr(!0,this.options.scrollbar,a),delete u.options.navigator,delete u.options.scrollbar)}let Co={compose:function(u,t){if(S().pushUnique(rr,u)){let a=u.prototype;P=t,a.callbacks.push(So),ht(u,"afterAddSeries",Ms),ht(u,"afterSetChartSize",sr),ht(u,"afterUpdate",gt),ht(u,"beforeRender",Zr),ht(u,"beforeShowResetZoom",_o),ht(u,"update",Mo)}}},{isTouchDevice:Ao}=S(),{addEvent:ja,correctFloat:Na,defined:Cs,isNumber:ka,pick:_a}=S();function Eo(){this.navigatorAxis||(this.navigatorAxis=new As(this))}function Ro(u){let t,a=this.chart,i=a.options,o=i.navigator,l=this.navigatorAxis,p=a.zooming.pinchType,j=i.rangeSelector,N=a.zooming.type;if(this.isXAxis&&(o!=null&&o.enabled||j!=null&&j.enabled)){if(N==="y"&&u.trigger==="zoom")t=!1;else if((u.trigger==="zoom"&&N==="xy"||Ao&&p==="xy")&&this.options.range){let k=l.previousZoom;Cs(u.min)?l.previousZoom=[this.min,this.max]:k&&(u.min=k[0],u.max=k[1],l.previousZoom=void 0)}}t!==void 0&&u.preventDefault()}class As{static compose(t){t.keepProps.includes("navigatorAxis")||(t.keepProps.push("navigatorAxis"),ja(t,"init",Eo),ja(t,"setExtremes",Ro))}constructor(t){this.axis=t}destroy(){this.axis=void 0}toFixedRange(t,a,i,o){let l=this.axis,p=(l.pointRange||0)/2,j=_a(i,l.translate(t,!0,!l.horiz)),N=_a(o,l.translate(a,!0,!l.horiz));return Cs(i)||(j=Na(j+p)),Cs(o)||(N=Na(N-p)),ka(j)&&ka(N)||(j=N=void 0),{min:j,max:N}}}var To=ne(620),Do=ne.n(To),Oo=ne(512),dt=ne.n(Oo);let{parse:zo}=Do(),{seriesTypes:Io}=dt(),Es={height:40,margin:22,maskInside:!0,handles:{width:7,borderRadius:0,height:15,symbols:["navigator-handle","navigator-handle"],enabled:!0,lineWidth:1,backgroundColor:"#f2f2f2",borderColor:"#999999"},maskFill:zo("#667aff").setOpacity(.3).get(),outlineColor:"#999999",outlineWidth:1,series:{type:Io.areaspline===void 0?"line":"areaspline",fillOpacity:.05,lineWidth:1,compare:null,sonification:{enabled:!1},dataGrouping:{approximation:"average",enabled:!0,groupPixelWidth:2,firstAnchor:"firstPoint",anchor:"middle",lastAnchor:"lastPoint",units:[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2,3,4]],["week",[1,2,3]],["month",[1,3,6]],["year",null]]},dataLabels:{enabled:!1,zIndex:2},id:"highcharts-navigator-series",className:"highcharts-navigator-series",lineColor:null,marker:{enabled:!1},threshold:null},xAxis:{className:"highcharts-navigator-xaxis",tickLength:0,lineWidth:0,gridLineColor:"#e6e6e6",id:"navigator-x-axis",gridLineWidth:1,tickPixelInterval:200,labels:{align:"left",style:{color:"#000000",fontSize:"0.7em",opacity:.6,textOutline:"2px contrast"},x:3,y:-4},crosshair:!1},yAxis:{className:"highcharts-navigator-yaxis",gridLineWidth:0,startOnTick:!1,endOnTick:!1,minPadding:.1,id:"navigator-y-axis",maxPadding:.1,labels:{enabled:!1},crosshair:!1,title:{text:void 0},tickLength:0,tickWidth:0}},{defined:Bp,isNumber:Fp,pick:$p}=S(),Lo={rect:function(u,t,a,i,o){return o!=null&&o.r?function(l,p,j,N,k){let f=(k==null?void 0:k.r)||0;return[["M",l+f,p],["L",l+j-f,p],["A",f,f,0,0,1,l+j,p+f],["L",l+j,p+N-f],["A",f,f,0,0,1,l+j-f,p+N],["L",l+f,p+N],["A",f,f,0,0,1,l,p+N-f],["L",l,p+f],["A",f,f,0,0,1,l+f,p],["Z"]]}(u,t,a,i,o):[["M",u,t],["L",u+a,t],["L",u+a,t+i],["L",u,t+i],["Z"]]}},{relativeLength:Bo}=S(),Fo={"navigator-handle":function(u,t,a,i,o={}){let l=o.width?o.width/2:a,p=Bo(o.borderRadius||0,Math.min(2*l,i));return[["M",-1.5,(i=o.height||i)/2-3.5],["L",-1.5,i/2+4.5],["M",.5,i/2-3.5],["L",.5,i/2+4.5],...Lo.rect(-l-1,.5,2*l+1,i,{r:p})]}};var $o=ne(608),Sa=ne.n($o);let{defined:Ma}=S(),Ca={setFixedRange:function(u){let t=this.xAxis[0];Ma(t.dataMax)&&Ma(t.dataMin)&&u?this.fixedRange=Math.min(u,t.dataMax-t.dataMin):this.fixedRange=u}},{defaultOptions:Po}=S(),{composed:Go}=S(),{getRendererType:Uo}=Sa(),{setFixedRange:Wo}=Ca,{addEvent:Ho,extend:Aa,pushUnique:qo}=S();function Vo(){this.chart.navigator&&!this.options.isInternal&&this.chart.navigator.setBaseSeries(null,!1)}let Xo={compose:function(u,t,a){As.compose(t),qo(Go,"Navigator")&&(u.prototype.setFixedRange=Wo,Aa(Uo().prototype.symbols,Fo),Aa(Po,{navigator:Es}),Ho(a,"afterUpdate",Vo))}},{composed:Yo}=S(),{addEvent:Kr,correctFloat:Ea,defined:$t,pick:Ra,pushUnique:Zo}=S();(function(u){let t;function a(p){var k,f,v;let j=Ra((k=p.options)==null?void 0:k.min,p.min),N=Ra((f=p.options)==null?void 0:f.max,p.max);return{axisMin:j,axisMax:N,scrollMin:$t(p.dataMin)?Math.min(j,p.min??1/0,p.dataMin,p.threshold??1/0):j,scrollMax:((v=p.treeGrid)==null?void 0:v.adjustedMax)??($t(p.dataMax)?Math.max(N,p.max??-1/0,p.dataMax,p.threshold??-1/0):N)}}function i(){let p=this.scrollbar,j=p&&!p.options.opposite,N=this.horiz?2:j?3:1;p&&(this.chart.scrollbarsOffsets=[0,0],this.chart.axisOffset[N]+=p.size+(p.options.margin||0))}function o(){var j,N;let p=this;(N=(j=p.options)==null?void 0:j.scrollbar)!=null&&N.enabled&&(p.options.scrollbar.vertical=!p.horiz,p.options.startOnTick=p.options.endOnTick=!1,p.scrollbar=new t(p.chart.renderer,p.options.scrollbar,p.chart),Kr(p.scrollbar,"changed",function(k){let f,v,{axisMin:d,axisMax:g,scrollMin:m,scrollMax:_}=a(p),C=p.toPixels(m),O=p.toPixels(_)-C;if($t(d)&&$t(g))if(p.horiz&&!p.reversed||!p.horiz&&p.reversed?(f=Math.min(_,p.toValue(C+O*this.to)),v=Math.max(m,p.toValue(C+O*this.from))):(f=Math.min(_,p.toValue(C+O*(1-this.from))),v=Math.max(m,p.toValue(C+O*(1-this.to)))),this.shouldUpdateExtremes(k.DOMType)){let I=k.DOMType!=="mousemove"&&k.DOMType!=="touchmove"&&void 0;p.setExtremes(Ea(v),Ea(f),!0,I,k)}else this.setRange(this.from,this.to)}))}function l(){let p,j,N,{scrollMin:k,scrollMax:f}=a(this),v=this.scrollbar,d=(this.axisTitleMargin||0)+(this.titleOffset||0),g=this.chart.scrollbarsOffsets,m=this.options.margin||0;if(v&&g){if(this.horiz)this.opposite||(g[1]+=d),v.position(this.left,this.top+this.height+2+g[1]-(this.opposite?m:0),this.width,this.height),this.opposite||(g[1]+=m),p=1;else{let _;this.opposite&&(g[0]+=d),_=v.options.opposite?this.left+this.width+2+g[0]-(this.opposite?0:m):this.opposite?0:m,v.position(_,this.top,this.width,this.height),this.opposite&&(g[0]+=m),p=0}if(g[p]+=v.size+(v.options.margin||0),isNaN(k)||isNaN(f)||!$t(this.min)||!$t(this.max)||$t(this.dataMin)&&this.dataMin===this.dataMax)v.setRange(0,1);else if(this.min===this.max){let _=this.pointRange/(this.dataMax+1);j=_*this.min,N=_*(this.max+1),v.setRange(j,N)}else j=(this.toPixels(this.min)-this.toPixels(k))/(this.toPixels(f)-this.toPixels(k)),N=(this.toPixels(this.max)-this.toPixels(k))/(this.toPixels(f)-this.toPixels(k)),this.horiz&&!this.reversed||!this.horiz&&this.reversed?v.setRange(j,N):v.setRange(1-N,1-j)}}u.compose=function(p,j){Zo(Yo,"Axis.Scrollbar")&&(t=j,Kr(p,"afterGetOffset",i),Kr(p,"afterInit",o),Kr(p,"afterRender",l))}})(le||(le={}));let Ko=le,Jr={height:10,barBorderRadius:5,buttonBorderRadius:0,buttonsEnabled:!1,liveRedraw:void 0,margin:void 0,minWidth:6,opposite:!0,step:.2,zIndex:3,barBackgroundColor:"#cccccc",barBorderWidth:0,barBorderColor:"#cccccc",buttonArrowColor:"#333333",buttonBackgroundColor:"#e6e6e6",buttonBorderColor:"#cccccc",buttonBorderWidth:1,rifleColor:"none",trackBackgroundColor:"rgba(255, 255, 255, 0.001)",trackBorderColor:"#cccccc",trackBorderRadius:5,trackBorderWidth:1},{defaultOptions:Ta}=S(),{composed:Jo}=S(),{addEvent:Qo,correctFloat:Pt,crisp:Qr,defined:Da,destroyObjectProperties:el,extend:tl,fireEvent:Ar,merge:Oa,pick:Er,pushUnique:rl,removeEvent:sl}=S();class Gt{static compose(t){Ko.compose(t,Gt),rl(Jo,"Scrollbar")&&tl(Ta,{scrollbar:Jr})}static swapXY(t,a){return a&&t.forEach(i=>{let o,l=i.length;for(let p=0;p<l;p+=2)typeof(o=i[p+1])=="number"&&(i[p+1]=i[p+2],i[p+2]=o)}),t}constructor(t,a,i){this._events=[],this.chartX=0,this.chartY=0,this.from=0,this.scrollbarButtons=[],this.scrollbarLeft=0,this.scrollbarStrokeWidth=1,this.scrollbarTop=0,this.size=0,this.to=0,this.trackBorderWidth=1,this.x=0,this.y=0,this.init(t,a,i)}addEvents(){let t=this.options.inverted?[1,0]:[0,1],a=this.scrollbarButtons,i=this.scrollbarGroup.element,o=this.track.element,l=this.mouseDownHandler.bind(this),p=this.mouseMoveHandler.bind(this),j=this.mouseUpHandler.bind(this),N=[[a[t[0]].element,"click",this.buttonToMinClick.bind(this)],[a[t[1]].element,"click",this.buttonToMaxClick.bind(this)],[o,"click",this.trackClick.bind(this)],[i,"mousedown",l],[i.ownerDocument,"mousemove",p],[i.ownerDocument,"mouseup",j],[i,"touchstart",l],[i.ownerDocument,"touchmove",p],[i.ownerDocument,"touchend",j]];N.forEach(function(k){Qo.apply(null,k)}),this._events=N}buttonToMaxClick(t){let a=(this.to-this.from)*Er(this.options.step,.2);this.updatePosition(this.from+a,this.to+a),Ar(this,"changed",{from:this.from,to:this.to,trigger:"scrollbar",DOMEvent:t})}buttonToMinClick(t){let a=Pt(this.to-this.from)*Er(this.options.step,.2);this.updatePosition(Pt(this.from-a),Pt(this.to-a)),Ar(this,"changed",{from:this.from,to:this.to,trigger:"scrollbar",DOMEvent:t})}cursorToScrollbarPosition(t){let a=this.options,i=a.minWidth>this.calculatedWidth?a.minWidth:0;return{chartX:(t.chartX-this.x-this.xOffset)/(this.barWidth-i),chartY:(t.chartY-this.y-this.yOffset)/(this.barWidth-i)}}destroy(){let t=this,a=t.chart.scroller;t.removeEvents(),["track","scrollbarRifles","scrollbar","scrollbarGroup","group"].forEach(function(i){t[i]&&t[i].destroy&&(t[i]=t[i].destroy())}),a&&t===a.scrollbar&&(a.scrollbar=null,el(a.scrollbarButtons))}drawScrollbarButton(t){let a=this.renderer,i=this.scrollbarButtons,o=this.options,l=this.size,p=a.g().add(this.group);if(i.push(p),o.buttonsEnabled){let j=a.rect().addClass("highcharts-scrollbar-button").add(p);this.chart.styledMode||j.attr({stroke:o.buttonBorderColor,"stroke-width":o.buttonBorderWidth,fill:o.buttonBackgroundColor}),j.attr(j.crisp({x:-.5,y:-.5,width:l,height:l,r:o.buttonBorderRadius},j.strokeWidth()));let N=a.path(Gt.swapXY([["M",l/2+(t?-1:1),l/2-3],["L",l/2+(t?-1:1),l/2+3],["L",l/2+(t?2:-2),l/2]],o.vertical)).addClass("highcharts-scrollbar-arrow").add(i[t]);this.chart.styledMode||N.attr({fill:o.buttonArrowColor})}}init(t,a,i){this.scrollbarButtons=[],this.renderer=t,this.userOptions=a,this.options=Oa(Jr,Ta.scrollbar,a),this.options.margin=Er(this.options.margin,10),this.chart=i,this.size=Er(this.options.size,this.options.height),a.enabled&&(this.render(),this.addEvents())}mouseDownHandler(t){var o;let a=((o=this.chart.pointer)==null?void 0:o.normalize(t))||t,i=this.cursorToScrollbarPosition(a);this.chartX=i.chartX,this.chartY=i.chartY,this.initPositions=[this.from,this.to],this.grabbedCenter=!0}mouseMoveHandler(t){var p;let a,i=((p=this.chart.pointer)==null?void 0:p.normalize(t))||t,o=this.options.vertical?"chartY":"chartX",l=this.initPositions||[];this.grabbedCenter&&(!t.touches||t.touches[0][o]!==0)&&(a=this.cursorToScrollbarPosition(i)[o]-this[o],this.hasDragged=!0,this.updatePosition(l[0]+a,l[1]+a),this.hasDragged&&Ar(this,"changed",{from:this.from,to:this.to,trigger:"scrollbar",DOMType:t.type,DOMEvent:t}))}mouseUpHandler(t){this.hasDragged&&Ar(this,"changed",{from:this.from,to:this.to,trigger:"scrollbar",DOMType:t.type,DOMEvent:t}),this.grabbedCenter=this.hasDragged=this.chartX=this.chartY=null}position(t,a,i,o){let{buttonsEnabled:l,margin:p=0,vertical:j}=this.options,N=this.rendered?"animate":"attr",k=o,f=0;this.group.show(),this.x=t,this.y=a+this.trackBorderWidth,this.width=i,this.height=o,this.xOffset=k,this.yOffset=f,j?(this.width=this.yOffset=i=f=this.size,this.xOffset=k=0,this.yOffset=f=l?this.size:0,this.barWidth=o-(l?2*i:0),this.x=t+=p):(this.height=o=this.size,this.xOffset=k=l?this.size:0,this.barWidth=i-(l?2*o:0),this.y=this.y+p),this.group[N]({translateX:t,translateY:this.y}),this.track[N]({width:i,height:o}),this.scrollbarButtons[1][N]({translateX:j?0:i-k,translateY:j?o-f:0})}removeEvents(){this._events.forEach(function(t){sl.apply(null,t)}),this._events.length=0}render(){let t=this.renderer,a=this.options,i=this.size,o=this.chart.styledMode,l=t.g("scrollbar").attr({zIndex:a.zIndex}).hide().add();this.group=l,this.track=t.rect().addClass("highcharts-scrollbar-track").attr({r:a.trackBorderRadius||0,height:i,width:i}).add(l),o||this.track.attr({fill:a.trackBackgroundColor,stroke:a.trackBorderColor,"stroke-width":a.trackBorderWidth});let p=this.trackBorderWidth=this.track.strokeWidth();this.track.attr({x:-Qr(0,p),y:-Qr(0,p)}),this.scrollbarGroup=t.g().add(l),this.scrollbar=t.rect().addClass("highcharts-scrollbar-thumb").attr({height:i-p,width:i-p,r:a.barBorderRadius||0}).add(this.scrollbarGroup),this.scrollbarRifles=t.path(Gt.swapXY([["M",-3,i/4],["L",-3,2*i/3],["M",0,i/4],["L",0,2*i/3],["M",3,i/4],["L",3,2*i/3]],a.vertical)).addClass("highcharts-scrollbar-rifles").add(this.scrollbarGroup),o||(this.scrollbar.attr({fill:a.barBackgroundColor,stroke:a.barBorderColor,"stroke-width":a.barBorderWidth}),this.scrollbarRifles.attr({stroke:a.rifleColor,"stroke-width":1})),this.scrollbarStrokeWidth=this.scrollbar.strokeWidth(),this.scrollbarGroup.translate(-Qr(0,this.scrollbarStrokeWidth),-Qr(0,this.scrollbarStrokeWidth)),this.drawScrollbarButton(0),this.drawScrollbarButton(1)}setRange(t,a){let i,o,l=this.options,p=l.vertical,j=l.minWidth,N=this.barWidth,k=!this.rendered||this.hasDragged||this.chart.navigator&&this.chart.navigator.hasDragged?"attr":"animate";if(!Da(N))return;let f=N*Math.min(a,1);i=Math.ceil(N*(t=Math.max(t,0))),this.calculatedWidth=o=Pt(f-i),o<j&&(i=(N-j+o)*t,o=j);let v=Math.floor(i+this.xOffset+this.yOffset),d=o/2-.5;this.from=t,this.to=a,p?(this.scrollbarGroup[k]({translateY:v}),this.scrollbar[k]({height:o}),this.scrollbarRifles[k]({translateY:d}),this.scrollbarTop=v,this.scrollbarLeft=0):(this.scrollbarGroup[k]({translateX:v}),this.scrollbar[k]({width:o}),this.scrollbarRifles[k]({translateX:d}),this.scrollbarLeft=v,this.scrollbarTop=0),o<=12?this.scrollbarRifles.hide():this.scrollbarRifles.show(),l.showFull===!1&&(t<=0&&a>=1?this.group.hide():this.group.show()),this.rendered=!0}shouldUpdateExtremes(t){return Er(this.options.liveRedraw,S().svg&&!S().isTouchDevice&&!this.chart.boosted)||t==="mouseup"||t==="touchend"||!Da(t)}trackClick(t){var p;let a=((p=this.chart.pointer)==null?void 0:p.normalize(t))||t,i=this.to-this.from,o=this.y+this.scrollbarTop,l=this.x+this.scrollbarLeft;this.options.vertical&&a.chartY>o||!this.options.vertical&&a.chartX>l?this.updatePosition(this.from+i,this.to+i):this.updatePosition(this.from-i,this.to-i),Ar(this,"changed",{from:this.from,to:this.to,trigger:"scrollbar",DOMEvent:t})}update(t){this.destroy(),this.init(this.chart.renderer,Oa(!0,this.options,t),this.chart)}updatePosition(t,a){a>1&&(t=Pt(1-Pt(a-t)),a=1),t<0&&(a=Pt(a-t),t=0),this.from=t,this.to=a}}Gt.defaultOptions=Jr;var al=ne(540),il=ne.n(al);let{defaultOptions:Rs}=S(),{isTouchDevice:nl}=S(),{prototype:{symbols:za}}=il(),{addEvent:qe,clamp:Ia,correctFloat:es,defined:ar,destroyObjectProperties:ol,erase:ir,extend:ll,find:dl,fireEvent:Ts,isArray:La,isNumber:xt,merge:nr,pick:ct,removeEvent:ts,splat:Ba}=S();function rs(u,...t){let a=[].filter.call(t,xt);if(a.length)return Math[u].apply(0,a)}class ss{static compose(t,a,i){Co.compose(t,ss),Xo.compose(t,a,i)}constructor(t){this.isDirty=!1,this.scrollbarHeight=0,this.init(t)}drawHandle(t,a,i,o){let l=this.navigatorOptions.handles.height;this.handles[a][o](i?{translateX:Math.round(this.left+this.height/2),translateY:Math.round(this.top+parseInt(t,10)+.5-l)}:{translateX:Math.round(this.left+parseInt(t,10)),translateY:Math.round(this.top+this.height/2-l/2-1)})}drawOutline(t,a,i,o){let l=this.navigatorOptions.maskInside,p=this.outline.strokeWidth(),j=p/2,N=p%2/2,k=this.scrollButtonSize,f=this.size,v=this.top,d=this.height,g=v-j,m=v+d,_=this.left,C,O;i?(C=v+a+N,a=v+t+N,O=[["M",_+d,v-k-N],["L",_+d,C],["L",_,C],["M",_,a],["L",_+d,a],["L",_+d,v+f+k]],l&&O.push(["M",_+d,C-j],["L",_+d,a+j])):(_-=k,t+=_+k-N,a+=_+k-N,O=[["M",_,g],["L",t,g],["L",t,m],["M",a,m],["L",a,g],["L",_+f+2*k,g]],l&&O.push(["M",t-j,g],["L",a+j,g])),this.outline[o]({d:O})}drawMasks(t,a,i,o){let l,p,j,N,k=this.left,f=this.top,v=this.height;i?(j=[k,k,k],N=[f,f+t,f+a],p=[v,v,v],l=[t,a-t,this.size-a]):(j=[k,k+t,k+a],N=[f,f,f],p=[t,a-t,this.size-a],l=[v,v,v]),this.shades.forEach((d,g)=>{d[o]({x:j[g],y:N[g],width:p[g],height:l[g]})})}renderElements(){var k;let t=this,a=t.navigatorOptions,i=a.maskInside,o=t.chart,l=o.inverted,p=o.renderer,j={cursor:l?"ns-resize":"ew-resize"},N=t.navigatorGroup??(t.navigatorGroup=p.g("navigator").attr({zIndex:8,visibility:"hidden"}).add());if([!i,i,!i].forEach((f,v)=>{let d=t.shades[v]??(t.shades[v]=p.rect().addClass("highcharts-navigator-mask"+(v===1?"-inside":"-outside")).add(N));o.styledMode||(d.attr({fill:f?a.maskFill:"rgba(0,0,0,0)"}),v===1&&d.css(j))}),t.outline||(t.outline=p.path().addClass("highcharts-navigator-outline").add(N)),o.styledMode||t.outline.attr({"stroke-width":a.outlineWidth,stroke:a.outlineColor}),(k=a.handles)==null?void 0:k.enabled){let f=a.handles,{height:v,width:d}=f;[0,1].forEach(g=>{var _;let m=f.symbols[g];if(t.handles[g]&&t.handles[g].symbolUrl===m){if(!t.handles[g].isImg&&t.handles[g].symbolName!==m){let C=za[m].call(za,-d/2-1,0,d,v);t.handles[g].attr({d:C}),t.handles[g].symbolName=m}}else(_=t.handles[g])==null||_.destroy(),t.handles[g]=p.symbol(m,-d/2-1,0,d,v,f),t.handles[g].attr({zIndex:7-g}).addClass("highcharts-navigator-handle highcharts-navigator-handle-"+["left","right"][g]).add(N),t.addMouseEvents();o.inverted&&t.handles[g].attr({rotation:90,rotationOriginX:Math.floor(-d/2),rotationOriginY:(v+d)/2}),o.styledMode||t.handles[g].attr({fill:f.backgroundColor,stroke:f.borderColor,"stroke-width":f.lineWidth,width:f.width,height:f.height,x:-d/2-1,y:0}).css(j)})}}update(t,a=!1){var l;let i=this.chart,o=i.options.chart.inverted!==((l=i.scrollbar)==null?void 0:l.options.vertical);if(nr(!0,i.options.navigator,t),this.navigatorOptions=i.options.navigator||{},this.setOpposite(),ar(t.enabled)||o)return this.destroy(),this.navigatorEnabled=t.enabled||this.navigatorEnabled,this.init(i);if(this.navigatorEnabled&&(this.isDirty=!0,t.adaptToUpdatedData===!1&&this.baseSeries.forEach(p=>{ts(p,"updatedData",this.updatedDataHandler)},this),t.adaptToUpdatedData&&this.baseSeries.forEach(p=>{p.eventsToUnbind.push(qe(p,"updatedData",this.updatedDataHandler))},this),(t.series||t.baseSeries)&&this.setBaseSeries(void 0,!1),t.height||t.xAxis||t.yAxis)){this.height=t.height??this.height;let p=this.getXAxisOffsets();this.xAxis.update({...t.xAxis,offsets:p,[i.inverted?"width":"height"]:this.height,[i.inverted?"height":"width"]:void 0},!1),this.yAxis.update({...t.yAxis,[i.inverted?"width":"height"]:this.height},!1)}a&&i.redraw()}render(t,a,i,o){let l=this.chart,p=this.xAxis,j=p.pointRange||0,N=p.navigatorAxis.fake?l.xAxis[0]:p,k=this.navigatorEnabled,f=this.rendered,v=l.inverted,d=l.xAxis[0].minRange,g=l.xAxis[0].options.maxRange,m=this.scrollButtonSize,_,C,O,I=this.scrollbarHeight,re,V;if(this.hasDragged&&!ar(i))return;if(this.isDirty&&this.renderElements(),t=es(t-j/2),a=es(a+j/2),!xt(t)||!xt(a))if(f)i=0,o=ct(p.width,N.width);else return;this.left=ct(p.left,l.plotLeft+m+(v?l.plotWidth:0));let Z=this.size=re=ct(p.len,(v?l.plotHeight:l.plotWidth)-2*m);_=v?I:re+2*m,i=ct(i,p.toPixels(t,!0)),o=ct(o,p.toPixels(a,!0)),xt(i)&&Math.abs(i)!==1/0||(i=0,o=_);let Q=p.toValue(i,!0),ee=p.toValue(o,!0),ie=Math.abs(es(ee-Q));ie<d?this.grabbedLeft?i=p.toPixels(ee-d-j,!0):this.grabbedRight&&(o=p.toPixels(Q+d+j,!0)):ar(g)&&es(ie-j)>g&&(this.grabbedLeft?i=p.toPixels(ee-g-j,!0):this.grabbedRight&&(o=p.toPixels(Q+g+j,!0))),this.zoomedMax=Ia(Math.max(i,o),0,Z),this.zoomedMin=Ia(this.fixedWidth?this.zoomedMax-this.fixedWidth:Math.min(i,o),0,Z),this.range=this.zoomedMax-this.zoomedMin,Z=Math.round(this.zoomedMax);let te=Math.round(this.zoomedMin);k&&(this.navigatorGroup.attr({visibility:"inherit"}),V=f&&!this.hasDragged?"animate":"attr",this.drawMasks(te,Z,v,V),this.drawOutline(te,Z,v,V),this.navigatorOptions.handles.enabled&&(this.drawHandle(te,0,v,V),this.drawHandle(Z,1,v,V))),this.scrollbar&&(v?(O=this.top-m,C=this.left-I+(k||!N.opposite?0:(N.titleOffset||0)+N.axisTitleMargin),I=re+2*m):(O=this.top+(k?this.height:-I),C=this.left-m),this.scrollbar.position(C,O,_,I),this.scrollbar.setRange(this.zoomedMin/(re||1),this.zoomedMax/(re||1))),this.rendered=!0,this.isDirty=!1,Ts(this,"afterRender")}addMouseEvents(){let t=this,a=t.chart,i=a.container,o=[],l,p;t.mouseMoveHandler=l=function(j){t.onMouseMove(j)},t.mouseUpHandler=p=function(j){t.onMouseUp(j)},(o=t.getPartsEvents("mousedown")).push(qe(a.renderTo,"mousemove",l),qe(i.ownerDocument,"mouseup",p),qe(a.renderTo,"touchmove",l),qe(i.ownerDocument,"touchend",p)),o.concat(t.getPartsEvents("touchstart")),t.eventsToUnbind=o,t.series&&t.series[0]&&o.push(qe(t.series[0].xAxis,"foundExtremes",function(){a.navigator.modifyNavigatorAxisExtremes()}))}getPartsEvents(t){let a=this,i=[];return["shades","handles"].forEach(function(o){a[o].forEach(function(l,p){i.push(qe(l.element,t,function(j){a[o+"Mousedown"](j,p)}))})}),i}shadesMousedown(t,a){var m;t=((m=this.chart.pointer)==null?void 0:m.normalize(t))||t;let i=this.chart,o=this.xAxis,l=this.zoomedMin,p=this.size,j=this.range,N=this.left,k=t.chartX,f,v,d,g;i.inverted&&(k=t.chartY,N=this.top),a===1?(this.grabbedCenter=k,this.fixedWidth=j,this.dragOffset=k-l):(g=k-N-j/2,a===0?g=Math.max(0,g):a===2&&g+j>=p&&(g=p-j,this.reversedExtremes?(g-=j,v=this.getUnionExtremes().dataMin):f=this.getUnionExtremes().dataMax),g!==l&&(this.fixedWidth=j,ar((d=o.navigatorAxis.toFixedRange(g,g+j,v,f)).min)&&Ts(this,"setRange",{min:Math.min(d.min,d.max),max:Math.max(d.min,d.max),redraw:!0,eventArguments:{trigger:"navigator"}})))}handlesMousedown(t,a){var p;t=((p=this.chart.pointer)==null?void 0:p.normalize(t))||t;let i=this.chart,o=i.xAxis[0],l=this.reversedExtremes;a===0?(this.grabbedLeft=!0,this.otherHandlePos=this.zoomedMax,this.fixedExtreme=l?o.min:o.max):(this.grabbedRight=!0,this.otherHandlePos=this.zoomedMin,this.fixedExtreme=l?o.max:o.min),i.setFixedRange(void 0)}onMouseMove(t){var f;let a=this,i=a.chart,o=a.navigatorSize,l=a.range,p=a.dragOffset,j=i.inverted,N=a.left,k;(!t.touches||t.touches[0].pageX!==0)&&(k=(t=((f=i.pointer)==null?void 0:f.normalize(t))||t).chartX,j&&(N=a.top,k=t.chartY),a.grabbedLeft?(a.hasDragged=!0,a.render(0,0,k-N,a.otherHandlePos)):a.grabbedRight?(a.hasDragged=!0,a.render(0,0,a.otherHandlePos,k-N)):a.grabbedCenter&&(a.hasDragged=!0,k<p?k=p:k>o+p-l&&(k=o+p-l),a.render(0,0,k-p,k-p+l)),a.hasDragged&&a.scrollbar&&ct(a.scrollbar.options.liveRedraw,!nl&&!this.chart.boosted)&&(t.DOMType=t.type,setTimeout(function(){a.onMouseUp(t)},0)))}onMouseUp(t){let a,i,o,l,p,j,N=this.chart,k=this.xAxis,f=this.scrollbar,v=t.DOMEvent||t,d=N.inverted,g=this.rendered&&!this.hasDragged?"animate":"attr";(this.hasDragged&&(!f||!f.hasDragged)||t.trigger==="scrollbar")&&(o=this.getUnionExtremes(),this.zoomedMin===this.otherHandlePos?l=this.fixedExtreme:this.zoomedMax===this.otherHandlePos&&(p=this.fixedExtreme),this.zoomedMax===this.size&&(p=this.reversedExtremes?o.dataMin:o.dataMax),this.zoomedMin===0&&(l=this.reversedExtremes?o.dataMax:o.dataMin),ar((j=k.navigatorAxis.toFixedRange(this.zoomedMin,this.zoomedMax,l,p)).min)&&Ts(this,"setRange",{min:Math.min(j.min,j.max),max:Math.max(j.min,j.max),redraw:!0,animation:!this.hasDragged&&null,eventArguments:{trigger:"navigator",triggerOp:"navigator-drag",DOMEvent:v}})),t.DOMType!=="mousemove"&&t.DOMType!=="touchmove"&&(this.grabbedLeft=this.grabbedRight=this.grabbedCenter=this.fixedWidth=this.fixedExtreme=this.otherHandlePos=this.hasDragged=this.dragOffset=null),this.navigatorEnabled&&xt(this.zoomedMin)&&xt(this.zoomedMax)&&(i=Math.round(this.zoomedMin),a=Math.round(this.zoomedMax),this.shades&&this.drawMasks(i,a,d,g),this.outline&&this.drawOutline(i,a,d,g),this.navigatorOptions.handles.enabled&&Object.keys(this.handles).length===this.handles.length&&(this.drawHandle(i,0,d,g),this.drawHandle(a,1,d,g)))}removeEvents(){this.eventsToUnbind&&(this.eventsToUnbind.forEach(function(t){t()}),this.eventsToUnbind=void 0),this.removeBaseSeriesEvents()}removeBaseSeriesEvents(){let t=this.baseSeries||[];this.navigatorEnabled&&t[0]&&(this.navigatorOptions.adaptToUpdatedData!==!1&&t.forEach(function(a){ts(a,"updatedData",this.updatedDataHandler)},this),t[0].xAxis&&ts(t[0].xAxis,"foundExtremes",this.modifyBaseAxisExtremes))}getXAxisOffsets(){return this.chart.inverted?[this.scrollButtonSize,0,-this.scrollButtonSize,0]:[0,-this.scrollButtonSize,0,this.scrollButtonSize]}init(t){var _,C;let a=t.options,i=a.navigator||{},o=i.enabled,l=a.scrollbar||{},p=l.enabled,j=o&&i.height||0,N=p&&l.height||0,k=l.buttonsEnabled&&N||0;this.handles=[],this.shades=[],this.chart=t,this.setBaseSeries(),this.height=j,this.scrollbarHeight=N,this.scrollButtonSize=k,this.scrollbarEnabled=p,this.navigatorEnabled=o,this.navigatorOptions=i,this.scrollbarOptions=l,this.setOpposite();let f=this,v=f.baseSeries,d=t.xAxis.length,g=t.yAxis.length,m=v&&v[0]&&v[0].xAxis||t.xAxis[0]||{options:{}};if(t.isDirtyBox=!0,f.navigatorEnabled){let O=this.getXAxisOffsets();f.xAxis=new(Je())(t,nr({breaks:m.options.breaks,ordinal:m.options.ordinal,overscroll:m.options.overscroll},i.xAxis,{type:"datetime",yAxis:(_=i.yAxis)==null?void 0:_.id,index:d,isInternal:!0,offset:0,keepOrdinalPadding:!0,startOnTick:!1,endOnTick:!1,minPadding:m.options.ordinal?0:m.options.minPadding,maxPadding:m.options.ordinal?0:m.options.maxPadding,zoomEnabled:!1},t.inverted?{offsets:O,width:j}:{offsets:O,height:j}),"xAxis"),f.yAxis=new(Je())(t,nr(i.yAxis,{alignTicks:!1,offset:0,index:g,isInternal:!0,reversed:ct(i.yAxis&&i.yAxis.reversed,t.yAxis[0]&&t.yAxis[0].reversed,!1),zoomEnabled:!1},t.inverted?{width:j}:{height:j}),"yAxis"),v||i.series.data?f.updateNavigatorSeries(!1):t.series.length===0&&(f.unbindRedraw=qe(t,"beforeRedraw",function(){t.series.length>0&&!f.series&&(f.setBaseSeries(),f.unbindRedraw())})),f.reversedExtremes=t.inverted&&!f.xAxis.reversed||!t.inverted&&f.xAxis.reversed,f.renderElements(),f.addMouseEvents()}else f.xAxis={chart:t,navigatorAxis:{fake:!0},translate:function(O,I){let re=t.xAxis[0],V=re.getExtremes(),Z=re.len-2*k,Q=rs("min",re.options.min,V.dataMin),ee=rs("max",re.options.max,V.dataMax)-Q;return I?O*ee/Z+Q:Z*(O-Q)/ee},toPixels:function(O){return this.translate(O)},toValue:function(O){return this.translate(O,!0)}},f.xAxis.navigatorAxis.axis=f.xAxis,f.xAxis.navigatorAxis.toFixedRange=As.prototype.toFixedRange.bind(f.xAxis.navigatorAxis);if((C=t.options.scrollbar)!=null&&C.enabled){let O=nr(t.options.scrollbar,{vertical:t.inverted});xt(O.margin)||(O.margin=t.inverted?-3:3),t.scrollbar=f.scrollbar=new Gt(t.renderer,O,t),qe(f.scrollbar,"changed",function(I){let re=f.size,V=re*this.to,Z=re*this.from;f.hasDragged=f.scrollbar.hasDragged,f.render(0,0,Z,V),this.shouldUpdateExtremes(I.DOMType)&&setTimeout(function(){f.onMouseUp(I)})})}f.addBaseSeriesEvents(),f.addChartEvents()}setOpposite(){let t=this.navigatorOptions,a=this.navigatorEnabled,i=this.chart;this.opposite=ct(t.opposite,!!(!a&&i.inverted))}getUnionExtremes(t){let a,i=this.chart.xAxis[0],o=this.chart.time,l=this.xAxis,p=l.options,j=i.options;return t&&i.dataMin===null||(a={dataMin:ct(o.parse(p==null?void 0:p.min),rs("min",o.parse(j.min),i.dataMin,l.dataMin,l.min)),dataMax:ct(o.parse(p==null?void 0:p.max),rs("max",o.parse(j.max),i.dataMax,l.dataMax,l.max))}),a}setBaseSeries(t,a){let i=this.chart,o=this.baseSeries=[];t=t||i.options&&i.options.navigator.baseSeries||(i.series.length?dl(i.series,l=>!l.options.isInternal).index:0),(i.series||[]).forEach((l,p)=>{!l.options.isInternal&&(l.options.showInNavigator||(p===t||l.options.id===t)&&l.options.showInNavigator!==!1)&&o.push(l)}),this.xAxis&&!this.xAxis.navigatorAxis.fake&&this.updateNavigatorSeries(!0,a)}updateNavigatorSeries(t,a){var d,g;let i=this,o=i.chart,l=i.baseSeries,p={enableMouseTracking:!1,index:null,linkedTo:null,group:"nav",padXAxis:!1,xAxis:(d=this.navigatorOptions.xAxis)==null?void 0:d.id,yAxis:(g=this.navigatorOptions.yAxis)==null?void 0:g.id,showInLegend:!1,stacking:void 0,isInternal:!0,states:{inactive:{opacity:1}}},j=i.series=(i.series||[]).filter(m=>{let _=m.baseSeries;return!(0>l.indexOf(_))||(_&&(ts(_,"updatedData",i.updatedDataHandler),delete _.navigatorSeries),m.chart&&m.destroy(),!1)}),N,k,f=i.navigatorOptions.series,v;l&&l.length&&l.forEach(m=>{var I;let _=m.navigatorSeries,C=ll({color:m.color,visible:m.visible},La(f)?Rs.navigator.series:f);if(_&&i.navigatorOptions.adaptToUpdatedData===!1)return;p.name="Navigator "+l.length,v=(N=m.options||{}).navigatorOptions||{},C.dataLabels=Ba(C.dataLabels),(k=nr(N,p,C,v)).pointRange=ct(C.pointRange,v.pointRange,Rs.plotOptions[k.type||"line"].pointRange);let O=v.data||C.data;i.hasNavigatorData=i.hasNavigatorData||!!O,k.data=O||((I=N.data)==null?void 0:I.slice(0)),_&&_.options?_.update(k,a):(m.navigatorSeries=o.initSeries(k),o.setSortedData(),m.navigatorSeries.baseSeries=m,j.push(m.navigatorSeries))}),(f.data&&!(l&&l.length)||La(f))&&(i.hasNavigatorData=!1,(f=Ba(f)).forEach((m,_)=>{p.name="Navigator "+(j.length+1),(k=nr(Rs.navigator.series,{color:o.series[_]&&!o.series[_].options.isInternal&&o.series[_].color||o.options.colors[_]||o.options.colors[0]},p,m)).data=m.data,k.data&&(i.hasNavigatorData=!0,j.push(o.initSeries(k)))})),t&&this.addBaseSeriesEvents()}addBaseSeriesEvents(){let t=this,a=t.baseSeries||[];a[0]&&a[0].xAxis&&a[0].eventsToUnbind.push(qe(a[0].xAxis,"foundExtremes",this.modifyBaseAxisExtremes)),a.forEach(i=>{i.eventsToUnbind.push(qe(i,"show",function(){this.navigatorSeries&&this.navigatorSeries.setVisible(!0,!1)})),i.eventsToUnbind.push(qe(i,"hide",function(){this.navigatorSeries&&this.navigatorSeries.setVisible(!1,!1)})),this.navigatorOptions.adaptToUpdatedData!==!1&&i.xAxis&&i.eventsToUnbind.push(qe(i,"updatedData",this.updatedDataHandler)),i.eventsToUnbind.push(qe(i,"remove",function(){a&&ir(a,i),this.navigatorSeries&&t.series&&(ir(t.series,this.navigatorSeries),ar(this.navigatorSeries.options)&&this.navigatorSeries.remove(!1),delete this.navigatorSeries)}))})}getBaseSeriesMin(t){return this.baseSeries.reduce(function(a,i){return Math.min(a,i.getColumn("x")[0]??a)},t)}modifyNavigatorAxisExtremes(){let t=this.xAxis;if(t.getExtremes!==void 0){let a=this.getUnionExtremes(!0);a&&(a.dataMin!==t.min||a.dataMax!==t.max)&&(t.min=a.dataMin,t.max=a.dataMax)}}modifyBaseAxisExtremes(){var _;let t,a,i=this.chart.navigator,o=this.getExtremes(),l=o.min,p=o.max,j=o.dataMin,N=o.dataMax,k=p-l,f=i.stickToMin,v=i.stickToMax,d=ct((_=this.ordinal)==null?void 0:_.convertOverscroll(this.options.overscroll),0),g=i.series&&i.series[0],m=!!this.setExtremes;!(this.eventArgs&&this.eventArgs.trigger==="rangeSelectorButton")&&(f&&(t=(a=j)+k),v&&(t=N+d,f||(a=Math.max(j,t-k,i.getBaseSeriesMin(g&&g.xData?g.xData[0]:-Number.MAX_VALUE)))),m&&(f||v)&&xt(a)&&(this.min=this.userMin=a,this.max=this.userMax=t)),i.stickToMin=i.stickToMax=null}updatedDataHandler(){let t=this.chart.navigator,a=this.navigatorSeries,i=t.reversedExtremes?Math.round(t.zoomedMin)===0:Math.round(t.zoomedMax)>=Math.round(t.size);t.stickToMax=ct(this.chart.options.navigator&&this.chart.options.navigator.stickToMax,i),t.stickToMin=t.shouldStickToMin(this,t),a&&!t.hasNavigatorData&&(a.options.pointStart=this.getColumn("x")[0],a.setData(this.options.data,!1,null,!1))}shouldStickToMin(t,a){let i=a.getBaseSeriesMin(t.getColumn("x")[0]),o=t.xAxis,l=o.max,p=o.min,j=o.options.range;return!!(xt(l)&&xt(p))&&(j&&l-i>0?l-i<j:p<=i)}addChartEvents(){this.eventsToUnbind||(this.eventsToUnbind=[]),this.eventsToUnbind.push(qe(this.chart,"redraw",function(){let t=this.navigator,a=t&&(t.baseSeries&&t.baseSeries[0]&&t.baseSeries[0].xAxis||this.xAxis[0]);a&&t.render(a.min,a.max)}),qe(this.chart,"getMargins",function(){var i;let t=this.navigator,a=t.opposite?"plotTop":"marginBottom";this.inverted&&(a=t.opposite?"marginRight":"plotLeft"),this[a]=(this[a]||0)+(t.navigatorEnabled||!this.inverted?t.height+(((i=this.scrollbar)==null?void 0:i.options.margin)||0)+t.scrollbarHeight:0)+(t.navigatorOptions.margin||0)}),qe(ss,"setRange",function(t){this.chart.xAxis[0].setExtremes(t.min,t.max,t.redraw,t.animation,t.eventArguments)}))}destroy(){this.removeEvents(),this.xAxis&&(ir(this.chart.xAxis,this.xAxis),ir(this.chart.axes,this.xAxis)),this.yAxis&&(ir(this.chart.yAxis,this.yAxis),ir(this.chart.axes,this.yAxis)),(this.series||[]).forEach(t=>{t.destroy&&t.destroy()}),["series","xAxis","yAxis","shades","outline","scrollbarTrack","scrollbarRifles","scrollbarGroup","scrollbar","navigatorGroup","rendered"].forEach(t=>{this[t]&&this[t].destroy&&this[t].destroy(),this[t]=null}),[this.handles].forEach(t=>{ol(t)}),this.baseSeries.forEach(t=>{t.navigatorSeries=void 0}),this.navigatorEnabled=!1}}(function(u){u.setLength=function(t,a,i){return Array.isArray(t)?(t.length=a,t):t[i?"subarray":"slice"](0,a)},u.splice=function(t,a,i,o,l=[]){if(Array.isArray(t))return Array.isArray(l)||(l=Array.from(l)),{removed:t.splice(a,i,...l),array:t};let p=Object.getPrototypeOf(t).constructor,j=t[o?"subarray":"slice"](a,a+i),N=new p(t.length-i+l.length);return N.set(t.subarray(0,a),0),N.set(l,a),N.set(t.subarray(a+i),a+l.length),{removed:j,array:N}}})(he||(he={}));let{setLength:cl,splice:Fa}=he,{fireEvent:Ds,objectEach:Rr,uniqueKey:Tr}=S(),$a=class{constructor(u={}){this.autoId=!u.id,this.columns={},this.id=u.id||Tr(),this.modified=this,this.rowCount=0,this.versionTag=Tr();let t=0;Rr(u.columns||{},(a,i)=>{this.columns[i]=a.slice(),t=Math.max(t,a.length)}),this.applyRowCount(t)}applyRowCount(u){this.rowCount=u,Rr(this.columns,(t,a)=>{t.length!==u&&(this.columns[a]=cl(t,u))})}deleteRows(u,t=1){if(t>0&&u<this.rowCount){let a=0;Rr(this.columns,(i,o)=>{this.columns[o]=Fa(i,u,t).array,a=i.length}),this.rowCount=a}Ds(this,"afterDeleteRows",{rowIndex:u,rowCount:t}),this.versionTag=Tr()}getColumn(u,t){return this.columns[u]}getColumns(u,t){return(u||Object.keys(this.columns)).reduce((a,i)=>(a[i]=this.columns[i],a),{})}getRow(u,t){return(t||Object.keys(this.columns)).map(a=>{var i;return(i=this.columns[a])==null?void 0:i[u]})}setColumn(u,t=[],a=0,i){this.setColumns({[u]:t},a,i)}setColumns(u,t,a){let i=this.rowCount;Rr(u,(o,l)=>{this.columns[l]=o.slice(),i=o.length}),this.applyRowCount(i),a!=null&&a.silent||(Ds(this,"afterSetColumns"),this.versionTag=Tr())}setRow(u,t=this.rowCount,a,i){let{columns:o}=this,l=a?this.rowCount+1:t+1;Rr(u,(p,j)=>{let N=o[j]||(i==null?void 0:i.addColumns)!==!1&&Array(l);N&&(a?N=Fa(N,t,0,!0,[p]).array:N[t]=p,o[j]=N)}),l>this.rowCount&&this.applyRowCount(l),i!=null&&i.silent||(Ds(this,"afterSetRows"),this.versionTag=Tr())}},{addEvent:Ut,correctFloat:as,css:hl,defined:bt,error:ul,isNumber:Os,pick:zs,timeUnits:pl,isString:ml}=S();(function(u){function t(d,g,m,_,C=[],O=0,I){let re={},V=this.options.tickPixelInterval,Z=this.chart.time,Q=[],ee,ie,te,de,J,pe=0,ue=[],Oe=-Number.MAX_VALUE;if(!this.options.ordinal&&!this.options.breaks||!C||C.length<3||g===void 0)return Z.getTimeTicks.apply(Z,arguments);let be=C.length;for(ee=0;ee<be;ee++){if(J=ee&&C[ee-1]>m,C[ee]<g&&(pe=ee),ee===be-1||C[ee+1]-C[ee]>5*O||J){if(C[ee]>Oe){for(ie=Z.getTimeTicks(d,C[pe],C[ee],_);ie.length&&ie[0]<=Oe;)ie.shift();ie.length&&(Oe=ie[ie.length-1]),Q.push(ue.length),ue=ue.concat(ie)}pe=ee+1}if(J)break}if(ie){if(de=ie.info,I&&de.unitRange<=pl.hour){for(pe=1,ee=ue.length-1;pe<ee;pe++)Z.dateFormat("%d",ue[pe])!==Z.dateFormat("%d",ue[pe-1])&&(re[ue[pe]]="day",te=!0);te&&(re[ue[0]]="day"),de.higherRanks=re}de.segmentStarts=Q,ue.info=de}else ul(12,!1,this.chart);if(I&&bt(V)){let _e=ue.length,Ve=[],De=[],Se,Me,ze,at,Ct,Xe=_e;for(;Xe--;)Me=this.translate(ue[Xe]),ze&&(De[Xe]=ze-Me),Ve[Xe]=ze=Me;for(De.sort((pr,ls)=>pr-ls),(at=De[Math.floor(De.length/2)])<.6*V&&(at=null),Xe=ue[_e-1]>m?_e-1:_e,ze=void 0;Xe--;)Ct=Math.abs(ze-(Me=Ve[Xe])),ze&&Ct<.8*V&&(at===null||Ct<.8*at)?(re[ue[Xe]]&&!re[ue[Xe+1]]?(Se=Xe+1,ze=Me):Se=Xe,ue.splice(Se,1)):ze=Me}return ue}function a(d){let g=this.ordinal.positions;if(!g)return d;let m=g.length-1,_;return d<0?d=g[0]:d>m?d=g[m]:(m=Math.floor(d),_=d-m),_!==void 0&&g[m]!==void 0?g[m]+(_?_*(g[m+1]-g[m]):0):d}function i(d){let g=this.ordinal,m=this.old?this.old.min:this.min,_=this.old?this.old.transA:this.transA,C=g.getExtendedPositions();if(C!=null&&C.length){let O=as((d-m)*_+this.minPixelPadding),I=as(g.getIndexOfPoint(O,C)),re=as(I%1);if(I>=0&&I<=C.length-1){let V=C[Math.floor(I)],Z=C[Math.ceil(I)];return C[Math.floor(I)]+re*(Z-V)}}return d}function o(d,g){let m=u.Additions.findIndexOf(d,g,!0);if(d[m]===g)return m;let _=(g-d[m])/(d[m+1]-d[m]);return m+_}function l(){this.ordinal||(this.ordinal=new u.Additions(this))}function p(){let{eventArgs:d,options:g}=this;if(this.isXAxis&&bt(g.overscroll)&&g.overscroll!==0&&Os(this.max)&&Os(this.min)&&(this.options.ordinal&&!this.ordinal.originalOrdinalRange&&this.ordinal.getExtendedPositions(!1),this.max===this.dataMax&&((d==null?void 0:d.trigger)!=="pan"||this.isInternal)&&(d==null?void 0:d.trigger)!=="navigator")){let m=this.ordinal.convertOverscroll(g.overscroll);this.max+=m,!this.isInternal&&bt(this.userMin)&&(d==null?void 0:d.trigger)!=="mousewheel"&&(this.min+=m)}}function j(){this.horiz&&!this.isDirty&&(this.isDirty=this.isOrdinal&&this.chart.navigator&&!this.chart.navigator.adaptToUpdatedData)}function N(){this.ordinal&&(this.ordinal.beforeSetTickPositions(),this.tickInterval=this.ordinal.postProcessTickInterval(this.tickInterval))}function k(d){var I;let g=this.xAxis[0],m=g.ordinal.convertOverscroll(g.options.overscroll),_=d.originalEvent.chartX,C=this.options.chart.panning,O=!1;if((C==null?void 0:C.type)!=="y"&&g.options.ordinal&&g.series.length&&(!d.touches||d.touches.length<=1)){let re,V,Z=this.mouseDownX,Q=g.getExtremes(),ee=Q.dataMin,ie=Q.dataMax,te=Q.min,de=Q.max,J=this.hoverPoints,pe=g.closestPointRange||((I=g.ordinal)==null?void 0:I.overscrollPointsRange),ue=Math.round((Z-_)/(g.translationSlope*(g.ordinal.slope||pe))),Oe=g.ordinal.getExtendedPositions(),be={ordinal:{positions:Oe,extendedOrdinalPositions:Oe}},_e=g.index2val,Ve=g.val2lin;if(te<=ee&&ue<=0||de>=ie+m&&ue>=0)return void d.preventDefault();be.ordinal.positions?Math.abs(ue)>1&&(J&&J.forEach(function(De){De.setState()}),V=be.ordinal.positions,m&&(V=be.ordinal.positions=V.concat(g.ordinal.getOverscrollPositions())),ie>V[V.length-1]&&V.push(ie),this.setFixedRange(de-te),(re=g.navigatorAxis.toFixedRange(void 0,void 0,_e.apply(be,[Ve.apply(be,[te,!0])+ue]),_e.apply(be,[Ve.apply(be,[de,!0])+ue]))).min>=Math.min(V[0],te)&&re.max<=Math.max(V[V.length-1],de)+m&&g.setExtremes(re.min,re.max,!0,!1,{trigger:"pan"}),this.mouseDownX=_,hl(this.container,{cursor:"move"})):O=!0}else O=!0;O||C&&/y/.test(C.type)?m&&Os(g.dataMax)&&(g.max=g.dataMax+m):d.preventDefault()}function f(){let d=this.xAxis;d!=null&&d.options.ordinal&&(delete d.ordinal.index,delete d.ordinal.originalOrdinalRange)}function v(d,g){var V;let m,_=this.ordinal,C=_.positions,O=_.slope,I;if(!C)return d;let re=C.length;if(C[0]<=d&&C[re-1]>=d)m=o(C,d);else{if(I=(V=_.getExtendedPositions)==null?void 0:V.call(_),!(I!=null&&I.length))return d;let Z=I.length;O||(O=(I[Z-1]-I[0])/Z);let Q=o(I,C[0]);if(d>=I[0]&&d<=I[Z-1])m=o(I,d)-Q;else{if(!g)return d;m=d<I[0]?-Q-(I[0]-d)/O:(d-I[Z-1])/O+Z-Q}}return g?m:O*(m||0)+_.offset}u.compose=function(d,g,m){let _=d.prototype;return _.ordinal2lin||(_.getTimeTicks=t,_.index2val=a,_.lin2val=i,_.val2lin=v,_.ordinal2lin=_.val2lin,Ut(d,"afterInit",l),Ut(d,"foundExtremes",p),Ut(d,"afterSetScale",j),Ut(d,"initialAxisTranslation",N),Ut(m,"pan",k),Ut(m,"touchpan",k),Ut(g,"updatedData",f)),d},u.Additions=class{constructor(d){this.index={},this.axis=d}beforeSetTickPositions(){var _e;let d=this.axis,g=d.ordinal,m=d.getExtremes(),_=m.min,C=m.max,O=(_e=d.brokenAxis)==null?void 0:_e.hasBreaks,I=d.options.ordinal,re=d.options.overscroll&&d.ordinal.convertOverscroll(d.options.overscroll)||0,V,Z,Q,ee,ie,te,de,J=[],pe=Number.MAX_VALUE,ue=!1,Oe=!1,be=!1;if(I||O){let Ve=0;if(d.series.forEach(function(De,Se){let Me=De.getColumn("x",!0);if(Z=[],Se>0&&De.options.id!=="highcharts-navigator-series"&&Me.length>1&&(Oe=Ve!==Me[1]-Me[0]),Ve=Me[1]-Me[0],De.boosted&&(be=De.boosted),De.reserveSpace()&&(De.takeOrdinalPosition!==!1||O)&&(V=(J=J.concat(Me)).length,J.sort(function(ze,at){return ze-at}),pe=Math.min(pe,zs(De.closestPointRange,pe)),V)){for(Se=0;Se<V-1;)J[Se]!==J[Se+1]&&Z.push(J[Se+1]),Se++;Z[0]!==J[0]&&Z.unshift(J[0]),J=Z}}),d.ordinal.originalOrdinalRange||(d.ordinal.originalOrdinalRange=(J.length-1)*pe),Oe&&be&&(J.pop(),J.shift()),(V=J.length)>2){for(Q=J[1]-J[0],de=V-1;de--&&!ue;)J[de+1]-J[de]!==Q&&(ue=!0);!d.options.keepOrdinalPadding&&(J[0]-_>Q||C-re-J[V-1]>Q)&&(ue=!0)}else d.options.overscroll&&(V===2?pe=J[1]-J[0]:V===1?(pe=re,J=[J[0],J[0]+pe]):pe=g.overscrollPointsRange);ue||d.forceOrdinal?(d.options.overscroll&&(g.overscrollPointsRange=pe,J=J.concat(g.getOverscrollPositions())),g.positions=J,ee=d.ordinal2lin(Math.max(_,J[0]),!0),ie=Math.max(d.ordinal2lin(Math.min(C,J[J.length-1]),!0),1),g.slope=te=(C-_)/(ie-ee),g.offset=_-ee*te):(g.overscrollPointsRange=zs(d.closestPointRange,g.overscrollPointsRange),g.positions=d.ordinal.slope=g.offset=void 0)}d.isOrdinal=I&&ue,g.groupIntervalFactor=null}static findIndexOf(d,g,m){let _=0,C=d.length-1,O;for(;_<C;)d[O=Math.ceil((_+C)/2)]<=g?_=O:C=O-1;return d[_]===g||m?_:-1}getExtendedPositions(d=!0){let g=this,m=g.axis,_=m.constructor.prototype,C=m.chart,O=m.series.reduce((ee,ie)=>{let te=ie.currentDataGrouping;return ee+(te?te.count+te.unitName:"raw")},""),I=d?m.ordinal.convertOverscroll(m.options.overscroll):0,re=m.getExtremes(),V,Z,Q=g.index;return Q||(Q=g.index={}),!Q[O]&&((V={series:[],chart:C,forceOrdinal:!1,getExtremes:function(){return{min:re.dataMin,max:re.dataMax+I}},applyGrouping:_.applyGrouping,getGroupPixelWidth:_.getGroupPixelWidth,getTimeTicks:_.getTimeTicks,options:{ordinal:!0},ordinal:{getGroupIntervalFactor:this.getGroupIntervalFactor},ordinal2lin:_.ordinal2lin,getIndexOfPoint:_.getIndexOfPoint,val2lin:_.val2lin}).ordinal.axis=V,m.series.forEach(ee=>{var te,de,J;if(ee.takeOrdinalPosition===!1)return;Z={xAxis:V,chart:C,groupPixelWidth:ee.groupPixelWidth,destroyGroupedData:S().noop,getColumn:ee.getColumn,applyGrouping:ee.applyGrouping,getProcessedData:ee.getProcessedData,reserveSpace:ee.reserveSpace,visible:ee.visible};let ie=ee.getColumn("x").concat(d?g.getOverscrollPositions():[]);Z.dataTable=new $a({columns:{x:ie}}),Z.options={...ee.options,dataGrouping:ee.currentDataGrouping?{firstAnchor:(te=ee.options.dataGrouping)==null?void 0:te.firstAnchor,anchor:(de=ee.options.dataGrouping)==null?void 0:de.anchor,lastAnchor:(J=ee.options.dataGrouping)==null?void 0:J.firstAnchor,enabled:!0,forced:!0,approximation:"open",units:[[ee.currentDataGrouping.unitName,[ee.currentDataGrouping.count]]]}:{enabled:!1}},V.series.push(Z),ee.processData.apply(Z)}),V.applyGrouping({hasExtremesChanged:!0}),(Z==null?void 0:Z.closestPointRange)!==(Z==null?void 0:Z.basePointRange)&&Z.currentDataGrouping&&(V.forceOrdinal=!0),m.ordinal.beforeSetTickPositions.apply({axis:V}),!m.ordinal.originalOrdinalRange&&V.ordinal.originalOrdinalRange&&(m.ordinal.originalOrdinalRange=V.ordinal.originalOrdinalRange),V.ordinal.positions&&(Q[O]=V.ordinal.positions)),Q[O]}getGroupIntervalFactor(d,g,m){let _=m.getColumn("x",!0),C=_.length,O=[],I,re,V=this.groupIntervalFactor;if(!V){for(re=0;re<C-1;re++)O[re]=_[re+1]-_[re];O.sort(function(Z,Q){return Z-Q}),I=O[Math.floor(C/2)],d=Math.max(d,_[0]),g=Math.min(g,_[C-1]),this.groupIntervalFactor=V=C*I/(g-d)}return V}getIndexOfPoint(d,g){let m=this.axis,_=m.min,C=m.minPixelPadding;return o(g,_)+as((d-C)/(m.translationSlope*(this.slope||m.closestPointRange||this.overscrollPointsRange)))}getOverscrollPositions(){let d=this.axis,g=this.convertOverscroll(d.options.overscroll),m=this.overscrollPointsRange,_=[],C=d.dataMax;if(bt(m))for(;C<d.dataMax+g;)_.push(C+=m);return _}postProcessTickInterval(d){let g=this.axis,m=this.slope,_=g.closestPointRange;return m&&_?g.options.breaks?_||d:d/(m/_):d}convertOverscroll(d=0){let g=this,m=g.axis,_=function(C){return zs(g.originalOrdinalRange,bt(m.dataMax)&&bt(m.dataMin)?m.dataMax-m.dataMin:0)*C};if(ml(d)){let C,O=parseInt(d,10);if(bt(m.min)&&bt(m.max)&&bt(m.dataMin)&&bt(m.dataMax)&&((C=m.max-m.min==m.dataMax-m.dataMin)||(this.originalOrdinalRange=m.max-m.min)),/%$/.test(d))return _(O/100);if(/px/.test(d)){let I=Math.min(O,.9*m.len)/m.len;return _(I/(C?1-I:1))}return 0}return d}}})(K||(K={}));let Is=K,Ls={lang:{rangeSelectorZoom:"Zoom",rangeSelectorFrom:"",rangeSelectorTo:"",rangeSelector:{allText:"All",allTitle:"View all",monthText:"{count}m",monthTitle:"View {count} {#eq count 1}month{else}months{/eq}",yearText:"{count}y",yearTitle:"View {count} {#eq count 1}year{else}years{/eq}",ytdText:"YTD",ytdTitle:"View year to date"}},rangeSelector:{allButtonsEnabled:!1,buttons:[{type:"month",count:1},{type:"month",count:3},{type:"month",count:6},{type:"ytd"},{type:"year",count:1},{type:"all"}],buttonSpacing:5,dropdown:"responsive",enabled:void 0,verticalAlign:"top",buttonTheme:{width:28,height:18,padding:2,zIndex:7},floating:!1,x:0,y:0,height:void 0,inputBoxBorderColor:"none",inputBoxHeight:17,inputBoxWidth:void 0,inputDateFormat:"%[ebY]",inputDateParser:void 0,inputEditDateFormat:"%Y-%m-%d",inputEnabled:!0,inputPosition:{align:"right",x:0,y:0},inputSpacing:5,selected:void 0,buttonPosition:{align:"left",x:0,y:0},inputStyle:{color:"#334eff",cursor:"pointer",fontSize:"0.8em"},labelStyle:{color:"#666666",fontSize:"0.8em"}}},{defaultOptions:Pa}=S(),{composed:gl}=S(),{addEvent:Wt,defined:fl,extend:Ga,isNumber:or,merge:xl,pick:Ua,pushUnique:bl}=S(),Bs=[];function vl(){let u,t,a=this.range,i=a.type,o=this.max,l=this.chart.time,p=function(N,k){let f=l.toParts(N),v=f.slice();i==="year"?v[0]+=k:v[1]+=k;let d=l.makeTime.apply(l,v),g=l.toParts(d);return i==="month"&&f[1]===g[1]&&Math.abs(k)===1&&(v[0]=f[0],v[1]=f[1],v[2]=0),(d=l.makeTime.apply(l,v))-N};or(a)?(u=o-a,t=a):a&&(u=o+p(o,-(a.count||1)),this.chart&&this.chart.setFixedRange(o-u));let j=Ua(this.dataMin,Number.MIN_VALUE);return or(u)||(u=j),u<=j&&(u=j,t===void 0&&(t=p(u,a.count)),this.newMax=Math.min(u+t,Ua(this.dataMax,Number.MAX_VALUE))),or(o)?!or(a)&&a&&a._offsetMin&&(u+=a._offsetMin):u=void 0,u}function yl(){var u;(u=this.rangeSelector)==null||u.redrawElements()}function wl(){this.options.rangeSelector&&this.options.rangeSelector.enabled&&(this.rangeSelector=new M(this))}function jl(){let u=this.rangeSelector;if(u){or(u.deferredYTDClick)&&(u.clickButton(u.deferredYTDClick),delete u.deferredYTDClick);let t=u.options.verticalAlign;u.options.floating||(t==="bottom"?this.extraBottomMargin=!0:t==="top"&&(this.extraTopMargin=!0))}}function Wa(){let u,t=this.rangeSelector;if(!t)return;let a=this.xAxis[0].getExtremes(),i=this.legend,o=t&&t.options.verticalAlign;or(a.min)&&t.render(a.min,a.max),i.display&&o==="top"&&o===i.options.verticalAlign&&(u=xl(this.spacingBox),i.options.layout==="vertical"?u.y=this.plotTop:u.y+=t.getHeight(),i.group.placed=!1,i.align(u))}function Nl(){for(let u=0,t=Bs.length;u<t;++u){let a=Bs[u];if(a[0]===this){a[1].forEach(i=>i()),Bs.splice(u,1);return}}}function kl(){var t;let u=this.rangeSelector;if((t=u==null?void 0:u.options)!=null&&t.enabled){let a=u.getHeight(),i=u.options.verticalAlign;u.options.floating||(i==="bottom"?this.marginBottom+=a:i!=="middle"&&(this.plotTop+=a))}}function _l(u){let t=u.options.rangeSelector,a=this.extraBottomMargin,i=this.extraTopMargin,o=this.rangeSelector;if(t&&t.enabled&&!fl(o)&&this.options.rangeSelector&&(this.options.rangeSelector.enabled=!0,this.rangeSelector=o=new M(this)),this.extraBottomMargin=!1,this.extraTopMargin=!1,o){let l=t&&t.verticalAlign||o.options&&o.options.verticalAlign;o.options.floating||(l==="bottom"?this.extraBottomMargin=!0:l!=="middle"&&(this.extraTopMargin=!0)),(this.extraBottomMargin!==a||this.extraTopMargin!==i)&&(this.isDirtyBox=!0)}}let Sl={compose:function(u,t,a){if(M=a,bl(gl,"RangeSelector")){let i=t.prototype;u.prototype.minFromRange=vl,Wt(t,"afterGetContainer",wl),Wt(t,"beforeRender",jl),Wt(t,"destroy",Nl),Wt(t,"getMargins",kl),Wt(t,"redraw",Wa),Wt(t,"update",_l),Wt(t,"beforeRedraw",yl),i.callbacks.push(Wa),Ga(Pa,{rangeSelector:Ls.rangeSelector}),Ga(Pa.lang,Ls.lang)}}};var Ml=ne(28),Ha=ne.n(Ml),Cl=ne(984),Fs=ne.n(Cl);let{defaultOptions:$s}=S(),{format:qa}=Fs(),{addEvent:vt,createElement:Dr,css:kt,defined:_t,destroyObjectProperties:Al,diffObjects:El,discardElement:Rl,extend:Va,fireEvent:lr,isNumber:st,isString:Ps,merge:Tt,objectEach:Tl,pick:yt,splat:Dl}=S();function Xa(u){let t=o=>RegExp(`%[[a-zA-Z]*${o}`).test(u);if(Ps(u)?u.indexOf("%L")!==-1:u.fractionalSecondDigits)return"text";let a=Ps(u)?["a","A","d","e","w","b","B","m","o","y","Y"].some(t):u.dateStyle||u.day||u.month||u.year,i=Ps(u)?["H","k","I","l","M","S"].some(t):u.timeStyle||u.hour||u.minute||u.second;return a&&i?"datetime-local":a?"date":i?"time":"text"}class Or{static compose(t,a){Sl.compose(t,a,Or)}constructor(t){this.isDirty=!1,this.buttonOptions=[],this.initialButtonGroupWidth=0,this.maxButtonWidth=()=>{let a=0;return this.buttons.forEach(i=>{let o=i.getBBox();o.width>a&&(a=o.width)}),a},this.init(t)}clickButton(t,a){let i=this.chart,o=this.buttonOptions[t],l=i.xAxis[0],p=i.scroller&&i.scroller.getUnionExtremes()||l||{},j=o.type,N=o.dataGrouping,k=p.dataMin,f=p.dataMax,v,d=st(l==null?void 0:l.max)?Math.round(Math.min(l.max,f??l.max)):void 0,g,m=o._range,_,C,O,I=!0;if(k!==null&&f!==null){if(this.setSelected(t),N&&(this.forcedDataGrouping=!0,Je().prototype.setDataGrouping.call(l||{chart:this.chart},N,!1),this.frozenStates=o.preserveDataGrouping),j==="month"||j==="year")l?(C={range:o,max:d,chart:i,dataMin:k,dataMax:f},v=l.minFromRange.call(C),st(C.newMax)&&(d=C.newMax),I=!1):m=o;else if(m)st(d)&&(d=Math.min((v=Math.max(d-m,k))+m,f),I=!1);else if(j==="ytd")if(l)!l.hasData()||st(f)&&st(k)||(k=Number.MAX_VALUE,f=-Number.MAX_VALUE,i.series.forEach(re=>{let V=re.getColumn("x");V.length&&(k=Math.min(V[0],k),f=Math.max(V[V.length-1],f))}),a=!1),st(f)&&st(k)&&(v=_=(O=this.getYTDExtremes(f,k)).min,d=O.max);else{this.deferredYTDClick=t;return}else j==="all"&&l&&(i.navigator&&i.navigator.baseSeries[0]&&(i.navigator.baseSeries[0].xAxis.options.range=void 0),v=k,d=f);if(I&&o._offsetMin&&_t(v)&&(v+=o._offsetMin),o._offsetMax&&_t(d)&&(d+=o._offsetMax),this.dropdown&&(this.dropdown.selectedIndex=t+1),l)st(v)&&st(d)&&(l.setExtremes(v,d,yt(a,!0),void 0,{trigger:"rangeSelectorButton",rangeSelectorButton:o}),i.setFixedRange(o._range));else{g=Dl(i.options.xAxis||{})[0];let re=vt(i,"afterCreateAxes",function(){let V=i.xAxis[0];V.range=V.options.range=m,V.min=V.options.min=_});vt(i,"load",function(){let V=i.xAxis[0];i.setFixedRange(o._range),V.options.range=g.range,V.options.min=g.min,re()})}lr(this,"afterBtnClick")}}setSelected(t){this.selected=this.options.selected=t}init(t){let a=this,i=t.options.rangeSelector,o=t.options.lang,l=i.buttons,p=i.selected,j=function(){let N=a.minInput,k=a.maxInput;N&&N.blur&&lr(N,"blur"),k&&k.blur&&lr(k,"blur")};a.chart=t,a.options=i,a.buttons=[],a.buttonOptions=l.map(N=>(N.type&&o.rangeSelector&&(N.text??(N.text=o.rangeSelector[`${N.type}Text`]),N.title??(N.title=o.rangeSelector[`${N.type}Title`])),N.text=qa(N.text,{count:N.count||1}),N.title=qa(N.title,{count:N.count||1}),N)),this.eventsToUnbind=[],this.eventsToUnbind.push(vt(t.container,"mousedown",j)),this.eventsToUnbind.push(vt(t,"resize",j)),l.forEach(a.computeButtonRange),p!==void 0&&l[p]&&this.clickButton(p,!1),this.eventsToUnbind.push(vt(t,"load",function(){t.xAxis&&t.xAxis[0]&&vt(t.xAxis[0],"setExtremes",function(N){st(this.max)&&st(this.min)&&this.max-this.min!==t.fixedRange&&N.trigger!=="rangeSelectorButton"&&N.trigger!=="updatedData"&&a.forcedDataGrouping&&!a.frozenStates&&this.setDataGrouping(!1,!1)})})),this.createElements()}updateButtonStates(){let t=this,a=this.chart,i=this.dropdown,o=this.dropdownLabel,l=a.xAxis[0],p=Math.round(l.max-l.min),j=!l.hasVisibleSeries,N=24*36e5,k=a.scroller&&a.scroller.getUnionExtremes()||l,f=k.dataMin,v=k.dataMax,d=t.getYTDExtremes(v,f),g=d.min,m=d.max,_=t.selected,C=t.options.allButtonsEnabled,O=Array(t.buttonOptions.length).fill(0),I=st(_),re=t.buttons,V=!1,Z=null;t.buttonOptions.forEach((Q,ee)=>{var Se;let ie=Q._range,te=Q.type,de=Q.count||1,J=Q._offsetMax-Q._offsetMin,pe=ee===_,ue=ie>v-f,Oe=ie<l.minRange,be=!1,_e=ie===p;if(pe&&ue&&(V=!0),l.isOrdinal&&((Se=l.ordinal)==null?void 0:Se.positions)&&ie&&p<ie){let Me=l.ordinal.positions,ze=Is.Additions.findIndexOf(Me,l.min,!0),at=Math.min(Is.Additions.findIndexOf(Me,l.max,!0)+1,Me.length-1);Me[at]-Me[ze]>ie&&(_e=!0)}else(te==="month"||te==="year")&&p+36e5>={month:28,year:365}[te]*N*de-J&&p-36e5<={month:31,year:366}[te]*N*de+J?_e=!0:te==="ytd"?(_e=m-g+J===p,be=!pe):te==="all"&&(_e=l.max-l.min>=v-f);let Ve=!C&&!(V&&te==="all")&&(ue||Oe||j),De=V&&te==="all"||!be&&_e||pe&&t.frozenStates;Ve?O[ee]=3:De&&(!I||ee===_)&&(Z=ee)}),Z!==null?(O[Z]=2,t.setSelected(Z),this.dropdown&&(this.dropdown.selectedIndex=Z+1)):(t.setSelected(),this.dropdown&&(this.dropdown.selectedIndex=-1),o&&(o.setState(0),o.attr({text:($s.lang.rangeSelectorZoom||"")+" "})));for(let Q=0;Q<O.length;Q++){let ee=O[Q],ie=re[Q];if(ie.state!==ee&&(ie.setState(ee),i)){i.options[Q+1].disabled=ee===3,ee===2&&(o&&(o.setState(2),o.attr({text:t.buttonOptions[Q].text+" "})),i.selectedIndex=Q+1);let te=o.getBBox();kt(i,{width:`${te.width}px`,height:`${te.height}px`})}}}computeButtonRange(t){let a=t.type,i=t.count||1,o={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5};o[a]?t._range=o[a]*i:(a==="month"||a==="year")&&(t._range=24*{month:30,year:365}[a]*36e5*i),t._offsetMin=yt(t.offsetMin,0),t._offsetMax=yt(t.offsetMax,0),t._range+=t._offsetMax-t._offsetMin}getInputValue(t){let a=t==="min"?this.minInput:this.maxInput,i=this.chart.options.rangeSelector,o=this.chart.time;return a?(a.type==="text"&&i.inputDateParser||this.defaultInputDateParser)(a.value,o.timezone==="UTC",o):0}setInputValue(t,a){let i=this.options,o=this.chart.time,l=t==="min"?this.minInput:this.maxInput,p=t==="min"?this.minDateBox:this.maxDateBox;if(l){l.setAttribute("type",Xa(i.inputDateFormat||"%e %b %Y"));let j=l.getAttribute("data-hc-time"),N=_t(j)?Number(j):void 0;if(_t(a)){let k=N;_t(k)&&l.setAttribute("data-hc-time-previous",k),l.setAttribute("data-hc-time",a),N=a}l.value=o.dateFormat(this.inputTypeFormats[l.type]||i.inputEditDateFormat,N),p&&p.attr({text:o.dateFormat(i.inputDateFormat,N)})}}setInputExtremes(t,a,i){let o=t==="min"?this.minInput:this.maxInput;if(o){let l=this.inputTypeFormats[o.type],p=this.chart.time;if(l){let j=p.dateFormat(l,a);o.min!==j&&(o.min=j);let N=p.dateFormat(l,i);o.max!==N&&(o.max=N)}}}showInput(t){let a=t==="min"?this.minDateBox:this.maxDateBox,i=t==="min"?this.minInput:this.maxInput;if(i&&a&&this.inputGroup){let o=i.type==="text",{translateX:l=0,translateY:p=0}=this.inputGroup,{x:j=0,width:N=0,height:k=0}=a,{inputBoxWidth:f}=this.options;kt(i,{width:o?N+(f?-2:20)+"px":"auto",height:k-2+"px",border:"2px solid silver"}),o&&f?kt(i,{left:l+j+"px",top:p+"px"}):kt(i,{left:Math.min(Math.round(j+l-(i.offsetWidth-N)/2),this.chart.chartWidth-i.offsetWidth)+"px",top:p-(i.offsetHeight-k)/2+"px"})}}hideInput(t){let a=t==="min"?this.minInput:this.maxInput;a&&kt(a,{top:"-9999em",border:0,width:"1px",height:"1px"})}defaultInputDateParser(t,a,i){return(i==null?void 0:i.parse(t))||0}drawInput(t){let{chart:a,div:i,inputGroup:o}=this,l=this,p=a.renderer.style||{},j=a.renderer,N=a.options.rangeSelector,k=$s.lang,f=t==="min";function v(O){var de;let{maxInput:I,minInput:re}=l,V=a.xAxis[0],Z=((de=a.scroller)==null?void 0:de.getUnionExtremes())||V,Q=Z.dataMin,ee=Z.dataMax,ie=a.xAxis[0].getExtremes()[O],te=l.getInputValue(O);st(te)&&te!==ie&&(f&&I&&st(Q)?te>Number(I.getAttribute("data-hc-time"))?te=void 0:te<Q&&(te=Q):re&&st(ee)&&(te<Number(re.getAttribute("data-hc-time"))?te=void 0:te>ee&&(te=ee)),te!==void 0&&V.setExtremes(f?te:V.min,f?V.max:te,void 0,void 0,{trigger:"rangeSelectorInput"}))}let d=k[f?"rangeSelectorFrom":"rangeSelectorTo"]||"",g=j.label(d,0).addClass("highcharts-range-label").attr({padding:2*!!d,height:d?N.inputBoxHeight:0}).add(o),m=j.label("",0).addClass("highcharts-range-input").attr({padding:2,width:N.inputBoxWidth,height:N.inputBoxHeight,"text-align":"center"}).on("click",function(){l.showInput(t),l[t+"Input"].focus()});a.styledMode||m.attr({stroke:N.inputBoxBorderColor,"stroke-width":1}),m.add(o);let _=Dr("input",{name:t,className:"highcharts-range-selector"},void 0,i);_.setAttribute("type",Xa(N.inputDateFormat||"%e %b %Y")),a.styledMode||(g.css(Tt(p,N.labelStyle)),m.css(Tt({color:"#333333"},p,N.inputStyle)),kt(_,Va({position:"absolute",border:0,boxShadow:"0 0 15px rgba(0,0,0,0.3)",width:"1px",height:"1px",padding:0,textAlign:"center",fontSize:p.fontSize,fontFamily:p.fontFamily,top:"-9999em"},N.inputStyle))),_.onfocus=()=>{l.showInput(t)},_.onblur=()=>{_===S().doc.activeElement&&v(t),l.hideInput(t),l.setInputValue(t),_.blur()};let C=!1;return _.onchange=()=>{C||(v(t),l.hideInput(t),_.blur())},_.onkeypress=O=>{O.keyCode===13&&v(t)},_.onkeydown=O=>{C=!0,(O.key==="ArrowUp"||O.key==="ArrowDown"||O.key==="Tab")&&v(t)},_.onkeyup=()=>{C=!1},{dateBox:m,input:_,label:g}}getPosition(){let t=this.chart,a=t.options.rangeSelector,i=a.verticalAlign==="top"?t.plotTop-t.axisOffset[0]:0;return{buttonTop:i+a.buttonPosition.y,inputTop:i+a.inputPosition.y-10}}getYTDExtremes(t,a){let i=this.chart.time,o=i.toParts(t)[0];return{max:t,min:Math.max(a,i.makeTime(o,0))}}createElements(){var N;let t=this.chart,a=t.renderer,i=t.container,o=t.options,l=o.rangeSelector,p=l.inputEnabled,j=yt((N=o.chart.style)==null?void 0:N.zIndex,0)+1;l.enabled!==!1&&(this.group=a.g("range-selector-group").attr({zIndex:7}).add(),this.div=Dr("div",void 0,{position:"relative",height:0,zIndex:j}),this.buttonOptions.length&&this.renderButtons(),i.parentNode&&i.parentNode.insertBefore(this.div,i),p&&this.createInputs())}createInputs(){this.inputGroup=this.chart.renderer.g("input-group").add(this.group);let t=this.drawInput("min");this.minDateBox=t.dateBox,this.minLabel=t.label,this.minInput=t.input;let a=this.drawInput("max");this.maxDateBox=a.dateBox,this.maxLabel=a.label,this.maxInput=a.input}render(t,a){var l,p;if(this.options.enabled===!1)return;let i=this.chart,o=i.options.rangeSelector;if(o.inputEnabled){this.inputGroup||this.createInputs(),this.setInputValue("min",t),this.setInputValue("max",a),this.chart.styledMode||((l=this.maxLabel)==null||l.css(o.labelStyle),(p=this.minLabel)==null||p.css(o.labelStyle));let j=i.scroller&&i.scroller.getUnionExtremes()||i.xAxis[0]||{};if(_t(j.dataMin)&&_t(j.dataMax)){let N=i.xAxis[0].minRange||0;this.setInputExtremes("min",j.dataMin,Math.min(j.dataMax,this.getInputValue("max"))-N),this.setInputExtremes("max",Math.max(j.dataMin,this.getInputValue("min"))+N,j.dataMax)}if(this.inputGroup){let N=0;[this.minLabel,this.minDateBox,this.maxLabel,this.maxDateBox].forEach(k=>{if(k){let{width:f}=k.getBBox();f&&(k.attr({x:N}),N+=f+o.inputSpacing)}})}}else this.inputGroup&&(this.inputGroup.destroy(),delete this.inputGroup);!this.chart.styledMode&&this.zoomText&&this.zoomText.css(o.labelStyle),this.alignElements(),this.updateButtonStates()}renderButtons(){var d;var t;let{chart:a,options:i}=this,o=$s.lang,l=a.renderer,p=Tt(i.buttonTheme),j=p&&p.states;delete p.width,delete p.states,this.buttonGroup=l.g("range-selector-buttons").add(this.group);let N=this.dropdown=Dr("select",void 0,{position:"absolute",padding:0,border:0,cursor:"pointer",opacity:1e-4},this.div),k=(d=a.userOptions.rangeSelector)==null?void 0:d.buttonTheme;this.dropdownLabel=l.button("",0,0,()=>{},Tt(p,{"stroke-width":yt(p["stroke-width"],0),width:"auto",paddingLeft:yt(i.buttonTheme.paddingLeft,k==null?void 0:k.padding,8),paddingRight:yt(i.buttonTheme.paddingRight,k==null?void 0:k.padding,8)}),j&&j.hover,j&&j.select,j&&j.disabled).hide().add(this.group),vt(N,"touchstart",()=>{N.style.fontSize="16px"});let f=S().isMS?"mouseover":"mouseenter",v=S().isMS?"mouseout":"mouseleave";vt(N,f,()=>{lr(this.dropdownLabel.element,f)}),vt(N,v,()=>{lr(this.dropdownLabel.element,v)}),vt(N,"change",()=>{lr(this.buttons[N.selectedIndex-1].element,"click")}),this.zoomText=l.label(o.rangeSelectorZoom||"",0).attr({padding:i.buttonTheme.padding,height:i.buttonTheme.height,paddingLeft:0,paddingRight:0}).add(this.buttonGroup),this.chart.styledMode||(this.zoomText.css(i.labelStyle),(t=i.buttonTheme)["stroke-width"]??(t["stroke-width"]=0)),Dr("option",{textContent:this.zoomText.textStr,disabled:!0},void 0,N),this.createButtons()}createButtons(){let{options:t}=this,a=Tt(t.buttonTheme),i=a&&a.states,o=a.width||28;delete a.width,delete a.states,this.buttonOptions.forEach((l,p)=>{this.createButton(l,p,o,i)})}createButton(t,a,i,o){let{dropdown:l,buttons:p,chart:j,options:N}=this,k=j.renderer,f=Tt(N.buttonTheme);l==null||l.add(Dr("option",{textContent:t.title||t.text}),a+2),p[a]=k.button(t.text??"",0,0,v=>{let d,g=t.events&&t.events.click;g&&(d=g.call(t,v)),d!==!1&&this.clickButton(a),this.isActive=!0},f,o&&o.hover,o&&o.select,o&&o.disabled).attr({"text-align":"center",width:i}).add(this.buttonGroup),t.title&&p[a].attr("title",t.title)}alignElements(){var _;let{buttonGroup:t,buttons:a,chart:i,group:o,inputGroup:l,options:p,zoomText:j}=this,N=i.options,k=N.exporting&&N.exporting.enabled!==!1&&N.navigation&&N.navigation.buttonOptions,{buttonPosition:f,inputPosition:v,verticalAlign:d}=p,g=(C,O,I)=>k&&this.titleCollision(i)&&d==="top"&&I&&O.y-C.getBBox().height-12<(k.y||0)+(k.height||0)+i.spacing[0]?-40:0,m=i.plotLeft;if(o&&f&&v){let C=f.x-i.spacing[3];if(t){if(this.positionButtons(),!this.initialButtonGroupWidth){let te=0;j&&(te+=j.getBBox().width+5),a.forEach((de,J)=>{te+=de.width||0,J!==a.length-1&&(te+=p.buttonSpacing)}),this.initialButtonGroupWidth=te}m-=i.spacing[3];let ie=g(t,f,f.align==="right"||v.align==="right");this.alignButtonGroup(ie),(_=this.buttonGroup)!=null&&_.translateY&&this.dropdownLabel.attr({y:this.buttonGroup.translateY}),o.placed=t.placed=i.hasLoaded}let O=0;p.inputEnabled&&l&&(O=g(l,v,f.align==="right"||v.align==="right"),v.align==="left"?C=m:v.align==="right"&&(C=-Math.max(i.axisOffset[1],-O)),l.align({y:v.y,width:l.getBBox().width,align:v.align,x:v.x+C-2},!0,i.spacingBox),l.placed=i.hasLoaded),this.handleCollision(O),o.align({verticalAlign:d},!0,i.spacingBox);let I=o.alignAttr.translateY,re=o.getBBox().height+20,V=0;if(d==="bottom"){let ie=i.legend&&i.legend.options;V=I-(re=re+(ie&&ie.verticalAlign==="bottom"&&ie.enabled&&!ie.floating?i.legend.legendHeight+yt(ie.margin,10):0)-20)-(p.floating?0:p.y)-(i.titleOffset?i.titleOffset[2]:0)-10}d==="top"?(p.floating&&(V=0),i.titleOffset&&i.titleOffset[0]&&(V=i.titleOffset[0]),V+=i.margin[0]-i.spacing[0]||0):d==="middle"&&(v.y===f.y?V=I:(v.y||f.y)&&(v.y<0||f.y<0?V-=Math.min(v.y,f.y):V=I-re)),o.translate(p.x,p.y+Math.floor(V));let{minInput:Z,maxInput:Q,dropdown:ee}=this;p.inputEnabled&&Z&&Q&&(Z.style.marginTop=o.translateY+"px",Q.style.marginTop=o.translateY+"px"),ee&&(ee.style.marginTop=o.translateY+"px")}}redrawElements(){var o,l,p,j,N;let t=this.chart,{inputBoxHeight:a,inputBoxBorderColor:i}=this.options;if((o=this.maxDateBox)==null||o.attr({height:a}),(l=this.minDateBox)==null||l.attr({height:a}),t.styledMode||((p=this.maxDateBox)==null||p.attr({stroke:i}),(j=this.minDateBox)==null||j.attr({stroke:i})),this.isDirty){this.isDirty=!1,this.isCollapsed=void 0;let k=this.options.buttons??[],f=Math.min(k.length,this.buttonOptions.length),{dropdown:v,options:d}=this,g=Tt(d.buttonTheme),m=g&&g.states,_=g.width||28;if(k.length<this.buttonOptions.length)for(let C=this.buttonOptions.length-1;C>=k.length;C--){let O=this.buttons.pop();O==null||O.destroy(),(N=this.dropdown)==null||N.options.remove(C+1)}for(let C=f-1;C>=0;C--)if(Object.keys(El(k[C],this.buttonOptions[C])).length!==0){let O=k[C];this.buttons[C].destroy(),v==null||v.options.remove(C+1),this.createButton(O,C,_,m),this.computeButtonRange(O)}if(k.length>this.buttonOptions.length)for(let C=this.buttonOptions.length;C<k.length;C++)this.createButton(k[C],C,_,m),this.computeButtonRange(k[C]);this.buttonOptions=this.options.buttons??[],_t(this.options.selected)&&this.buttons.length&&this.clickButton(this.options.selected,!1)}}alignButtonGroup(t,a){let{chart:i,options:o,buttonGroup:l,dropdown:p,dropdownLabel:j}=this,{buttonPosition:N}=o,k=i.plotLeft-i.spacing[3],f=N.x-i.spacing[3],v=i.plotLeft;N.align==="right"?(f+=t-k,this.hasVisibleDropdown&&(v=i.chartWidth+t-this.maxButtonWidth()-20)):N.align==="center"&&(f-=k/2,this.hasVisibleDropdown&&(v=i.chartWidth/2-this.maxButtonWidth())),p&&kt(p,{left:v+"px",top:(l==null?void 0:l.translateY)+"px"}),j==null||j.attr({x:v}),l&&l.align({y:N.y,width:yt(a,this.initialButtonGroupWidth),align:N.align,x:f},!0,i.spacingBox)}positionButtons(){let{buttons:t,chart:a,options:i,zoomText:o}=this,l=a.hasLoaded?"animate":"attr",{buttonPosition:p}=i,j=a.plotLeft,N=j;o&&o.visibility!=="hidden"&&(o[l]({x:yt(j+p.x,j)}),N+=p.x+o.getBBox().width+5);for(let k=0,f=this.buttonOptions.length;k<f;++k)t[k].visibility!=="hidden"?(t[k][l]({x:N}),N+=(t[k].width||0)+i.buttonSpacing):t[k][l]({x:j})}handleCollision(t){let{chart:a,buttonGroup:i,inputGroup:o,initialButtonGroupWidth:l}=this,{buttonPosition:p,dropdown:j,inputPosition:N}=this.options,k=()=>{o&&i&&o.attr({translateX:o.alignAttr.translateX+(a.axisOffset[1]>=-t?0:-t),translateY:o.alignAttr.translateY+i.getBBox().height+10})};o&&i?N.align===p.align?(k(),l>a.plotWidth+t-20?this.collapseButtons():this.expandButtons()):l-t+o.getBBox().width>a.plotWidth?j==="responsive"?this.collapseButtons():k():this.expandButtons():i&&j==="responsive"&&(l>a.plotWidth?this.collapseButtons():this.expandButtons()),i&&(j==="always"&&this.collapseButtons(),j==="never"&&this.expandButtons()),this.alignButtonGroup(t)}collapseButtons(){let{buttons:t,zoomText:a}=this;this.isCollapsed!==!0&&(this.isCollapsed=!0,a.hide(),t.forEach(i=>void i.hide()),this.showDropdown())}expandButtons(){let{buttons:t,zoomText:a}=this;this.isCollapsed!==!1&&(this.isCollapsed=!1,this.hideDropdown(),a.show(),t.forEach(i=>void i.show()),this.positionButtons())}showDropdown(){let{buttonGroup:t,dropdownLabel:a,dropdown:i}=this;t&&i&&(a.show(),kt(i,{visibility:"inherit"}),this.hasVisibleDropdown=!0)}hideDropdown(){let{dropdown:t}=this;t&&(this.dropdownLabel.hide(),kt(t,{visibility:"hidden",width:"1px",height:"1px"}),this.hasVisibleDropdown=!1)}getHeight(){let t=this.options,a=this.group,i=t.inputPosition,o=t.buttonPosition,l=t.y,p=o.y,j=i.y,N=0;if(t.height)return t.height;this.alignElements(),N=a?a.getBBox(!0).height+13+l:0;let k=Math.min(j,p);return(j<0&&p<0||j>0&&p>0)&&(N+=Math.abs(k)),N}titleCollision(t){return!(t.options.title.text||t.options.subtitle.text)}update(t,a=!0){let i=this.chart;if(Tt(!0,this.options,t),this.options.selected&&this.options.selected>=this.options.buttons.length&&(this.options.selected=void 0,i.options.rangeSelector.selected=void 0),_t(t.enabled))return this.destroy(),this.init(i);this.isDirty=!!t.buttons,a&&this.render()}destroy(){let t=this,a=t.minInput,i=t.maxInput;t.eventsToUnbind&&(t.eventsToUnbind.forEach(o=>o()),t.eventsToUnbind=void 0),Al(t.buttons),a&&(a.onfocus=a.onblur=a.onchange=null),i&&(i.onfocus=i.onblur=i.onchange=null),Tl(t,function(o,l){o&&l!=="chart"&&(o instanceof Ha()?o.destroy():o instanceof window.HTMLElement&&Rl(o),delete t[l]),o!==Or.prototype[l]&&(t[l]=null)},this),this.buttons=[]}}Va(Or.prototype,{inputTypeFormats:{"datetime-local":"%Y-%m-%dT%H:%M:%S",date:"%Y-%m-%d",time:"%H:%M:%S"}});var Ol=ne(960),Ya=ne.n(Ol);let{format:zl}=Fs(),{getOptions:Za}=S(),{setFixedRange:Il}=Ca,{addEvent:Ht,clamp:Ll,crisp:Ka,defined:Gs,extend:Bl,find:Fl,isNumber:Dt,isString:$l,merge:dr,pick:St,splat:Ja}=S();function Us(u,t,a){return u==="xAxis"?{minPadding:0,maxPadding:0,overscroll:0,ordinal:!0}:u==="yAxis"?{labels:{y:-2},opposite:a.opposite??t.opposite??!0,showLastLabel:!!(t.categories||t.type==="category"),title:{text:void 0}}:{}}function Qa(u,t){var a;if(u==="xAxis"){let i=St((a=t.navigator)==null?void 0:a.enabled,Es.enabled,!0),o={type:"datetime",categories:void 0};return i&&(o.startOnTick=!1,o.endOnTick=!1),o}return{}}class Ws extends Ya(){init(t,a){var N,k;let i=Za(),o=t.xAxis,l=t.yAxis,p=St((N=t.navigator)==null?void 0:N.enabled,Es.enabled,!0);t.xAxis=t.yAxis=void 0;let j=dr({chart:{panning:{enabled:!0,type:"x"},zooming:{pinchType:"x",mouseWheel:{type:"x"}}},navigator:{enabled:p},scrollbar:{enabled:St(Jr.enabled,!0)},rangeSelector:{enabled:St(Ls.rangeSelector.enabled,!0)},title:{text:null},tooltip:{split:St((k=i.tooltip)==null?void 0:k.split,!0),crosshairs:!0},legend:{enabled:!1}},t,{isStock:!0});t.xAxis=o,t.yAxis=l,j.xAxis=Ja(t.xAxis||{}).map(f=>dr(Us("xAxis",f,i.xAxis),f,Qa("xAxis",t))),j.yAxis=Ja(t.yAxis||{}).map(f=>dr(Us("yAxis",f,i.yAxis),f)),super.init(j,a)}createAxis(t,a){return a.axis=dr(Us(t,a.axis,Za()[t]),a.axis,Qa(t,this.userOptions)),super.createAxis(t,a)}}Ht(Ya(),"update",function(u){let t=u.options;"scrollbar"in t&&this.navigator&&(dr(!0,this.options.scrollbar,t.scrollbar),this.navigator.update({enabled:!!this.navigator.navigatorEnabled}),delete t.scrollbar)}),function(u){function t(k){var ze,at,Ct,Xe;if(!((at=(ze=this.crosshair)==null?void 0:ze.label)!=null&&at.enabled&&this.cross&&Dt(this.min)&&Dt(this.max)))return;let f=this.chart,v=this.logarithmic,d=this.crosshair.label,g=this.horiz,m=this.opposite,_=this.left,C=this.top,O=this.width,I=this.options.tickPosition==="inside",re=this.crosshair.snap!==!1,V=k.e||((Ct=this.cross)==null?void 0:Ct.e),Z=k.point,Q=this.crossLabel,ee,ie,te=d.format,de="",J,pe=0,ue=this.min,Oe=this.max;v&&(ue=v.lin2log(this.min),Oe=v.lin2log(this.max));let be=g?"center":m?this.labelAlign==="right"?"right":"left":this.labelAlign==="left"?"left":"center";!Q&&(Q=this.crossLabel=f.renderer.label("",0,void 0,d.shape||"callout").addClass("highcharts-crosshair-label highcharts-color-"+(Z!=null&&Z.series?Z.series.colorIndex:this.series[0]&&this.series[0].colorIndex)).attr({align:d.align||be,padding:St(d.padding,8),r:St(d.borderRadius,3),zIndex:2}).add(this.labelGroup),f.styledMode||Q.attr({fill:d.backgroundColor||((Xe=Z==null?void 0:Z.series)==null?void 0:Xe.color)||"#666666",stroke:d.borderColor||"","stroke-width":d.borderWidth||0}).css(Bl({color:"#ffffff",fontWeight:"normal",fontSize:"0.7em",textAlign:"center"},d.style||{}))),g?(ee=re?(Z.plotX||0)+_:V.chartX,ie=C+(m?0:this.height)):(ee=_+this.offset+(m?O:0),ie=re?(Z.plotY||0)+C:V.chartY),te||d.formatter||(this.dateTime&&(de="%b %d, %Y"),te="{value"+(de?":"+de:"")+"}");let _e=re?this.isXAxis?Z.x:Z.y:this.toValue(g?V.chartX:V.chartY),Ve=Z!=null&&Z.series?Z.series.isPointInside(Z):Dt(_e)&&_e>ue&&_e<Oe,De="";te?De=zl(te,{value:_e},f):d.formatter&&Dt(_e)&&(De=d.formatter.call(this,_e)),Q.attr({text:De,x:ee,y:ie,visibility:Ve?"inherit":"hidden"});let Se=Q.getBBox();!Dt(Q.x)||g||m||(ee=Q.x-Se.width/2),Dt(Q.y)&&(g?(I&&!m||!I&&m)&&(ie=Q.y-Se.height):ie=Q.y-Se.height/2),J=g?{left:_,right:_+this.width}:{left:this.labelAlign==="left"?_:0,right:this.labelAlign==="right"?_+this.width:f.chartWidth};let Me=Q.translateX||0;Me<J.left&&(pe=J.left-Me),Me+Se.width>=J.right&&(pe=-(Me+Se.width-J.right)),Q.attr({x:Math.max(0,ee+pe),y:Math.max(0,ie),anchorX:g?ee:this.opposite?0:f.chartWidth,anchorY:g?this.opposite?f.chartHeight:0:ie+Se.height/2})}function a(){this.crossLabel&&(this.crossLabel=this.crossLabel.hide())}function i(k){let f=this.chart,v=this.options,d=f._labelPanes=f._labelPanes||{},g=v.labels;if(f.options.isStock&&this.coll==="yAxis"){let m=v.top+","+v.height;!d[m]&&g.enabled&&(g.distance===15&&this.side===1&&(g.distance=0),g.align===void 0&&(g.align="right"),d[m]=this,k.align="right",k.preventDefault())}}function o(){let k=this.chart,f=this.options&&this.options.top+","+this.options.height;f&&k._labelPanes&&k._labelPanes[f]===this&&delete k._labelPanes[f]}function l(k){let f=this,v=f.isLinked&&!f.series&&f.linkedParent?f.linkedParent.series:f.series,{chart:d,horiz:g}=f,m=d.renderer,_=[],{acrossPanes:C=!0,force:O,translatedValue:I,value:re}=k,V=(f.isXAxis?d.yAxis:d.xAxis)||[];function Z(te,de,J){_.push(["M",g?te:de,g?de:te],["L",g?te:J,g?J:te])}let Q=[],ee,ie;if(d.options.isStock&&(f.coll==="xAxis"||f.coll==="yAxis")){for(let te of(k.preventDefault(),Q=(de=>{let J=de==="xAxis"?"yAxis":"xAxis",pe=f.options[J];return C&&!f.options.isInternal?V.filter(ue=>!ue.options.isInternal):Dt(pe)?[d[J][pe]]:$l(pe)?[d.get(pe)]:v.map(ue=>ue[J])})(f.coll),V))if(!te.options.isInternal){let de=te.isXAxis?"yAxis":"xAxis";f===(Gs(te.options[de])&&d[de][te.options[de]])&&Q.push(te)}for(let te of(ee=Q.length?[]:[f.isXAxis?d.yAxis[0]:d.xAxis[0]],Q))ee.indexOf(te)!==-1||Fl(ee,de=>de.pos===te.pos&&de.len===te.len)||ee.push(te);if(Dt(ie=St(I,f.translate(re||0,void 0,void 0,k.old)))){let te,de=g?ie+f.pos:f.pos+f.len-ie;if(O!=="pass"&&(de<f.pos||de>f.pos+f.len)&&(O?de=Ll(de,f.pos,f.pos+f.len):te=!0),!te){let J=g?"top":"left",pe=g?"height":"width";if(!C&&(f.options[J]||f.options[pe]))Z(de,f[J],f[J]+f[pe]);else for(let ue of ee)Z(de,ue.pos,ue.pos+ue.len)}}k.path=_.length>0?m.crispPolyLine(_,k.lineWidth||1):void 0}}function p(k){if(this.chart.options.isStock){let f;this.is("column")||this.is("columnrange")?f={borderWidth:0,shadow:!1}:this.is("scatter")||this.is("sma")||(f={marker:{enabled:!1,radius:2}}),f&&(k.plotOptions[this.type]=dr(k.plotOptions[this.type],f))}}function j(){let k=this.chart,f=this.options.dataGrouping;return this.allowDG!==!1&&f&&St(f.enabled,k.options.isStock)}function N(k,f){for(let v=0;v<k.length;v+=2){let d=k[v],g=k[v+1];Gs(d[1])&&d[1]===g[1]&&(d[1]=g[1]=Ka(d[1],f)),Gs(d[2])&&d[2]===g[2]&&(d[2]=g[2]=Ka(d[2],f))}return k}u.compose=function(k,f,v,d){let g=v.prototype;g.forceCropping||(Ht(f,"afterDrawCrosshair",t),Ht(f,"afterHideCrosshair",a),Ht(f,"autoLabelAlign",i),Ht(f,"destroy",o),Ht(f,"getPlotLinePath",l),k.prototype.setFixedRange=Il,g.forceCropping=j,Ht(v,"setOptions",p),d.prototype.crispPolyLine=N)},u.stockChart=function(k,f,v){return new u(k,f,v)}}(Ws||(Ws={}));let ei=Ws,{column:{prototype:{pointClass:Pl}}}=dt().seriesTypes,{column:ti}=dt().seriesTypes,{crisp:ri,extend:si,merge:Gl}=S(),{defaultOptions:Ul}=S();class Hs extends ti{extendStem(t,a,i){let o=t[0],l=t[1];typeof o[2]=="number"&&(o[2]=Math.max(i+a,o[2])),typeof l[2]=="number"&&(l[2]=Math.min(i-a,l[2]))}getPointPath(t,a){let i=a.strokeWidth(),o=t.series,l=ri(t.plotX||0,i),p=Math.round(t.shapeArgs.width/2),j=[["M",l,Math.round(t.yBottom)],["L",l,Math.round(t.plotHigh)]];if(t.close!==null){let N=ri(t.plotClose,i);j.push(["M",l,N],["L",l+p,N]),o.extendStem(j,i/2,N)}return j}drawSinglePoint(t){let a=t.series,i=a.chart,o,l=t.graphic;t.plotY!==void 0&&(l||(t.graphic=l=i.renderer.path().add(a.group)),i.styledMode||l.attr(a.pointAttribs(t,t.selected&&"select")),o=a.getPointPath(t,l),l[l?"animate":"attr"]({d:o}).addClass(t.getClassName(),!0))}drawPoints(){this.points.forEach(this.drawSinglePoint)}init(){super.init.apply(this,arguments),this.options.stacking=void 0}pointAttribs(t,a){let i=super.pointAttribs.call(this,t,a);return delete i.fill,i}toYData(t){return[t.high,t.low,t.close]}translate(){let t=this,a=t.yAxis,i=this.pointArrayMap&&this.pointArrayMap.slice()||[],o=i.map(l=>`plot${l.charAt(0).toUpperCase()+l.slice(1)}`);o.push("yBottom"),i.push("low"),super.translate.apply(t),t.points.forEach(function(l){i.forEach(function(p,j){let N=l[p];N!==null&&(t.dataModify&&(N=t.dataModify.modifyValue(N)),l[o[j]]=a.toPixels(N,!0))}),l.tooltipPos[1]=l.plotHigh+a.pos-t.chart.plotTop})}}Hs.defaultOptions=Gl(ti.defaultOptions,{lineWidth:1,tooltip:{pointFormat:'<span style="color:{point.color}"></span> <b> {series.name}</b><br/>{series.chart.options.lang.stockHigh}: {point.high}<br/>{series.chart.options.lang.stockLow}: {point.low}<br/>{series.chart.options.lang.stockClose}: {point.close}<br/>'},threshold:null,states:{hover:{lineWidth:3}},stickyTracking:!0}),si(Hs.prototype,{pointClass:class extends Pl{},animate:null,directTouch:!1,keysAffectYAxis:["low","high"],pointArrayMap:["high","low","close"],pointAttrToOptions:{stroke:"color","stroke-width":"lineWidth"},pointValKey:"close"}),si(Ul.lang,{stockOpen:"Open",stockHigh:"High",stockLow:"Low",stockClose:"Close"}),dt().registerSeriesType("hlc",Hs);let{seriesTypes:{hlc:Wl}}=dt();class Hl extends Wl.prototype.pointClass{getClassName(){return super.getClassName.call(this)+(this.open<this.close?" highcharts-point-up":" highcharts-point-down")}resolveUpColor(){this.open<this.close&&!this.options.color&&this.series.options.upColor&&(this.color=this.series.options.upColor)}resolveColor(){super.resolveColor(),this.series.is("heikinashi")||this.resolveUpColor()}getZone(){let t=super.getZone();return this.resolveUpColor(),t}applyOptions(){return super.applyOptions.apply(this,arguments),this.resolveColor&&this.resolveColor(),this}}let{composed:ql}=S(),{hlc:ai}=dt().seriesTypes,{addEvent:ii,crisp:ni,extend:oi,merge:Vl,pushUnique:Xl}=S();function Yl(u){let t=u.options,a=t.dataGrouping;a&&t.useOhlcData&&t.id!=="highcharts-navigator-series"&&(a.approximation="ohlc")}function Zl(u){let t=u.options;t.useOhlcData&&t.id!=="highcharts-navigator-series"&&oi(this,{pointValKey:qt.prototype.pointValKey,pointArrayMap:qt.prototype.pointArrayMap,toYData:qt.prototype.toYData})}class qt extends ai{static compose(t,...a){Xl(ql,"OHLCSeries")&&(ii(t,"afterSetOptions",Yl),ii(t,"init",Zl))}getPointPath(t,a){let i=super.getPointPath(t,a),o=a.strokeWidth(),l=ni(t.plotX||0,o),p=Math.round(t.shapeArgs.width/2);if(t.open!==null){let j=ni(t.plotOpen,o);i.push(["M",l,j],["L",l-p,j]),super.extendStem(i,o/2,j)}return i}pointAttribs(t,a){let i=super.pointAttribs.call(this,t,a),o=this.options;return delete i.fill,!t.options.color&&o.upColor&&t.open<t.close&&(i.stroke=o.upColor),i}toYData(t){return[t.open,t.high,t.low,t.close]}}qt.defaultOptions=Vl(ai.defaultOptions,{tooltip:{pointFormat:'<span style="color:{point.color}"></span> <b> {series.name}</b><br/>{series.chart.options.lang.stockOpen}: {point.open}<br/>{series.chart.options.lang.stockHigh}: {point.high}<br/>{series.chart.options.lang.stockLow}: {point.low}<br/>{series.chart.options.lang.stockClose}: {point.close}<br/>'}}),oi(qt.prototype,{pointClass:Hl,pointArrayMap:["open","high","low","close"]}),dt().registerSeriesType("ohlc",qt);let{column:Kl,ohlc:qs}=dt().seriesTypes,{crisp:Vs,merge:Jl}=S();class li extends qs{pointAttribs(t,a){let i=Kl.prototype.pointAttribs.call(this,t,a),o=this.options,l=t.open<t.close,p=o.lineColor||this.color,j=t.color||this.color;if(i["stroke-width"]=o.lineWidth,i.fill=t.options.color||l&&o.upColor||j,i.stroke=t.options.lineColor||l&&o.upLineColor||p,a){let N=o.states[a];i.fill=N.color||i.fill,i.stroke=N.lineColor||i.stroke,i["stroke-width"]=N.lineWidth||i["stroke-width"]}return i}drawPoints(){let t=this.points,a=this.chart,i=this.yAxis.reversed;for(let o of t){let l=o.graphic,p,j,N,k,f,v,d,g,m,_=!l;if(o.plotY!==void 0){l||(o.graphic=l=a.renderer.path().add(this.group)),this.chart.styledMode||l.attr(this.pointAttribs(o,o.selected&&"select")).shadow(this.options.shadow);let C=l.strokeWidth();d=Vs(o.plotX||0,C),N=Math.min(p=o.plotOpen,j=o.plotClose),k=Math.max(p,j),m=Math.round(o.shapeArgs.width/2),f=i?k!==o.yBottom:Math.round(N)!==Math.round(o.plotHigh||0),v=i?Math.round(N)!==Math.round(o.plotHigh||0):k!==o.yBottom,N=Vs(N,C),k=Vs(k,C),(g=[]).push(["M",d-m,k],["L",d-m,N],["L",d+m,N],["L",d+m,k],["Z"],["M",d,N],["L",d,f?Math.round(i?o.yBottom:o.plotHigh):N],["M",d,k],["L",d,v?Math.round(i?o.plotHigh:o.yBottom):k]),l[_?"attr":"animate"]({d:g}).addClass(o.getClassName(),!0)}}}}li.defaultOptions=Jl(qs.defaultOptions,{tooltip:qs.defaultOptions.tooltip},{states:{hover:{lineWidth:2}},threshold:null,lineColor:"#000000",lineWidth:1,upColor:"#ffffff",stickyTracking:!0}),dt().registerSeriesType("candlestick",li);let{column:{prototype:{pointClass:Ql}}}=dt().seriesTypes,{isNumber:ed}=S(),td=class extends Ql{constructor(){super(...arguments),this.ttBelow=!1}isValid(){return ed(this.y)||this.y===void 0}hasNewShapeType(){let u=this.options.shape||this.series.options.shape;return this.graphic&&u&&u!==this.graphic.symbolKey}};(function(u){let t=[];function a(o,l,p,j,N){let k=N&&N.anchorX||o,f=N&&N.anchorY||l,v=this.circle(k-1,f-1,2,2);return v.push(["M",k,f],["L",o,l+j],["L",o,l],["L",o+p,l],["L",o+p,l+j],["L",o,l+j],["Z"]),v}function i(o,l){o[l+"pin"]=function(p,j,N,k,f){let v,d=f&&f.anchorX,g=f&&f.anchorY;if(l==="circle"&&k>N&&(p-=Math.round((k-N)/2),N=k),v=o[l](p,j,N,k,f),d&&g){let m=d;if(l==="circle")m=p+N/2;else{let C=v[0],O=v[1];C[0]==="M"&&O[0]==="L"&&(m=(C[1]+O[1])/2)}let _=j>g?j:j+k;v.push(["M",m,_],["L",d,g]),v=v.concat(o.circle(d-1,g-1,2,2))}return v}}u.compose=function(o){if(t.indexOf(o)===-1){t.push(o);let p=o.prototype.symbols;p.flag=a,i(p,"circle"),i(p,"square")}let l=Sa().getRendererType();t.indexOf(l)&&t.push(l)}})(me||(me={}));let rd=me;var sd=ne(448),ad=ne.n(sd),id=ne(820),nd=ne.n(id);let{composed:od}=S(),{prototype:ld}=ad(),{prototype:dd}=nd(),{defined:Xs,pushUnique:cd,stableSort:hd}=S();(function(u){function t(i){return dd.getPlotBox.call(this.options.onSeries&&this.chart.get(this.options.onSeries)||this,i)}function a(){var te,de;ld.translate.apply(this);let i=this,o=i.options,l=i.chart,p=i.points,j=o.onSeries,N=j&&l.get(j),k=N&&N.options.step,f=N&&N.points,v=l.inverted,d=i.xAxis,g=i.yAxis,m=p.length-1,_,C,O=o.onKey||"y",I=f&&f.length,re=0,V,Z,Q,ee,ie;if(N&&N.visible&&I){for(re=(N.pointXOffset||0)+(N.barW||0)/2,ee=N.currentDataGrouping,Z=f[I-1].x+(ee?ee.totalRange:0),hd(p,(J,pe)=>J.x-pe.x),O="plot"+O[0].toUpperCase()+O.substr(1);I--&&p[m];)if(V=f[I],(_=p[m]).y=V.y,V.x<=_.x&&V[O]!==void 0){if(_.x<=Z&&(_.plotY=V[O],V.x<_.x&&!k&&(Q=f[I+1]))&&Q[O]!==void 0)if(Xs(_.plotX)&&N.is("spline")){let J=[V.plotX||0,V.plotY||0],pe=[Q.plotX||0,Q.plotY||0],ue=((te=V.controlPoints)==null?void 0:te.high)||J,Oe=((de=Q.controlPoints)==null?void 0:de.low)||pe,be=(Se,Me)=>Math.pow(1-Se,3)*J[Me]+3*(1-Se)*(1-Se)*Se*ue[Me]+3*(1-Se)*Se*Se*Oe[Me]+Se*Se*Se*pe[Me],_e=0,Ve=1,De;for(let Se=0;Se<100;Se++){let Me=(_e+Ve)/2,ze=be(Me,0);if(ze===null)break;if(.25>Math.abs(ze-_.plotX)){De=Me;break}ze<_.plotX?_e=Me:Ve=Me}Xs(De)&&(_.plotY=be(De,1),_.y=g.toValue(_.plotY,!0))}else ie=(_.x-V.x)/(Q.x-V.x),_.plotY+=ie*(Q[O]-V[O]),_.y+=ie*(Q.y-V.y);if(m--,I++,m<0)break}}p.forEach((J,pe)=>{let ue;J.plotX+=re,(J.plotY===void 0||v)&&(J.plotX>=0&&J.plotX<=d.len?v?(J.plotY=d.translate(J.x,0,1,0,1),J.plotX=Xs(J.y)?g.translate(J.y,0,0,0,1):0):J.plotY=(d.opposite?0:i.yAxis.len)+d.offset:J.shapeArgs={}),(C=p[pe-1])&&C.plotX===J.plotX&&(C.stackIndex===void 0&&(C.stackIndex=0),ue=C.stackIndex+1),J.stackIndex=ue}),this.onSeries=N}u.compose=function(i){if(cd(od,"OnSeries")){let o=i.prototype;o.getPlotBox=t,o.translate=a}return i},u.getPlotBox=t,u.translate=a})(L||(L={}));let ud=L,{noop:pd}=S(),{distribute:md}=S(),{series:di,seriesTypes:{column:ci}}=dt(),{addEvent:gd,defined:fd,extend:xd,isNumber:bd,merge:hi,objectEach:vd,wrap:yd}=S();class cr extends ci{animate(t){t&&this.setClip()}drawPoints(){let t,a,i,o,l,p,j,N,k,f,v,d=this.points,g=this.chart,m=g.renderer,_=g.inverted,C=this.options,O=C.y,I=this.yAxis,re={},V=[],Z=bd(C.borderRadius)?C.borderRadius:0;for(o=d.length;o--;)l=d[o],f=(_?l.plotY:l.plotX)>this.xAxis.len,t=l.plotX,j=l.stackIndex,i=l.options.shape||C.shape,(a=l.plotY)!==void 0&&(a=l.plotY+O-(j!==void 0&&j*C.stackDistance)),l.anchorX=j?void 0:l.plotX,N=j?void 0:l.plotY,v=i!=="flag",p=l.graphic,a!==void 0&&t>=0&&!f?(p&&l.hasNewShapeType()&&(p=p.destroy()),p||(p=l.graphic=m.label("",0,void 0,i,void 0,void 0,C.useHTML).addClass("highcharts-point").add(this.markerGroup),l.graphic.div&&(l.graphic.div.point=l),p.isNew=!0),p.attr({align:v?"center":"left",width:C.width,height:C.height,"text-align":C.textAlign,r:Z}),g.styledMode||p.attr(this.pointAttribs(l)).css(hi(C.style,l.style)).shadow(C.shadow),t>0&&(t-=p.strokeWidth()%2),k={y:a,anchorY:N},C.allowOverlapX&&(k.x=t,k.anchorX=l.anchorX),p.attr({text:l.options.title??C.title??"A"})[p.isNew?"attr":"animate"](k),C.allowOverlapX||(re[l.plotX]?re[l.plotX].size=Math.max(re[l.plotX].size,p.width||0):re[l.plotX]={align:.5*!!v,size:p.width||0,target:t,anchorX:t}),l.tooltipPos=[t,a+I.pos-g.plotTop]):p&&(l.graphic=p.destroy());if(!C.allowOverlapX){let Q=100;for(let ee of(vd(re,function(ie){ie.plotX=ie.anchorX,V.push(ie),Q=Math.max(ie.size,Q)}),md(V,_?I.len:this.xAxis.len,Q),d)){let ie=ee.plotX,te=ee.graphic,de=te&&re[ie];de&&te&&(fd(de.pos)?te[te.isNew?"attr":"animate"]({x:de.pos+(de.align||0)*de.size,anchorX:ee.anchorX}).show().isNew=!1:te.hide().isNew=!0)}}C.useHTML&&this.markerGroup&&yd(this.markerGroup,"on",function(Q){return Ha().prototype.on.apply(Q.apply(this,[].slice.call(arguments,1)),[].slice.call(arguments,1))})}drawTracker(){let t=this.points;for(let a of(super.drawTracker(),t)){let i=a.graphic;i&&(a.unbindMouseOver&&a.unbindMouseOver(),a.unbindMouseOver=gd(i.element,"mouseover",function(){for(let o of(a.stackIndex>0&&!a.raised&&(a._y=i.y,i.attr({y:a._y-8}),a.raised=!0),t))o!==a&&o.raised&&o.graphic&&(o.graphic.attr({y:o._y}),o.raised=!1)}))}}pointAttribs(t,a){let i=this.options,o=t&&t.color||this.color,l=i.lineColor,p=t&&t.lineWidth,j=t&&t.fillColor||i.fillColor;return a&&(j=i.states[a].fillColor,l=i.states[a].lineColor,p=i.states[a].lineWidth),{fill:j||o,stroke:l||o,"stroke-width":p||i.lineWidth||0}}setClip(){di.prototype.setClip.apply(this,arguments),this.options.clip!==!1&&this.sharedClipKey&&this.markerGroup&&this.markerGroup.clip(this.chart.sharedClips[this.sharedClipKey])}}cr.compose=rd.compose,cr.defaultOptions=hi(ci.defaultOptions,{borderRadius:0,pointRange:0,allowOverlapX:!1,shape:"flag",stackDistance:12,textAlign:"center",tooltip:{pointFormat:"{point.text}"},threshold:null,y:-30,fillColor:"#ffffff",lineWidth:1,states:{hover:{lineColor:"#000000",fillColor:"#ccd3ff"}},style:{color:"#000000",fontSize:"0.7em",fontWeight:"bold"}}),ud.compose(cr),xd(cr.prototype,{allowDG:!1,forceCrop:!0,invertible:!1,noSharedTooltip:!0,pointClass:td,sorted:!1,takeOrdinalPosition:!1,trackerGroups:["markerGroup"],buildKDTree:pd,init:di.prototype.init}),dt().registerSeriesType("flags",cr);var wd=ne(184),jd=ne.n(wd);let{addEvent:hr,find:Nd,fireEvent:ui,isArray:kd,isNumber:Qe,pick:is}=S();(function(u){function t(){this.brokenAxis!==void 0&&this.brokenAxis.setBreaks(this.options.breaks,!1)}function a(){var f;Object.keys(((f=this.options.breaks)==null?void 0:f[0])||{}).length&&(this.options.ordinal=!1)}function i(){let f=this.brokenAxis;if(f!=null&&f.hasBreaks){let v=this.tickPositions,d=this.tickPositions.info,g=[];for(let m=0;m<v.length;m++)f.isInAnyBreak(v[m])||g.push(v[m]);this.tickPositions=g,this.tickPositions.info=d}}function o(){this.brokenAxis||(this.brokenAxis=new k(this))}function l(){var _,C;let{isDirty:f,options:{connectNulls:v},points:d,xAxis:g,yAxis:m}=this;if(f){let O=d.length;for(;O--;){let I=d[O],re=(I.y!==null||v!==!1)&&(((_=g==null?void 0:g.brokenAxis)==null?void 0:_.isInAnyBreak(I.x,!0))||((C=m==null?void 0:m.brokenAxis)==null?void 0:C.isInAnyBreak(I.y,!0)));I.visible=!re&&I.options.visible!==!1}}}function p(){this.drawBreaks(this.xAxis,["x"]),this.drawBreaks(this.yAxis,is(this.pointArrayMap,["y"]))}function j(f,v){var O;let d,g,m,_=this,C=_.points;if((O=f==null?void 0:f.brokenAxis)!=null&&O.hasBreaks){let I=f.brokenAxis;v.forEach(function(re){d=(I==null?void 0:I.breakArray)||[],g=f.isXAxis?f.min:is(_.options.threshold,f.min),C.forEach(function(V){m=V["stack"+re.toUpperCase()]??V[re],d.forEach(function(Z){if(Qe(g)&&Qe(m)){let Q="";g<Z.from&&m>Z.to||g>Z.from&&m<Z.from?Q="pointBreak":(g<Z.from&&m>Z.from&&m<Z.to||g>Z.from&&m>Z.to&&m<Z.from)&&(Q="pointInBreak"),Q&&ui(f,Q,{point:V,brk:Z})}})})})}}function N(){let f=this.currentDataGrouping,v=f==null?void 0:f.gapSize,d=this.points.slice(),g=this.yAxis,m=this.options.gapSize,_=d.length-1;if(m&&_>0){let C,O;for(this.options.gapUnit!=="value"&&(m*=this.basePointRange),v&&v>m&&v>=this.basePointRange&&(m=v);_--;)if(O&&O.visible!==!1||(O=d[_+1]),C=d[_],O.visible!==!1&&C.visible!==!1){if(O.x-C.x>m){let I=(C.x+O.x)/2;d.splice(_+1,0,{isNull:!0,x:I}),g.stacking&&this.options.stacking&&((g.stacking.stacks[this.stackKey][I]=new(jd())(g,g.options.stackLabels,!1,I,this.stack)).total=0)}O=C}}return this.getGraphPath(d)}u.compose=function(f,v){if(!f.keepProps.includes("brokenAxis")){f.keepProps.push("brokenAxis"),hr(f,"init",o),hr(f,"afterInit",t),hr(f,"afterSetTickPositions",i),hr(f,"afterSetOptions",a);let d=v.prototype;d.drawBreaks=j,d.gappedPath=N,hr(v,"afterGeneratePoints",l),hr(v,"afterRender",p)}return f};class k{static isInBreak(v,d){let g=v.repeat||1/0,m=v.from,_=v.to-v.from,C=d>=m?(d-m)%g:g-(m-d)%g;return v.inclusive?C<=_:C<_&&C!==0}static lin2Val(v){let d=this.min||0,g=this.brokenAxis,m=g==null?void 0:g.breakArray;if(!(m!=null&&m.length)||!Qe(v))return v;let _=v;if(v>d)for(let C of m){if(C.from>_)break;(C.to<=_&&C.to>d||k.isInBreak(C,_))&&(_+=C.len)}else if(v<d)for(let C of m){if(C.from>d)break;(C.from>=_&&C.from<d||k.isInBreak(C,_))&&(_-=C.len)}return _}static val2Lin(v){let d=this.min||0,g=this.brokenAxis,m=g==null?void 0:g.breakArray;if(!(m!=null&&m.length)||!Qe(v))return v;let _=v;if(v>d)for(let C of m)if(C.to<=v&&C.to>d)_-=C.len;else{if(C.from>v)break;if(k.isInBreak(C,v)){_-=v-C.from;break}}else if(v<d)for(let C of m)if(C.from>=v&&C.from<d)_+=C.len;else{if(C.from>d)break;if(k.isInBreak(C,v)){_+=C.to-v;break}}return _}constructor(v){this.axis=v}findBreakAt(v,d){return Nd(d,function(g){return g.from<v&&v<g.to})}isInAnyBreak(v,d){let g=this.axis,m=g.options.breaks||[],_=m.length,C,O,I;if(_&&Qe(v)){for(;_--;)k.isInBreak(m[_],v)&&(C=!0,O||(O=is(m[_].showPoints,!g.isXAxis)));I=C&&d?C&&!O:C}return I}setBreaks(v,d){let g=this,m=g.axis,_=m.chart.time,C=kd(v)&&!!Object.keys((v==null?void 0:v[0])||{}).length;m.isDirty=(g.hasBreaks??!1)!==C,g.hasBreaks=C,v==null||v.forEach(O=>{O.from=_.parse(O.from)||0,O.to=_.parse(O.to)||0}),v!==m.options.breaks&&(m.options.breaks=m.userOptions.breaks=v),m.forceRedraw=!0,m.series.forEach(function(O){O.isDirty=!0}),C||m.val2lin!==k.val2Lin||(delete m.val2lin,delete m.lin2val),C&&(m.userOptions.ordinal=!1,m.lin2val=k.lin2Val,m.val2lin=k.val2Lin,m.setExtremes=function(O,I,re,V,Z){var Q;if(g.hasBreaks&&!((Q=m.treeGrid)!=null&&Q.tree)){let ee,ie=this.brokenAxis.breakArray||[];for(;ee=g.findBreakAt(O,ie);)O=ee.to;for(;ee=g.findBreakAt(I,ie);)I=ee.from;I<O&&(I=O)}m.constructor.prototype.setExtremes.call(this,O,I,re,V,Z)},m.setAxisTranslation=function(){var O;if(m.constructor.prototype.setAxisTranslation.call(this),g.unitLength=void 0,g.hasBreaks){let I=m.options.breaks||[],re=[],V=[],Z=m.pointRangePadding??0,Q=0,ee,ie,te=m.userMin??m.min,de=m.userMax??m.max,J=m.dataMin??te,pe=m.dataMax??de,ue,Oe;Qe(m.threshold)&&(J=Math.min(J??m.threshold,m.threshold),pe=Math.max(pe??m.threshold,m.threshold)),(O=m.treeGrid)!=null&&O.tree||I.forEach(function(be){ie=be.repeat||1/0,Qe(te)&&Qe(de)&&(k.isInBreak(be,te)&&(te+=be.to%ie-te%ie),k.isInBreak(be,de)&&(de-=de%ie-be.from%ie))}),Qe(J)&&Qe(pe)&&I.forEach(function(be){for(ue=be.from,ie=be.repeat||1/0;ue-ie>J;)ue-=ie;for(;ue<J;)ue+=ie;for(Oe=ue;Oe<pe;Oe+=ie)re.push({value:Oe,move:"in"}),re.push({value:Oe+be.to-be.from,move:"out",size:be.breakSize})}),re.sort(function(be,_e){return be.value===_e.value?(be.move!=="in")-(_e.move!=="in"):be.value-_e.value}),ee=0,ue=J,re.forEach(be=>{(ee+=be.move==="in"?1:-1)===1&&be.move==="in"&&(ue=be.value),ee===0&&Qe(ue)&&(V.push({from:ue,to:be.value,len:be.value-ue-(be.size||0)}),Qe(te)&&Qe(de)&&ue<de&&be.value>te&&(Q+=be.value-ue-(be.size||0)))}),g.breakArray=V,Qe(te)&&Qe(de)&&Qe(m.min)&&(g.unitLength=de-te-Q+Z,ui(m,"afterBreaks"),m.staticScale?m.transA=m.staticScale:g.unitLength&&(m.transA*=(de-m.min+Z)/g.unitLength),Z&&(m.minPixelPadding=m.transA*(m.minPointOffset||0)),m.min=te,m.max=de)}}),is(d,!0)&&m.chart.redraw()}}u.Additions=k})(X||(X={}));let _d=X,zr=S();zr.BrokenAxis=zr.BrokenAxis||_d,zr.BrokenAxis.compose(zr.Axis,zr.Series);let nt={},{arrayMax:Sd,arrayMin:Md,correctFloat:Cd,extend:Ad,isNumber:wt}=S();function pi(u){let t=u.length,a=mi(u);return wt(a)&&t&&(a=Cd(a/t)),a}function mi(u){let t=u.length,a;if(!t&&u.hasNulls)a=null;else if(t)for(a=0;t--;)a+=u[t];return a}let gi={average:pi,averages:function(){let u=[];return[].forEach.call(arguments,function(t){u.push(pi(t))}),u[0]===void 0?void 0:u},close:function(u){return u.length?u[u.length-1]:u.hasNulls?null:void 0},high:function(u){return u.length?Sd(u):u.hasNulls?null:void 0},hlc:function(u,t,a){if(u=nt.high(u),t=nt.low(t),a=nt.close(a),wt(u)||wt(t)||wt(a))return[u,t,a]},low:function(u){return u.length?Md(u):u.hasNulls?null:void 0},ohlc:function(u,t,a,i){if(u=nt.open(u),t=nt.high(t),a=nt.low(a),i=nt.close(i),wt(u)||wt(t)||wt(a)||wt(i))return[u,t,a,i]},open:function(u){return u.length?u[0]:u.hasNulls?null:void 0},range:function(u,t){return u=nt.low(u),t=nt.high(t),wt(u)||wt(t)?[u,t]:u===null&&t===null?null:void 0},sum:mi};Ad(nt,gi);let ur={common:{groupPixelWidth:2,dateTimeLabelFormats:{millisecond:["%[AebHMSL]","%[AebHMSL]","-%[HMSL]"],second:["%[AebHMS]","%[AebHMS]","-%[HMS]"],minute:["%[AebHM]","%[AebHM]","-%[HM]"],hour:["%[AebHM]","%[AebHM]","-%[HM]"],day:["%[AebY]","%[Aeb]","-%[AebY]"],week:["%v %[AebY]","%[Aeb]","-%[AebY]"],month:["%[BY]","%[B]","-%[BY]"],year:["%Y","%Y","-%Y"]}},seriesSpecific:{line:{},spline:{},area:{},areaspline:{},arearange:{},column:{groupPixelWidth:10},columnrange:{groupPixelWidth:10},candlestick:{groupPixelWidth:10},ohlc:{groupPixelWidth:5},hlc:{groupPixelWidth:5},heikinashi:{groupPixelWidth:10}},units:[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1]],["week",[1]],["month",[1,3,6]],["year",null]]},{addEvent:fi,extend:Ed,merge:Rd,pick:xi}=S();function bi(u){let t=this,a=t.series;a.forEach(function(i){i.groupPixelWidth=void 0}),a.forEach(function(i){i.groupPixelWidth=t.getGroupPixelWidth&&t.getGroupPixelWidth(),i.groupPixelWidth&&(i.hasProcessed=!0),i.applyGrouping(!!u.hasExtremesChanged)})}function Td(){let u=this.series,t=u.length,a=0,i=!1,o,l;for(;t--;)(l=u[t].options.dataGrouping)&&(a=Math.max(a,xi(l.groupPixelWidth,ur.common.groupPixelWidth)),o=(u[t].dataTable.modified||u[t].dataTable).rowCount,(u[t].groupPixelWidth||o>this.chart.plotSizeX/a||o&&l.forced)&&(i=!0));return i?a:0}function Dd(){this.series.forEach(function(u){u.hasProcessed=!1})}function Od(u,t){let a;if(t=xi(t,!0),u||(u={forced:!1,units:null}),this instanceof G)for(a=this.series.length;a--;)this.series[a].update({dataGrouping:u},!1);else this.chart.options.series.forEach(function(i){i.dataGrouping=typeof u=="boolean"?u:Rd(u,i.dataGrouping)});this.ordinal&&(this.ordinal.slope=void 0),t&&this.chart.redraw()}let zd={compose:function(u){G=u;let t=u.prototype;t.applyGrouping||(fi(u,"afterSetScale",Dd),fi(u,"postProcessData",bi),Ed(t,{applyGrouping:bi,getGroupPixelWidth:Td,setDataGrouping:Od}))}},{addEvent:Id,getMagnitude:Ld,normalizeTickInterval:Bd,timeUnits:ns}=S();(function(u){function t(){return this.chart.time.getTimeTicks.apply(this.chart.time,arguments)}function a(){if(this.type!=="datetime"){this.dateTime=void 0;return}this.dateTime||(this.dateTime=new i(this))}u.compose=function(o){return o.keepProps.includes("dateTime")||(o.keepProps.push("dateTime"),o.prototype.getTimeTicks=t,Id(o,"afterSetType",a)),o};class i{constructor(l){this.axis=l}normalizeTimeTickInterval(l,p){let j=p||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],N=j[j.length-1],k=ns[N[0]],f=N[1],v;for(v=0;v<j.length&&(k=ns[(N=j[v])[0]],f=N[1],!j[v+1]||!(l<=(k*f[f.length-1]+ns[j[v+1][0]])/2));v++);k===ns.year&&l<5*k&&(f=[1,2,5]);let d=Bd(l/k,f,N[0]==="year"?Math.max(Ld(l/k),1):1);return{unitRange:k,count:d,unitName:N[0]}}getXDateFormat(l,p){let{axis:j}=this,N=j.chart.time;return j.closestPointRange?N.getDateFormat(j.closestPointRange,l,j.options.startOfWeek,p)||N.resolveDTLFormat(p.year).main:N.resolveDTLFormat(p.day).main}}u.Additions=i})(oe||(oe={}));let Fd=oe,{series:{prototype:vi}}=dt(),{addEvent:Ys,defined:Ir,error:yi,extend:$d,isNumber:ft,merge:Zs,pick:Pd,splat:Gd}=S(),Ud=vi.generatePoints;function Wd(u){var t,a,i;let o,l,p=this.chart,j=this.options.dataGrouping,N=this.allowDG!==!1&&j&&Pd(j.enabled,p.options.isStock),k=this.reserveSpace(),f=this.currentDataGrouping,v,d,g=!1;N&&!this.requireSorting&&(this.requireSorting=g=!0);let m=(t=this,a=u,!!(t.isCartesian&&!t.isDirty&&!t.xAxis.isDirty&&!t.yAxis.isDirty&&!a)||!N);if(g&&(this.requireSorting=!1),m)return;this.destroyGroupedData();let _=j.groupAll?this.dataTable:this.dataTable.modified||this.dataTable,C=this.getColumn("x",!j.groupAll),O=p.plotSizeX,I=this.xAxis,re=I.getExtremes(),V=I.options.ordinal,Z=this.groupPixelWidth;if(Z&&C&&_.rowCount&&O&&ft(re.min)){l=!0,this.isDirty=!0,this.points=null;let Q=re.min,ee=re.max,ie=V&&I.ordinal&&I.ordinal.getGroupIntervalFactor(Q,ee,this)||1,te=Z*(ee-Q)/O*ie,de=I.getTimeTicks(Fd.Additions.prototype.normalizeTimeTickInterval(te,j.units||ur.units),Math.min(Q,C[0]),Math.max(ee,C[C.length-1]),I.options.startOfWeek,C,this.closestPointRange),J=vi.groupData.apply(this,[_,de,j.approximation]),pe=J.modified,ue=pe.getColumn("x",!0),Oe=0;for(j!=null&&j.smoothed&&pe.rowCount&&(j.firstAnchor="firstPoint",j.anchor="middle",j.lastAnchor="lastPoint",yi(32,!1,p,{"dataGrouping.smoothed":"use dataGrouping.anchor"})),o=1;o<de.length;o++)de.info.segmentStarts&&de.info.segmentStarts.indexOf(o)!==-1||(Oe=Math.max(de[o]-de[o-1],Oe));(v=de.info).gapSize=Oe,this.closestPointRange=de.info.totalRange,this.groupMap=J.groupMap,this.currentDataGrouping=v,function(be,_e,Ve){let De=be.options.dataGrouping,Se=be.currentDataGrouping&&be.currentDataGrouping.gapSize,Me=be.getColumn("x");if(!(De&&Me.length&&Se&&be.groupMap))return;let ze=_e.length-1,at=De.anchor,Ct=De.firstAnchor,Xe=De.lastAnchor,pr=_e.length-1,ls=0;if(Ct&&Me[0]>=_e[0]){let Ot;ls++;let Ci=be.groupMap[0].start,Ai=be.groupMap[0].length;ft(Ci)&&ft(Ai)&&(Ot=Ci+(Ai-1)),_e[0]={start:_e[0],middle:_e[0]+.5*Se,end:_e[0]+Se,firstPoint:Me[0],lastPoint:Ot&&Me[Ot]}[Ct]}if(ze>0&&Xe&&Se&&_e[ze]>=Ve-Se){pr--;let Ot=be.groupMap[be.groupMap.length-1].start;_e[ze]={start:_e[ze],middle:_e[ze]+.5*Se,end:_e[ze]+Se,firstPoint:Ot&&Me[Ot],lastPoint:Me[Me.length-1]}[Xe]}if(at&&at!=="start"){let Ot=Se*{middle:.5,end:1}[at];for(;pr>=ls;)_e[pr]+=Ot,pr--}}(this,ue||[],ee),k&&ue&&(Ir((i=ue)[0])&&ft(I.min)&&ft(I.dataMin)&&i[0]<I.min&&((!Ir(I.options.min)&&I.min<=I.dataMin||I.min===I.dataMin)&&(I.min=Math.min(i[0],I.min)),I.dataMin=Math.min(i[0],I.dataMin)),Ir(i[i.length-1])&&ft(I.max)&&ft(I.dataMax)&&i[i.length-1]>I.max&&((!Ir(I.options.max)&&ft(I.dataMax)&&I.max>=I.dataMax||I.max===I.dataMax)&&(I.max=Math.max(i[i.length-1],I.max)),I.dataMax=Math.max(i[i.length-1],I.dataMax))),j.groupAll&&(this.allGroupedTable=pe,ue=(pe=(d=this.cropData(pe,I.min||0,I.max||0)).modified).getColumn("x"),this.cropStart=d.start),this.dataTable.modified=pe}else this.groupMap=void 0,this.currentDataGrouping=void 0;this.hasGroupedData=l,this.preventGraphAnimation=(f&&f.totalRange)!==(v&&v.totalRange)}function wi(){this.groupedData&&(this.groupedData.forEach(function(u,t){u&&(this.groupedData[t]=u.destroy?u.destroy():null)},this),this.groupedData.length=0,delete this.allGroupedTable)}function Hd(){Ud.apply(this),this.destroyGroupedData(),this.groupedData=this.hasGroupedData?this.points:null}function qd(){return this.is("arearange")?"range":this.is("ohlc")?"ohlc":this.is("hlc")?"hlc":this.is("column")||this.options.cumulative?"sum":"average"}function ji(u,t,a){let i=u.getColumn("x",!0)||[],o=u.getColumn("y",!0),l=this,p=l.data,j=l.options&&l.options.data,N=[],k=new $a,f=[],v=u.rowCount,d=!!o,g=[],m=l.pointArrayMap,_=m&&m.length,C=["x"].concat(m||["y"]),O=(m||["y"]).map(()=>[]),I=this.options.dataGrouping&&this.options.dataGrouping.groupAll,re,V,Z,Q=0,ee=0,ie=typeof a=="function"?a:a&&nt[a]?nt[a]:nt[l.getDGApproximation&&l.getDGApproximation()||"average"];if(_){let J=m.length;for(;J--;)g.push([])}else g.push([]);let te=_||1;for(let J=0;J<=v;J++)if(!(i[J]<t[0])){for(;t[Q+1]!==void 0&&i[J]>=t[Q+1]||J===v;){if(re=t[Q],l.dataGroupInfo={start:I?ee:l.cropStart+ee,length:g[0].length,groupStart:re},Z=ie.apply(l,g),l.pointClass&&!Ir(l.dataGroupInfo.options)&&(l.dataGroupInfo.options=Zs(l.pointClass.prototype.optionsToObject.call({series:l},l.options.data[l.cropStart+ee])),C.forEach(function(pe){delete l.dataGroupInfo.options[pe]})),Z!==void 0){N.push(re);let pe=Gd(Z);for(let ue=0;ue<pe.length;ue++)O[ue].push(pe[ue]);f.push(l.dataGroupInfo)}ee=J;for(let pe=0;pe<te;pe++)g[pe].length=0,g[pe].hasNulls=!1;if(Q+=1,J===v)break}if(J===v)break;if(m){let pe,ue=I?J:l.cropStart+J,Oe=p&&p[ue]||l.pointClass.prototype.applyOptions.apply({series:l},[j[ue]]);for(let be=0;be<_;be++)ft(pe=Oe[m[be]])?g[be].push(pe):pe===null&&(g[be].hasNulls=!0)}else ft(V=d?o[J]:null)?g[0].push(V):V===null&&(g[0].hasNulls=!0)}let de={x:N};return(m||["y"]).forEach((J,pe)=>{de[J]=O[pe]}),k.setColumns(de),{groupMap:f,modified:k}}function Vd(u){let t=u.options,a=this.type,i=this.chart.options.plotOptions,o=this.useCommonDataGrouping&&ur.common,l=ur.seriesSpecific,p=S().defaultOptions.plotOptions[a].dataGrouping;if(i&&(l[a]||o)){let j=this.chart.rangeSelector;p||(p=Zs(ur.common,l[a])),t.dataGrouping=Zs(o,p,i.series&&i.series.dataGrouping,i[a].dataGrouping,this.userOptions.dataGrouping,!t.isInternal&&j&&ft(j.selected)&&j.buttonOptions[j.selected].dataGrouping)}}let Ni={compose:function(u){let t=u.prototype;t.applyGrouping||(Ys(u.prototype.pointClass,"update",function(){if(this.dataGroup)return yi(24,!1,this.series.chart),!1}),Ys(u,"afterSetOptions",Vd),Ys(u,"destroy",wi),$d(t,{applyGrouping:Wd,destroyGroupedData:wi,generatePoints:Hd,getDGApproximation:qd,groupData:ji}))},groupData:ji},{format:Xd}=Fs(),{composed:Yd}=S(),{addEvent:Zd,extend:Kd,isNumber:Jd,pick:Qd,pushUnique:ec}=S();function tc(u){var C;let t=this.chart,a=t.time,i=u.point,o=i.series,l=o.options,p=o.tooltipOptions,j=l.dataGrouping,N=o.xAxis,k=p.xDateFormat||"",f,v,d,g,m,_=p[u.isFooter?"footerFormat":"headerFormat"];if(N&&N.options.type==="datetime"&&j&&Jd(i.key)){v=o.currentDataGrouping,d=j.dateTimeLabelFormats||ur.common.dateTimeLabelFormats,v?(g=d[v.unitName],v.count===1?k=g[0]:(k=g[1],f=g[2])):!k&&d&&N.dateTime&&(k=N.dateTime.getXDateFormat(i.x,p.dateTimeLabelFormats));let O=Qd((C=o.groupMap)==null?void 0:C[i.index].groupStart,i.key),I=O+((v==null?void 0:v.totalRange)||0)-1;m=a.dateFormat(k,O),f&&(m+=a.dateFormat(f,I)),o.chart.styledMode&&(_=this.styledModeFormat(_)),u.text=Xd(_,{point:Kd(i,{key:m}),series:o},t),u.preventDefault()}}let rc={compose:function(u,t,a){zd.compose(u),Ni.compose(t),a&&ec(Yd,"DataGrouping")&&Zd(a,"headerFormatter",tc)},groupData:Ni.groupData},Mt=S();Mt.dataGrouping=Mt.dataGrouping||{},Mt.dataGrouping.approximationDefaults=Mt.dataGrouping.approximationDefaults||gi,Mt.dataGrouping.approximations=Mt.dataGrouping.approximations||nt,rc.compose(Mt.Axis,Mt.Series,Mt.Tooltip);let{defined:Pp,isNumber:ki,pick:sc}=S(),{addEvent:_i,isObject:ac,pick:ic,defined:nc,merge:oc}=S(),{getAssignedAxis:Si}={getAssignedAxis:function(u){return u.filter(t=>{let a=t.axis.getExtremes(),i=a.min,o=a.max,l=sc(t.axis.minPointOffset,0);return ki(i)&&ki(o)&&t.value>=i-l&&t.value<=o+l&&!t.axis.options.isInternal})[0]}},Mi=[],lc={enabled:!0,sensitivity:1.1},dc=u=>(ac(u)||(u={enabled:u??!0}),oc(lc,u)),cc=function(u,t,a,i,o,l,p){let j=ic(p.type,u.zooming.type,""),N=[];j==="x"?N=a:j==="y"?N=i:j==="xy"&&(N=u.axes);let k=u.transform({axes:N,to:{x:o-5,y:l-5,width:10,height:10},from:{x:o-5*t,y:l-5*t,width:10*t,height:10*t},trigger:"mousewheel"});return k&&(nc(ae)&&clearTimeout(ae),ae=setTimeout(()=>{var f;(f=u.pointer)==null||f.drop()},400)),k};function hc(){let u=dc(this.zooming.mouseWheel);u.enabled&&_i(this.container,"wheel",t=>{var o,l;t=((o=this.pointer)==null?void 0:o.normalize(t))||t;let{pointer:a}=this,i=a&&!a.inClass(t.target,"highcharts-no-mousewheel");if(this.isInsidePlot(t.chartX-this.plotLeft,t.chartY-this.plotTop)&&i){let p=u.sensitivity||1.1,j=t.detail||(t.deltaY||0)/120,N=Si(a.getCoordinates(t).xAxis),k=Si(a.getCoordinates(t).yAxis);cc(this,Math.pow(p,j),N?[N.axis]:this.xAxis,k?[k.axis]:this.yAxis,t.chartX,t.chartY,u)&&((l=t.preventDefault)==null||l.call(t))}})}/**
* @license Highcharts JS v12.4.0 (2025-09-04)
* @module highcharts/modules/mouse-wheel-zoom
* @requires highcharts
*
* Mousewheel zoom module
*
* (c) 2023 Askel Eirik Johansson
*
* License: www.highcharts.com/license
*/let os=S();os.MouseWheelZoom=os.MouseWheelZoom||{compose:function(u){Mi.indexOf(u)===-1&&(Mi.push(u),_i(u,"afterGetContainer",hc))}},os.MouseWheelZoom.compose(os.Chart);let Ee=S();Ee.Navigator=Ee.Navigator||ss,Ee.OrdinalAxis=Ee.OrdinalAxis||Is,Ee.RangeSelector=Ee.RangeSelector||Or,Ee.Scrollbar=Ee.Scrollbar||Gt,Ee.stockChart=Ee.stockChart||ei.stockChart,Ee.StockChart=Ee.StockChart||Ee.stockChart,Ee.extend(Ee.StockChart,ei),Re.compose(Ee.Series,Ee.Axis,Ee.Point),cr.compose(Ee.Renderer),qt.compose(Ee.Series),Ee.Navigator.compose(Ee.Chart,Ee.Axis,Ee.Series),Ee.OrdinalAxis.compose(Ee.Axis,Ee.Series,Ee.Chart),Ee.RangeSelector.compose(Ee.Axis,Ee.Chart),Ee.Scrollbar.compose(Ee.Axis),Ee.StockChart.compose(Ee.Chart,Ee.Axis,Ee.Series,Ee.SVGRenderer);let uc=S();return F.default})())})(uo);var dp=uo.exports;const qi=Cc(dp);try{const r=qi.default||qi;typeof window<"u"&&typeof r=="function"&&r(Nn)}catch(r){console.error("Failed to initialize Highcharts Stock module:",r)}function cp({data:r,onMatchClick:s}){const n=b.useMemo(()=>{const c=[];let y=1500;return r.forEach((x,h)=>{let w=y;const E=x.rating,A=Math.max(w,E)+5,R=Math.min(w,E)-5;x.isReset?c.push({x:h,open:w,high:A,low:R,close:E,color:"#6b7280",lineColor:"#4b5563",upColor:"#6b7280",upLineColor:"#4b5563"}):c.push([h,w,A,R,E]),y=E}),{chart:{type:"candlestick",backgroundColor:"transparent",height:350,spacingBottom:15,spacingTop:10,style:{fontFamily:"Lato, sans-serif"}},credits:{enabled:!1},exporting:{enabled:!0},navigator:{enabled:!1},scrollbar:{enabled:!1},rangeSelector:{enabled:!1},title:null,subtitle:null,xAxis:{type:"linear",title:{text:"Match #",style:{fontSize:"11px",color:"#9ca3af",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.05em"}},labels:{style:{color:"#6b7280",fontSize:"10px"},formatter:function(){return String(this.value+1)}},lineColor:"#374151",tickColor:"#374151",gridLineColor:"#1f2937",gridLineWidth:1,min:r.length>0?0:void 0,max:r.length>0?Math.max(0,r.length-1):void 0,plotLines:[],accessibility:{rangeDescription:"Range: Match 1 to "+r.length}},yAxis:{title:{text:"Rating",style:{fontSize:"11px",color:"#9ca3af",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.05em"}},labels:{style:{color:"#6b7280",fontSize:"10px"}},gridLineColor:"#1f2937",gridLineWidth:1,lineColor:"#374151",opposite:!1,accessibility:{description:"Rating value"}},legend:{enabled:!1},plotOptions:{candlestick:{color:"#ef4444",upColor:"#22c55e",lineColor:"#ef4444",upLineColor:"#22c55e",dataLabels:{enabled:!1}},series:{cursor:"pointer",point:{events:{click:function(){const x=r[this.x];s&&x&&!x.isReset&&s(x.matchId)}}}}},tooltip:{shared:!0,useHTML:!0,backgroundColor:"rgba(15, 20, 30, 0.95)",borderColor:"rgba(234, 179, 8, 0.5)",borderRadius:8,borderWidth:1,shadow:{color:"rgba(0, 0, 0, 0.5)",offsetX:0,offsetY:4,opacity:.5,width:10},style:{color:"#e5e7eb",fontFamily:"Lato, sans-serif"},formatter:function(){var R,T;if(!this.points||this.points.length===0)return"";const x=r[this.x];if(!x)return"";if(x.isReset){let W=1500;for(let $=this.x-1;$>=0;$--)if(r[$]&&!((R=r[$])!=null&&R.isReset)){W=((T=r[$])==null?void 0:T.rating)||1500;break}const q=W-x.rating;return`<div class="p-2 min-w-[200px]">
              <div style="font-family: 'Cinzel', serif; font-weight: bold; color: #9ca3af; text-transform: uppercase; letter-spacing: 1px; border-bottom: 1px solid #4b5563; padding-bottom: 4px; margin-bottom: 4px;"> Season Reset</div>
              <div style="font-size: 12px; color: #d1d5db;">
                <div style="display: flex; justify-content: space-between;"><span>Previous Rating:</span> <b>${W.toFixed(0)}</b></div>
                <div style="display: flex; justify-content: space-between;"><span>Reset to:</span> <b>${x.rating.toFixed(0)}</b></div>
                ${q>0?`<div style="color: #ef4444; font-weight: bold; margin-top: 4px;">Rating Drop: -${q.toFixed(0)}</div>`:""}
                <div style="margin-top: 6px; font-size: 10px; color: #9ca3af; font-style: italic;">New season begins at 1500</div>
              </div>
            </div>`}const h=x.change>=0?"#22c55e":"#ef4444",w=x.change>=0?"+":"",E=x.won?"VICTORY":"DEFEAT",A=x.won?"#22c55e":"#ef4444";return`<div class="p-2 min-w-[200px]">
            <div style="font-family: 'Cinzel', serif; font-weight: bold; color: ${A}; text-transform: uppercase; letter-spacing: 1px; border-bottom: 1px solid ${A}40; padding-bottom: 4px; margin-bottom: 4px;">${E}</div>
            <div style="font-size: 12px; color: #d1d5db;">
              <div style="margin-bottom: 4px;">vs <span style="font-weight: bold; color: #fff;">${x.opponentName}</span></div>
              <div style="display: flex; justify-content: space-between;"><span>Rating:</span> <b>${x.rating.toFixed(0)}</b></div>
              <div style="display: flex; justify-content: space-between; color: ${h};"><span>Change:</span> <b>${w}${x.change.toFixed(1)}</b></div>
              ${x.eventTitle?`<div style="margin-top: 6px; font-size: 10px; color: #ca8a04; border-top: 1px solid #ca8a0440; padding-top: 4px;">${x.eventTitle}</div>`:""}
            </div>
          </div>`}},series:[{name:"Rating Progress",data:c,type:"candlestick"}],responsive:{rules:[{condition:{maxWidth:500},chartOptions:{chart:{height:280},xAxis:{labels:{enabled:!1}},legend:{layout:"vertical",align:"right",verticalAlign:"middle"}}}]}}},[r,s]);return e.jsx("div",{className:"w-full overflow-hidden",children:e.jsx(Tc,{highcharts:Nn,options:n,constructorType:"chart",immutable:!0})})}const Gr=20;function Vi(r,s=0){return r.toLocaleString(void 0,{maximumFractionDigits:s,minimumFractionDigits:s})}function hp(){const{id:r}=wn(),s=r?parseInt(r):NaN,[n,c]=b.useState(1),{openMatch:y}=js(),[x,h]=b.useState([]),{players:w,loading:E}=fs(),[A,R]=b.useState([]),[T,W]=b.useState(!0),[q,$]=b.useState([]),[P,M]=b.useState([]),[G,ae]=b.useState(null),[Y,le]=b.useState(""),he=yn();b.useEffect(()=>{let F=!0;return(async()=>{const fe=await Wr();F&&$(fe)})(),()=>{F=!1}},[]),b.useEffect(()=>{let F=!0;return(async()=>{const fe=await Sr();if(!F)return;M(fe);const S=fe.find(D=>D.status==="active");S&&ae(S.id)})(),()=>{F=!1}},[]),b.useEffect(()=>{let F=!0;return(async()=>{W(!0);const fe=await Ih();F&&(R(fe),W(!1))})(),()=>{F=!1}},[]),b.useEffect(()=>{if(isNaN(s))return;let F=!0;return(async()=>{const fe=await se.from("rating_events").select("*").eq("player_id",s).eq("event_type","match").not("match_id","is",null).order("id",{ascending:!0});F&&!fe.error&&fe.data&&h(fe.data)})(),()=>{F=!1}},[s,A]);const K=b.useMemo(()=>isNaN(s)?void 0:w.find(F=>F.id===s),[w,s]);pt(K?`Player - ${K.name}`:"Player");const me=b.useMemo(()=>{if(!K)return null;const S=[...w.filter(D=>D.has_played_this_season)].sort((D,z)=>(z.rating??0)-(D.rating??0)).findIndex(D=>D.id===K.id);return S>=0?S+1:null},[w,K]),L=b.useMemo(()=>isNaN(s)?[]:A.filter(fe=>fe.player1_id===s||fe.player2_id===s).sort((fe,S)=>S.id-fe.id),[A,s]),X=b.useMemo(()=>{let F=L;if(G!==null&&(F=F.filter(fe=>fe.season_id===G)),Y.trim()){const fe=Y.toLowerCase().trim();F=F.filter(S=>{const D=S.player1_id===s?S.player2_id:S.player1_id,z=w.find(ce=>ce.id===D);return z==null?void 0:z.name.toLowerCase().includes(fe)})}return F},[L,G,Y,s,w]),oe=b.useMemo(()=>{let F=0,fe=0;const S=[];for(const z of L){if(!z.winner_id)continue;const ce=z.winner_id===s,ke=z.player1_id===s,we=ke?z.player2_id:z.player1_id,B=w.find(U=>U.id===we),ge=ke?z.player1_score:z.player2_score,ye=ke?z.player2_score:z.player1_score,xe=ke?z.rating_change_p1:z.rating_change_p2;ce?(F++,S.length<10&&S.push({result:"W",matchId:z.id,opponentName:(B==null?void 0:B.name)||"Unknown",score:`${ge??"?"}-${ye??"?"}`,ratingChange:xe??null})):(fe++,S.length<10&&S.push({result:"L",matchId:z.id,opponentName:(B==null?void 0:B.name)||"Unknown",score:`${ge??"?"}-${ye??"?"}`,ratingChange:xe??null}))}const D=F+fe>0?F/(F+fe)*100:0;return{w:F,l:fe,winRate:D,recentForm:S}},[L,s,w]),Ne=b.useMemo(()=>{if(!K)return[];if(x.length>0){const z=x.filter(B=>B.match_id).map(B=>{let ge="Unknown";if(B.opponent_id){const ye=w.find(xe=>xe.id===B.opponent_id);ge=(ye==null?void 0:ye.name)||`Player ${B.opponent_id}`}return{eventId:B.id,rating:B.rating,change:B.rating_change||0,won:B.result===1,matchId:B.match_id||0,opponentName:ge,eventTitle:null,isReset:!1,seasonId:B.season_id}}),ce=new Map;for(const B of z){const ge=B.matchId?ce.get(B.matchId):void 0;(!ge||ge&&B.eventId>ge.eventId)&&B.matchId&&ce.set(B.matchId,B)}let ke=Array.from(ce.values());if(ke.sort((B,ge)=>B.eventId-ge.eventId),ke.length===0)return[];const we=[];for(let B=0;B<ke.length;B++){const ge=ke[B],ye=B>0?ke[B-1]:null;ye&&ye.seasonId!==ge.seasonId&&we.push({matchNum:we.length+1,rating:1500,change:0,won:!1,matchId:0,opponentName:"Season Reset",eventTitle:null,isReset:!0}),we.push({matchNum:we.length+1,rating:ge.rating,change:ge.change,won:ge.won,matchId:ge.matchId,opponentName:ge.opponentName,eventTitle:ge.eventTitle,isReset:!1})}return we}let F=[...L].reverse();if(F.length===0)return[];let fe=K.rating??1500;for(const z of F){if(!z.winner_id)continue;const ce=z.player1_id===s?z.rating_change_p1||0:z.rating_change_p2||0;fe-=ce}const S=[];let D=fe;return F.forEach((z,ce)=>{if(!z.winner_id)return;const ke=z.player1_id===s?z.rating_change_p1||0:z.rating_change_p2||0,we=z.winner_id===s,B=z.player1_id===s?z.player2_id:z.player1_id,ge=w.find(xe=>xe.id===B),ye=z.event_id?q.find(xe=>xe.id===z.event_id):null;D+=ke,S.push({matchNum:ce+1,rating:D,change:ke,won:we,matchId:z.id,opponentName:(ge==null?void 0:ge.name)||`Player ${B}`,eventTitle:(ye==null?void 0:ye.title)||null,isReset:!1})}),S},[L,s,K,w,q,x]),H=Math.ceil(X.length/Gr),ne=b.useMemo(()=>{const F=(n-1)*Gr,fe=F+Gr;return X.slice(F,fe)},[X,n]);return b.useEffect(()=>{c(1)},[G,Y]),e.jsxs("section",{className:"space-y-8",children:[e.jsx("div",{className:"flex items-center justify-between border-b border-primary/30 pb-4",children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(Ke,{className:"text-sm text-muted-foreground hover:text-primary transition-colors flex items-center gap-1 font-heading uppercase tracking-wider",to:"/players",children:[e.jsx("span",{children:""})," Back to Roster"]})})}),E&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}),!K&&!E&&e.jsx("div",{className:"text-center py-12 text-muted-foreground font-heading text-xl",children:"Player not found."}),K&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative overflow-hidden rounded-lg border border-primary/50 bg-card/80 backdrop-blur-md shadow-[0_0_20px_rgba(0,0,0,0.5)]",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 pointer-events-none",children:e.jsx(Un,{size:200})}),e.jsx("div",{className:"absolute top-0 left-0 w-2 h-full bg-primary/60"}),e.jsxs("div",{className:"p-6 md:p-8 flex flex-col md:flex-row gap-8 items-center md:items-start relative z-10",children:[e.jsxs("div",{className:"shrink-0 relative group",children:[e.jsx("div",{className:"absolute inset-0 bg-primary/30 rounded-full blur-xl opacity-50 group-hover:opacity-80 transition-opacity"}),e.jsx(mt,{name:K.name,twitter:K.twitter,size:128,className:"h-32 w-32 md:h-40 md:w-40 border-4 border-primary/50 shadow-2xl relative z-10"})]}),e.jsxs("div",{className:"flex-1 text-center md:text-left space-y-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-heading font-black text-primary drop-shadow-[0_0_10px_rgba(234,179,8,0.5)] tracking-wide uppercase",children:K.name}),K.twitter&&e.jsxs("a",{href:`https://twitter.com/${K.twitter.replace("@","")}`,target:"_blank",rel:"noopener noreferrer",className:"text-lg text-muted-foreground hover:text-primary transition-colors font-body inline-flex items-center gap-1",children:["@",K.twitter.replace("@","")]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-8 pt-4 border-t border-border/30",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs font-heading uppercase tracking-widest text-muted-foreground",children:"Rating"}),e.jsx("div",{className:"text-3xl font-bold text-foreground",children:Vi(K.rating??0,0)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs font-heading uppercase tracking-widest text-muted-foreground",children:"Rank"}),e.jsxs("div",{className:"text-3xl font-bold text-foreground",children:["#",me??"?"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs font-heading uppercase tracking-widest text-muted-foreground",children:"Win Rate"}),e.jsxs("div",{className:"text-3xl font-bold text-foreground",children:[oe.winRate.toFixed(1),"%",e.jsxs("span",{className:"text-sm font-normal text-muted-foreground ml-1",children:["(",oe.w,"W - ",oe.l,"L)"]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs font-heading uppercase tracking-widest text-muted-foreground",children:"Peak"}),e.jsx("div",{className:"text-3xl font-bold text-foreground",children:Vi(K.peak_rating??0,0)})]})]})]})]}),e.jsx("div",{className:"px-6 pb-6 md:px-8 md:pb-8 relative z-10",children:e.jsx("div",{className:"border-t border-border/30 pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"text-xs font-heading uppercase tracking-widest text-muted-foreground",children:"Badges"})}),e.jsx("div",{className:"flex items-center justify-center py-8 bg-background/40 rounded-lg border border-border/50",children:e.jsx("span",{className:"text-sm text-muted-foreground italic",children:"No badges earned yet."})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"text-xs font-heading uppercase tracking-widest text-muted-foreground",children:"Recent Form"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Last 10 matches"})]}),oe.recentForm.length===0?e.jsx("div",{className:"flex items-center justify-center py-8 bg-background/40 rounded-lg border border-border/50",children:e.jsx("span",{className:"text-sm text-muted-foreground italic",children:"No recent matches recorded."})}):e.jsx("div",{className:"flex flex-wrap gap-1.5",children:oe.recentForm.map((F,fe)=>e.jsxs("div",{className:"relative group",children:[e.jsx("button",{onClick:()=>y(F.matchId),className:`w-14 h-14 rounded border-2 flex items-center justify-center font-bold shadow-md transition-all hover:scale-110 hover:shadow-lg cursor-pointer ${F.result==="W"?"bg-green-500/20 border-green-500/60 text-green-400 hover:bg-green-500/30":"bg-red-500/20 border-red-500/60 text-red-400 hover:bg-red-500/30"}`,children:e.jsx("div",{className:"text-lg font-bold",children:F.result})}),e.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-2 bg-popover border border-border rounded-lg shadow-xl opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-50 whitespace-nowrap",children:[e.jsx("div",{className:"text-xs font-heading font-bold text-foreground",children:F.opponentName}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-0.5",children:["Score: ",e.jsx("span",{className:"font-bold text-foreground",children:F.score})]}),F.ratingChange!==null&&e.jsxs("div",{className:`text-xs font-bold mt-0.5 ${F.ratingChange>=0?"text-green-400":"text-red-400"}`,children:[F.ratingChange>=0?"+":"",Math.round(F.ratingChange)]}),e.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 border-4 border-transparent border-t-border"})]})]},fe))})]})]})})})]}),Ne.length>0&&e.jsxs("div",{className:"relative overflow-hidden rounded-lg border border-primary/30 bg-card/80 backdrop-blur-md shadow-lg",children:[e.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-primary/60"}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10 border border-primary/30",children:e.jsx(gu,{size:20,className:"text-primary"})}),e.jsx("h3",{className:"font-heading uppercase tracking-wider text-lg text-foreground",children:"Rating History"})]}),e.jsx(cp,{data:Ne,onMatchClick:y},s)]})]}),e.jsxs(Fe,{className:"bg-card/50 backdrop-blur-sm border-border/50",children:[e.jsx(Ye,{className:"border-b border-border/30 pb-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(Ze,{className:"font-heading uppercase tracking-wider text-lg flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full"}),"Battle Log"]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[X.length," match",X.length!==1?"es":""]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full md:w-auto",children:[e.jsxs("div",{className:"relative w-full sm:w-48",children:[e.jsx(Gn,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(We,{placeholder:"Search opponent...",value:Y,onChange:F=>le(F.target.value),className:"pl-8 pr-8 h-9"}),Y&&e.jsx("button",{onClick:()=>le(""),className:"absolute right-2 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground hover:text-foreground",children:e.jsx(bs,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"w-full sm:w-48",children:e.jsx(Et,{value:G===null?"all":String(G),onValueChange:F=>{ae(F==="all"?null:parseInt(F,10))},placeholder:"Select season...",searchPlaceholder:"Search seasons...",options:[{value:"all",label:"All seasons"},...P.filter(F=>F.status==="active").map(F=>({value:String(F.id),label:`${F.name} (Active)`})),...P.filter(F=>F.status==="archived").sort((F,fe)=>F.id-fe.id).map(F=>({value:String(F.id),label:`${F.name} (Archived)`}))]})})]})]})}),e.jsxs(Pe,{className:"p-0",children:[e.jsxs("div",{className:"hidden md:grid md:grid-cols-[auto_1fr_100px_80px_100px] gap-4 px-4 py-2 bg-muted/30 border-b border-border/30 text-xs font-heading uppercase tracking-wider text-muted-foreground",children:[e.jsx("div",{className:"w-6"}),e.jsx("div",{children:"Opponent"}),e.jsx("div",{className:"text-center",children:"Score"}),e.jsx("div",{className:"text-right",children:"Rating"}),e.jsx("div",{className:"text-right",children:"Event"})]}),e.jsxs("div",{className:"divide-y divide-border/30",children:[ne.map(F=>{const fe=F.player1_id===s?F.player2_id:F.player1_id,S=w.find(B=>B.id===fe),D=F.winner_id===s,z=F.player1_id===s?F.rating_change_p1:F.rating_change_p2,ce=F.event_id?q.find(B=>B.id===F.event_id):null,ke=F.player1_id===s?F.player1_score??"?":F.player2_score??"?",we=F.player1_id===s?F.player2_score??"?":F.player1_score??"?";return e.jsxs("button",{onClick:()=>y(F.id),className:"w-full text-left hover:bg-muted/30 transition-colors cursor-pointer focus:outline-none focus:bg-muted/30",children:[e.jsxs("div",{className:"hidden md:grid md:grid-cols-[auto_1fr_100px_80px_100px] gap-4 px-4 py-3 items-center",children:[e.jsx("div",{className:`w-6 h-6 rounded flex items-center justify-center text-xs font-bold ${D?"bg-green-500/20 text-green-500":"bg-red-500/20 text-red-500"}`,children:D?"W":"L"}),e.jsx("div",{className:"flex items-center gap-3 min-w-0",children:S?e.jsxs("div",{onClick:B=>{B.stopPropagation(),he(`/players/${fe}`)},className:"flex items-center gap-3 min-w-0 cursor-pointer hover:text-primary transition-colors",children:[e.jsx(mt,{name:S.name,twitter:S.twitter,size:32,className:"h-8 w-8 border border-border shrink-0 hover:border-primary transition-colors"}),e.jsx("span",{className:"font-medium text-sm truncate",children:S.name})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-8 w-8 bg-muted rounded-full shrink-0"}),e.jsx("span",{className:"font-medium text-sm truncate text-muted-foreground",children:"Unknown"})]})}),e.jsxs("div",{className:"text-center font-heading font-bold",children:[e.jsx("span",{className:D?"text-green-500":"text-muted-foreground",children:ke}),e.jsx("span",{className:"text-muted-foreground mx-1",children:"-"}),e.jsx("span",{className:D?"text-muted-foreground":"text-green-500",children:we})]}),e.jsx("div",{className:"text-right text-sm font-bold",children:z!=null?e.jsxs("span",{className:z>=0?"text-green-500":"text-red-500",children:[z>0?"+":"",Math.round(z)]}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx("div",{className:"text-right text-xs text-muted-foreground truncate",title:(ce==null?void 0:ce.title)||`Match #${F.id}`,children:(ce==null?void 0:ce.title)||`#${F.id}`})]}),e.jsx("div",{className:"md:hidden px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded flex items-center justify-center text-xs font-bold shrink-0 ${D?"bg-green-500/20 text-green-500":"bg-red-500/20 text-red-500"}`,children:D?"W":"L"}),S?e.jsxs("div",{onClick:B=>{B.stopPropagation(),he(`/players/${fe}`)},className:"flex items-center gap-3 flex-1 min-w-0 cursor-pointer",children:[e.jsx(mt,{name:S.name,twitter:S.twitter,size:32,className:"h-8 w-8 border border-border shrink-0 hover:border-primary transition-colors"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"font-medium text-sm truncate hover:text-primary transition-colors",children:S.name}),e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:(ce==null?void 0:ce.title)||`Match #${F.id}`})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-8 w-8 bg-muted rounded-full shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm truncate text-muted-foreground",children:"Unknown"}),e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:(ce==null?void 0:ce.title)||`Match #${F.id}`})]})]}),e.jsxs("div",{className:"text-right shrink-0",children:[e.jsxs("div",{className:"font-heading font-bold text-sm",children:[e.jsx("span",{className:D?"text-green-500":"text-muted-foreground",children:ke}),e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsx("span",{className:D?"text-muted-foreground":"text-green-500",children:we})]}),e.jsx("div",{className:"text-xs font-bold",children:z!=null?e.jsxs("span",{className:z>=0?"text-green-500":"text-red-500",children:[z>0?"+":"",Math.round(z)]}):e.jsx("span",{className:"text-muted-foreground",children:"-"})})]})]})})]},F.id)}),ne.length===0&&e.jsx("div",{className:"px-4 py-8 text-center text-muted-foreground text-sm",children:"No matches found for this season."})]}),X.length>Gr&&e.jsx("div",{className:"p-4 border-t border-border/30",children:e.jsx(ma,{currentPage:n,totalPages:H,onPageChange:c,itemsPerPage:Gr,totalItems:X.length})})]})]})]})]})}const po=b.createContext(void 0);function up({children:r}){const[s,n]=b.useState(null),[c,y]=b.useState(!0),[x,h]=b.useState(!1);b.useEffect(()=>{let E=!0;(async()=>{var T;const{data:R}=await se.auth.getSession();if(E){if(n(R.session),(T=R.session)!=null&&T.user){const W=R.session.user.app_metadata;E&&h((W==null?void 0:W.role)==="admin")}else h(!1);y(!1)}})();const{data:A}=se.auth.onAuthStateChange(async(R,T)=>{if(n(T),T!=null&&T.user){const W=T.user.app_metadata;h((W==null?void 0:W.role)==="admin")}else h(!1);T&&window.location.hash.includes("access_token")&&(window.location.hash="#/")});return()=>{E=!1,A.subscription.unsubscribe()}},[]);const w=b.useMemo(()=>({session:s,loading:c,isAdmin:x,async signInWithGithub(){await se.auth.signInWithOAuth({provider:"github",options:{redirectTo:"https://ofc.horseface.no/",skipBrowserRedirect:!1}})},async signInWithTwitter(){await se.auth.signInWithOAuth({provider:"twitter",options:{redirectTo:"https://ofc.horseface.no/",skipBrowserRedirect:!1}})},async signOut(){await se.auth.signOut()}}),[s,c,x]);return e.jsx(po.Provider,{value:w,children:r})}function ya(){const r=b.useContext(po);if(!r)throw new Error("useAuth must be used within AuthProvider");return r}const mo=b.forwardRef(({className:r,...s},n)=>e.jsx(hn,{ref:n,className:je("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...s}));mo.displayName=hn.displayName;const go=b.forwardRef(({className:r,lazy:s=!0,twitterHandle:n,onError:c,...y},x)=>{const[h,w]=b.useState(!1),E=A=>{n&&Ch(n),c==null||c(A)};return e.jsx(un,{ref:x,className:je("aspect-square h-full w-full transition-opacity duration-300",h?"opacity-100":"opacity-0",r),loading:s?"lazy":"eager",onLoad:()=>w(!0),onError:E,...y})});go.displayName=un.displayName;const fo=b.forwardRef(({className:r,...s},n)=>e.jsx(pn,{ref:n,className:je("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...s}));fo.displayName=pn.displayName;function pp(){var ae,Y,le,he,K;pt("Login");const{signInWithGithub:r,signInWithTwitter:s,signOut:n,session:c}=ya(),[y,x]=b.useState(!1),[h,w]=b.useState(""),[E,A]=b.useState(""),[R,T]=b.useState(!1),[W,q]=b.useState(null),$=async me=>{me.preventDefault(),T(!0),q(null);const{error:L}=await se.auth.signInWithPassword({email:h,password:E});L&&q(L.message),T(!1)},P=(Y=(ae=c==null?void 0:c.user)==null?void 0:ae.user_metadata)==null?void 0:Y.avatar_url,M=(he=(le=c==null?void 0:c.user)==null?void 0:le.user_metadata)==null?void 0:he.full_name,G=((K=c==null?void 0:c.user)==null?void 0:K.email)??void 0;return e.jsx("section",{className:"mx-auto max-w-md p-4 pt-20",children:e.jsxs(Fe,{className:"bg-card/80 backdrop-blur-xl border-border/60 shadow-[0_0_50px_rgba(0,0,0,0.5)] overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-primary to-transparent"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-primary/5 via-transparent to-transparent pointer-events-none"}),e.jsxs(Ye,{className:"text-center pb-2 relative z-10",children:[e.jsx(Ze,{className:"font-heading text-3xl font-bold tracking-wide text-primary drop-shadow-md",children:"Welcome Warrior"}),e.jsx(it,{className:"font-body text-lg",children:"Sign in to continue your legend"})]}),e.jsx(Pe,{className:"relative z-10 pt-6",children:c?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-lg bg-background/50 border border-border/40",children:[e.jsxs(mo,{className:"h-16 w-16 border-2 border-primary shadow-[0_0_15px_rgba(var(--primary-rgb),0.3)]",children:[e.jsx(go,{src:P}),e.jsx(fo,{className:"font-heading font-bold text-xl bg-primary/20 text-primary",children:(M==null?void 0:M.slice(0,2).toUpperCase())||(G==null?void 0:G.slice(0,2).toUpperCase())||"U"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-heading font-bold text-xl leading-tight text-foreground",children:M||"Signed in"}),G&&e.jsx("p",{className:"text-sm font-mono text-muted-foreground",children:G})]})]}),e.jsx(Ce,{variant:"secondary",onClick:n,className:"w-full font-heading uppercase tracking-wider font-bold hover:bg-destructive hover:text-destructive-foreground transition-colors",children:"Sign out"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-3",children:[e.jsxs(Ce,{onClick:r,className:"w-full bg-[#24292e] hover:bg-[#24292e]/90 text-white font-bold border border-white/10 shadow-lg transition-all hover:scale-[1.02]",variant:"default",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"mr-2 h-5 w-5",children:e.jsx("path",{d:"M12 .5C5.73.5.9 5.33.9 11.6c0 4.87 3.16 9 7.54 10.45.55.1.76-.24.76-.53 0-.26-.01-1.1-.02-1.99-3.07.67-3.72-1.3-3.72-1.3-.5-1.28-1.22-1.62-1.22-1.62-.99-.67.08-.66.08-.66 1.1.08 1.67 1.13 1.67 1.13.98 1.67 2.58 1.19 3.21.91.1-.71.38-1.19.69-1.46-2.45-.28-5.02-1.23-5.02-5.47 0-1.21.43-2.2 1.13-2.98-.11-.28-.49-1.41.11-2.94 0 0 .92-.3 3.01 1.14A10.5 10.5 0 0 1 12 6.84c.93 0 1.86.13 2.73.38 2.09-1.44 3.01-1.14 3.01-1.14.6 1.53.22 2.66.11 2.94.7.78 1.13 1.77 1.13 2.98 0 4.25-2.58 5.19-5.04 5.46.39.34.73 1.01.73 2.03 0 1.46-.01 2.64-.01 3 0 .29.2.63.77.52A10.72 10.72 0 0 0 23.1 11.6C23.1 5.33 18.27.5 12 .5Z"})}),"Sign in with GitHub"]}),e.jsxs(Ce,{onClick:s,className:"w-full bg-black hover:bg-black/80 text-white font-bold border border-white/10 shadow-lg transition-all hover:scale-[1.02]",variant:"outline",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"mr-2 h-4 w-4",children:e.jsx("path",{d:"M18.244 2H21l-6.356 7.27L22 22h-6.9l-4.8-6.263L4.7 22H2l6.78-7.757L2 2h7l4.3 5.7L18.244 2Zm-2.412 18h2.23L8.258 4H5.9l9.932 16Z"})}),"Sign in with X (Twitter)"]})]}),y?e.jsx("div",{className:"pt-4 border-t border-border/40 animate-in slide-in-from-top-2 fade-in duration-300",children:e.jsxs("form",{onSubmit:$,className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx(We,{type:"email",placeholder:"Email",value:h,onChange:me=>w(me.target.value),required:!0,disabled:R,className:"bg-background/50 border-primary/30 focus:ring-primary/50 font-body"})}),e.jsx("div",{className:"space-y-2",children:e.jsx(We,{type:"password",placeholder:"Password",value:E,onChange:me=>A(me.target.value),required:!0,disabled:R,className:"bg-background/50 border-primary/30 focus:ring-primary/50 font-body"})}),W&&e.jsx("p",{className:"text-xs font-bold text-destructive bg-destructive/10 p-2 rounded border border-destructive/20",children:W}),e.jsx(Ce,{type:"submit",className:"w-full font-heading uppercase tracking-wider font-bold shadow-[0_0_15px_rgba(var(--primary-rgb),0.3)] hover:shadow-[0_0_25px_rgba(var(--primary-rgb),0.5)] transition-all",size:"sm",disabled:R,children:R?"Signing in...":"Sign in with Email"}),e.jsx("button",{type:"button",onClick:()=>x(!1),className:"w-full text-xs text-muted-foreground hover:text-primary transition-colors font-bold uppercase tracking-wider mt-2",children:"Cancel"})]})}):e.jsxs("div",{className:"relative pt-4",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t border-border/40"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("button",{onClick:()=>x(!0),className:"bg-background px-2 text-muted-foreground hover:text-primary transition-colors font-bold tracking-wider",children:"Or continue with email"})})]})]})})]})})}function mp(){return pt("Not Found"),e.jsx("div",{className:"container py-20 flex justify-center",children:e.jsxs("div",{className:"max-w-md w-full bg-card/80 backdrop-blur-xl border border-destructive/60 shadow-[0_0_50px_rgba(239,68,68,0.2)] rounded-lg p-8 text-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-destructive to-transparent"}),e.jsx("h2",{className:"text-4xl font-heading font-bold text-destructive mb-4",children:"404"}),e.jsx("p",{className:"text-xl font-heading font-bold text-foreground mb-2",children:"Page Not Found"}),e.jsx("p",{className:"text-muted-foreground font-body",children:"The stage you are looking for does not exist."}),e.jsx("div",{className:"mt-8",children:e.jsx("a",{href:"/",className:"inline-block px-6 py-2 bg-primary/10 border border-primary/50 text-primary hover:bg-primary hover:text-primary-foreground transition-all duration-300 font-heading font-bold uppercase tracking-wider rounded-sm",children:"Return to Arena"})})]})})}async function xo(r,s="Full recalculation",n){try{const{data:c,error:y}=await se.from("players").select("id, name").order("id");if(y)throw y;if(!c||c.length===0)throw new Error("No players found");let x=se.from("matches").select("id, player1_id, player2_id, winner_id, season_id").not("winner_id","is",null);n!==void 0&&(x=x.eq("season_id",n));const{data:h,error:w}=await x.order("id");if(w)throw w;if(!h||h.length===0){if(n!==void 0){const{error:G}=await se.from("rating_events").delete().eq("season_id",n);G&&console.warn("Failed to delete old rating events:",G)}const M=await Xi(n);return M.success||console.warn("Failed to sync player ratings:",M.error),r==null||r({totalMatches:0,processedMatches:0,currentMatch:0,status:"complete"}),{success:!0,eventsCreated:0}}if(n!==void 0){const{error:M}=await se.from("rating_events").delete().eq("season_id",n);if(M)throw M}const E=await yo(c.map(M=>({id:M.id})),h.map(M=>({id:M.id,player1_id:M.player1_id,player2_id:M.player2_id,winner_id:M.winner_id})),h.length,M=>{const G=h[Math.min(M.processedMatches,h.length-1)];G&&(r==null||r({totalMatches:h.length,processedMatches:M.processedMatches,currentMatch:G.id,status:"running"}))}),A=new Map;h.forEach(M=>{A.set(M.id,M.season_id)});const R=E.map(M=>({...M,reason:null,season_id:A.get(M.match_id)||0})),T=50;for(let M=0;M<R.length;M+=T){const G=R.slice(M,M+T),{error:ae}=await se.from("rating_events").insert(G);if(ae)throw ae;await new Promise(Y=>setTimeout(Y,100))}console.log(" Syncing player ratings from events...");const W=await Xi(n);if(W.success?console.log(" Player ratings synced successfully"):console.warn("Failed to sync player ratings:",W.error),n===0){const M=new Set;if(h.forEach(G=>{M.add(G.player1_id),M.add(G.player2_id)}),M.size>0){const{error:G}=await se.from("players").update({has_played_this_season:!0}).in("id",Array.from(M));G?console.warn("Failed to mark players as having played:",G):console.log(` Marked ${M.size} players as active this season`)}}const q=new Map;R.forEach(M=>{if(!M.match_id)return;const G=q.get(M.match_id)||{},ae=h.find(Y=>Y.id===M.match_id);ae&&(M.player_id===ae.player1_id?G.rating_change_p1=M.rating_change||0:M.player_id===ae.player2_id&&(G.rating_change_p2=M.rating_change||0),q.set(M.match_id,G))});const $=Array.from(q.entries()).map(([M,G])=>({id:M,...G}));let P=0;for(let M=0;M<$.length;M++){const G=$[M];if(!G)continue;const{id:ae,rating_change_p1:Y,rating_change_p2:le}=G,he={};if(Y!==void 0&&(he.rating_change_p1=Y??null),le!==void 0&&(he.rating_change_p2=le??null),Object.keys(he).length===0)continue;const{error:K}=await se.from("matches").update(he).eq("id",ae);K?console.warn(` Failed to update match ${ae}:`,K):P++,M%50===0&&(console.log(`   Updated ${P} / ${$.length} matches`),await new Promise(me=>setTimeout(me,25)))}return console.log(" Matches updated"),r==null||r({totalMatches:h.length,processedMatches:h.length,currentMatch:0,status:"complete"}),console.log(` Recalculation complete! Created ${R.length} match events`),{success:!0,eventsCreated:R.length}}catch(c){return console.error("Rating recalculation failed:",c),r==null||r({totalMatches:0,processedMatches:0,currentMatch:0,status:"error"}),{success:!1,error:c instanceof Error?c.message:String(c),eventsCreated:0}}}async function bo(r){try{r==null||r("Updating ratings..."),console.log(" Clearing existing rating events...");const{error:s}=await se.from("rating_events").delete().eq("season_id",0);if(s)throw console.error("Failed to clear rating events:",s),new Error(`Failed to clear existing ratings: ${s.message}`);console.log(" Cleared all existing rating events"),await new Promise(c=>setTimeout(c,100));const n=await xo(void 0,"Auto-update after match result",0);return n.success&&(r==null||r("Ratings updated successfully")),n}catch(s){return console.error("Failed to update ratings:",s),{success:!1}}}async function wa(r){try{const{data:s,error:n}=await se.from("matches").select("id, player1_id, player2_id, winner_id").eq("id",r).single();if(n||!s)return{canRollback:!1,reason:"Match not found"};if(!s.winner_id)return{canRollback:!1,reason:"Cannot rollback upcoming matches"};const{data:c,error:y}=await se.from("matches").select("id").gt("id",r).not("winner_id","is",null).or(`player1_id.eq.${s.player1_id},player2_id.eq.${s.player1_id}`).limit(1);if(y)return console.error("Error checking player1 matches:",y),{canRollback:!1,reason:"Error checking match history"};const x=c&&c.length>0,{data:h,error:w}=await se.from("matches").select("id").gt("id",r).not("winner_id","is",null).or(`player1_id.eq.${s.player2_id},player2_id.eq.${s.player2_id}`).limit(1);if(w)return console.error("Error checking player2 matches:",w),{canRollback:!1,reason:"Error checking match history"};const E=h&&h.length>0;if(x||E){let A="Cannot rollback: ";return x&&E?A+="both players have played matches afterwards":x?A+="player 1 has played matches afterwards":A+="player 2 has played matches afterwards",{canRollback:!1,reason:A,player1HasLaterMatches:x,player2HasLaterMatches:E}}return{canRollback:!0,player1HasLaterMatches:!1,player2HasLaterMatches:!1}}catch(s){return console.error("Error checking rollback eligibility:",s),{canRollback:!1,reason:s instanceof Error?s.message:"Unknown error"}}}async function vo(r,s){try{s==null||s("Checking if match can be rolled back...");const n=await wa(r);if(!n.canRollback)return{success:!1,error:n.reason||"Cannot rollback this match"};s==null||s("Removing rating events for match...");const{error:c}=await se.from("rating_events").delete().eq("match_id",r);if(c)throw console.error("Failed to delete rating events for match:",c),new Error(`Failed to delete rating events for match: ${c.message}`);s==null||s("Reverting match to upcoming...");const{error:y}=await se.from("matches").update({winner_id:null,player1_score:null,player2_score:null,rating_change_p1:null,rating_change_p2:null}).eq("id",r);if(y)throw console.error("Failed to revert match:",y),new Error(`Failed to revert match: ${y.message}`);console.log(` Reverted match ${r} to upcoming`),s==null||s("Recalculating ratings...");const x=await bo(h=>{s==null||s(h)});return x.success?(s==null||s("Match rolled back successfully (match reverted to upcoming)"),{success:!0}):{success:!1,error:`Match deleted but rating update failed: ${x.error}`}}catch(n){return console.error("Failed to rollback match:",n),{success:!1,error:n instanceof Error?n.message:String(n)}}}async function yo(r,s,n,c){return new Promise((y,x)=>{const h=new Worker(new URL("/assets/ratingWorker-RzEzWG7K.js",import.meta.url),{type:"module"}),w=()=>{h.terminate()};h.onmessage=E=>{const A=E.data;if(A.type==="progress"){c==null||c(A),(A.processedMatches===0||A.processedMatches%50===0)&&console.log(`   Worker processed ${Math.min(A.processedMatches,n)} / ${n} matches`);return}if(A.type==="result"){w(),y(A.events);return}A.type==="error"&&(w(),x(new Error(A.error)))},h.onerror=E=>{w(),x(new Error(E.message||"Worker encountered an error"))},h.postMessage({players:r,matches:s})})}async function Xi(r){try{const{data:s,error:n}=await se.from("players").select("id");if(n||!s)return{success:!1,error:`Failed to fetch players: ${n==null?void 0:n.message}`};const c=[];for(const x of s){let h=se.from("rating_events").select("rating, rd, volatility, created_at, event_type").eq("player_id",x.id);r!==void 0&&(h=h.eq("season_id",r));const{data:w,error:E}=await h.order("id",{ascending:!1});if(E){console.warn(`Failed to fetch events for player ${x.id}:`,E);continue}if(!w||w.length===0)continue;const A=w[0],R=w.filter(q=>q.event_type==="match").length,T=w.reduce((q,$)=>$.rating>((q==null?void 0:q.rating)||0)?$:q,null),W=w.find(q=>q.event_type==="match");c.push({id:x.id,rating:(A==null?void 0:A.rating)??null,rd:(A==null?void 0:A.rd)??null,volatility:(A==null?void 0:A.volatility)??null,matches_played:R,last_match_date:(W==null?void 0:W.created_at)??null,peak_rating:(T==null?void 0:T.rating)??null,peak_rating_date:(T==null?void 0:T.created_at)??null})}const y=20;for(let x=0;x<c.length;x+=y){const h=c.slice(x,x+y);for(const w of h){const{error:E}=await se.from("players").update({rating:w.rating,rd:w.rd,volatility:w.volatility,matches_played:w.matches_played,last_match_date:w.last_match_date,peak_rating:w.peak_rating,peak_rating_date:w.peak_rating_date}).eq("id",w.id);E&&console.warn(`Failed to update player ${w.id}:`,E)}await new Promise(w=>setTimeout(w,50))}return console.log(` Updated ${c.length} players from rating events`),{success:!0}}catch(s){return console.error("Failed to sync player ratings:",s),{success:!1,error:s instanceof Error?s.message:String(s)}}}async function wo(r,s){return bo(s)}async function gp(r,s){try{console.log(` Starting rating calculation for season ${r}...`),s==null||s({totalMatches:0,processedMatches:0,currentMatch:0,status:"running"});const{data:n,error:c}=await se.from("seasons").select("*").eq("id",r).single();if(c||!n)throw new Error(`Season ${r} not found`);console.log(` Found season: ${n.name}`),console.log(` Fetching matches for season ${r}...`);const{data:y,error:x}=await se.from("matches").select("id, player1_id, player2_id, winner_id").eq("season_id",r).not("winner_id","is",null).order("id");if(x)throw x;if(!y||y.length===0)return console.log(" No completed matches found for this season"),{success:!0,eventsCreated:0};console.log(` Found ${y.length} matches`);const h=new Set;y.forEach($=>{h.add($.player1_id),h.add($.player2_id),h.add($.winner_id)});const{data:w,error:E}=await se.from("players").select("id").in("id",Array.from(h));if(E)throw E;if(!w||w.length===0)throw new Error("No players found for this season");console.log(` Processing ${w.length} players`);const{count:A}=await se.from("rating_events").select("*",{count:"exact",head:!0}).eq("season_id",r).eq("event_type","match");if((A||0)>0){console.log(` Found ${A} existing match events for this season - deleting them...`);const{error:$}=await se.from("rating_events").delete().eq("season_id",r).eq("event_type","match");if($)throw $;console.log(" Deleted existing match events")}console.log(` Processing ${y.length} matches with worker...`);const T=(await yo(w.map($=>({id:$.id})),y.map($=>({id:$.id,player1_id:$.player1_id,player2_id:$.player2_id,winner_id:$.winner_id})),y.length,$=>{const P=y[Math.min($.processedMatches,y.length-1)];P&&(s==null||s({totalMatches:y.length,processedMatches:$.processedMatches,currentMatch:P.id,status:"running"}))})).map($=>({...$,season_id:r,reason:null}));console.log(` Worker produced ${T.length} match events`);const W=50;console.log(` Inserting ${T.length} events in batches...`);for(let $=0;$<T.length;$+=W){const P=T.slice($,$+W),M=Math.floor($/W)+1,G=Math.ceil(T.length/W),{error:ae}=await se.from("rating_events").insert(P);if(ae)throw ae;await new Promise(Y=>setTimeout(Y,100))}console.log(" All match events inserted"),console.log(" Creating final snapshots...");const q=[];for(const $ of w){const{data:P}=await se.from("rating_events").select("rating, rd, volatility").eq("player_id",$.id).eq("season_id",r).order("id",{ascending:!1}).limit(1).single();if(P){const M=y.filter(G=>(G.player1_id===$.id||G.player2_id===$.id)&&G.winner_id).length;q.push({season_id:r,player_id:$.id,final_rating:P.rating,final_rd:P.rd,final_volatility:P.volatility,matches_played_count:M,peak_rating:null,peak_rating_date:null,final_rank:null})}}if(q.length>0){q.sort((M,G)=>G.final_rating-M.final_rating);const{count:$}=await se.from("season_player_snapshots").select("*",{count:"exact",head:!0}).eq("season_id",r);if(($||0)>0){console.log(` Deleting ${$} existing snapshots...`);const{error:M}=await se.from("season_player_snapshots").delete().eq("season_id",r);if(M)throw M}const{error:P}=await se.from("season_player_snapshots").insert(q);if(P)throw P;console.log(` Created ${q.length} season snapshots`)}return s==null||s({totalMatches:y.length,processedMatches:y.length,currentMatch:0,status:"complete"}),console.log(` Season ${r} rating calculation complete! Created ${T.length} match events`),{success:!0,eventsCreated:T.length}}catch(n){return console.error(" Season rating calculation failed:",n),s==null||s({totalMatches:0,processedMatches:0,currentMatch:0,status:"error"}),{success:!1,error:n instanceof Error?n.message:String(n),eventsCreated:0}}}const fp=_c,jo=b.forwardRef(({className:r,...s},n)=>e.jsx(mn,{ref:n,className:je("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",r),...s}));jo.displayName=mn.displayName;const Yt=b.forwardRef(({className:r,...s},n)=>e.jsx(gn,{ref:n,className:je("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",r),...s}));Yt.displayName=gn.displayName;const Zt=b.forwardRef(({className:r,...s},n)=>e.jsx(fn,{ref:n,className:je("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...s}));Zt.displayName=fn.displayName;const xp=In("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ge=b.forwardRef(({className:r,...s},n)=>e.jsx(xn,{ref:n,className:je(xp(),r),...s}));Ge.displayName=xn.displayName;const Ns=b.forwardRef(({className:r,...s},n)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:n,className:je("w-full caption-bottom text-sm",r),...s})}));Ns.displayName="Table";const ks=b.forwardRef(({className:r,...s},n)=>e.jsx("thead",{ref:n,className:je("[&_tr]:border-b",r),...s}));ks.displayName="TableHeader";const _s=b.forwardRef(({className:r,...s},n)=>e.jsx("tbody",{ref:n,className:je("[&_tr:last-child]:border-0",r),...s}));_s.displayName="TableBody";const bp=b.forwardRef(({className:r,...s},n)=>e.jsx("tfoot",{ref:n,className:je("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...s}));bp.displayName="TableFooter";const Nt=b.forwardRef(({className:r,...s},n)=>e.jsx("tr",{ref:n,className:je("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...s}));Nt.displayName="TableRow";const rt=b.forwardRef(({className:r,...s},n)=>e.jsx("th",{ref:n,className:je("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",r),...s}));rt.displayName="TableHead";const Ue=b.forwardRef(({className:r,...s},n)=>e.jsx("td",{ref:n,className:je("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",r),...s}));Ue.displayName="TableCell";const vp=b.forwardRef(({className:r,...s},n)=>e.jsx("caption",{ref:n,className:je("mt-4 text-sm text-muted-foreground",r),...s}));vp.displayName="TableCaption";function yp({id:r,title:s,description:n,variant:c="default",onClose:y}){return b.useEffect(()=>{const x=setTimeout(()=>{y()},5e3);return()=>clearTimeout(x)},[y]),e.jsxs("div",{className:je("pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-4 pr-8 shadow-lg transition-all",c==="destructive"&&"border-destructive bg-destructive text-destructive-foreground",c==="success"&&"border-green-500 bg-green-500/10 text-green-600 dark:text-green-400",c==="default"&&"border bg-background"),children:[e.jsxs("div",{className:"grid gap-1",children:[s&&e.jsx("div",{className:"text-sm font-semibold",children:s}),n&&e.jsx("div",{className:"text-sm opacity-90",children:n})]}),e.jsx("button",{onClick:y,className:"absolute right-2 top-2 rounded-md p-1 opacity-70 transition-opacity hover:opacity-100",children:e.jsx(bs,{className:"h-4 w-4"})})]})}function wp({children:r}){return e.jsx("div",{className:"fixed bottom-0 right-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",children:r})}let jp=0,Yi=null,mr=null;function Np(){return mr||(mr=document.createElement("div"),mr.id="toast-container",document.body.appendChild(mr),Yi=kn(mr)),{container:mr,root:Yi}}const ms=new Map;let gs=null;function kp(){const[,r]=b.useReducer(n=>n+1,0);b.useEffect(()=>(gs=r,()=>{gs=null}),[]);const s=n=>{ms.delete(n),r()};return e.jsx(wp,{children:Array.from(ms.entries()).map(([n,c])=>e.jsx(yp,{id:n,...c,onClose:()=>s(n)},n))})}function _p(r){const s=`toast-${++jp}`;ms.set(s,r);const{root:n}=Np();return n.render(e.jsx(kp,{})),{id:s,dismiss:()=>{ms.delete(s),gs&&gs()}}}function Ss(){return{toast:_p}}function Sp(){const{toast:r}=Ss(),[s,n]=b.useState([]),[c,y]=b.useState(!0),[x,h]=b.useState(!1),[w,E]=b.useState(!1),[A,R]=b.useState(null),[T,W]=b.useState({name:"",twitter:""}),[q,$]=b.useState(!1),[P,M]=b.useState(null),[G,ae]=b.useState("");b.useEffect(()=>{Y()},[]);const Y=async(X=!1)=>{X?h(!0):y(!0);const{data:oe,error:Ne}=await se.from("players").select("*").order("name");Ne?(console.error("Error loading players:",Ne),M(Ne.message),r({variant:"destructive",title:"Error loading players",description:Ne.message})):n(oe||[]),y(!1),h(!1)},le=()=>{R(null),W({name:"",twitter:""}),M(null),E(!0)},he=X=>{R(X),W({name:X.name,twitter:X.twitter||""}),M(null),E(!0)},K=async X=>{X.preventDefault(),$(!0),M(null);try{if(A){const{error:oe}=await se.from("players").update({name:T.name,twitter:T.twitter||null}).eq("id",A.id);if(oe)throw oe;r({variant:"success",title:"Player updated",description:`${T.name} has been updated successfully.`})}else{const{error:oe}=await se.from("players").insert({name:T.name,twitter:T.twitter||null,rating:1500,rd:350,volatility:.06});if(oe)throw oe;r({variant:"success",title:"Player created",description:`${T.name} has been created successfully.`})}E(!1),Y(!0)}catch(oe){M(oe.message),r({variant:"destructive",title:"Error",description:oe.message})}finally{$(!1)}},me=async X=>{if(!confirm(`Are you sure you want to delete ${X.name}? This will also delete all their matches.`))return;const{error:oe}=await se.from("players").delete().eq("id",X.id);oe?r({variant:"destructive",title:"Error deleting player",description:oe.message}):(r({variant:"success",title:"Player deleted",description:`${X.name} has been deleted.`}),Y(!0))},L=s.filter(X=>{var oe;return X.name.toLowerCase().includes(G.toLowerCase())||((oe=X.twitter)==null?void 0:oe.toLowerCase().includes(G.toLowerCase()))});return e.jsxs(Fe,{className:"bg-card/50 border-border/50",children:[e.jsx(Ye,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(Ze,{className:"font-heading text-2xl text-primary",children:"Player Management"}),e.jsx(it,{children:"Create, edit, and delete players"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ce,{onClick:()=>Y(!0),variant:"outline",size:"icon",disabled:x,className:"bg-background/50 border-primary/30 hover:bg-primary/20",children:e.jsx(xs,{className:`h-4 w-4 ${x?"animate-spin":""}`})}),e.jsxs(Ce,{onClick:le,className:"font-heading font-bold uppercase tracking-wider",children:[e.jsx(xa,{className:"h-4 w-4 mr-2"}),"New Player"]})]})]})}),e.jsxs(Pe,{className:"space-y-4",children:[e.jsx(We,{placeholder:"Search players...",value:G,onChange:X=>ae(X.target.value),className:"max-w-sm bg-background/50 border-primary/30 focus:ring-primary/50 font-heading font-bold"}),c?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),"Loading..."]}):e.jsx("div",{className:"rounded-md border border-border/40 overflow-hidden",children:e.jsxs(Ns,{children:[e.jsx(ks,{className:"bg-muted/50",children:e.jsxs(Nt,{className:"hover:bg-transparent border-border/40",children:[e.jsx(rt,{className:"font-heading font-bold text-primary",children:"Name"}),e.jsx(rt,{className:"font-heading font-bold text-primary",children:"Twitter"}),e.jsx(rt,{className:"font-heading font-bold text-primary",children:"Rating"}),e.jsx(rt,{className:"font-heading font-bold text-primary",children:"Matches"}),e.jsx(rt,{className:"text-right font-heading font-bold text-primary",children:"Actions"})]})}),e.jsx(_s,{children:L.length===0?e.jsx(Nt,{children:e.jsx(Ue,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No players found"})}):L.map(X=>e.jsxs(Nt,{className:"hover:bg-primary/5 border-border/40 transition-colors",children:[e.jsx(Ue,{className:"font-heading font-bold text-lg",children:X.name}),e.jsx(Ue,{className:"font-mono text-sm text-muted-foreground",children:X.twitter||"-"}),e.jsx(Ue,{className:"font-mono font-bold text-primary",children:Math.round(X.rating??0)}),e.jsx(Ue,{className:"font-mono text-muted-foreground",children:X.matches_played||0}),e.jsxs(Ue,{className:"text-right space-x-2",children:[e.jsx(Ce,{variant:"ghost",size:"sm",onClick:()=>he(X),className:"hover:bg-primary/20 hover:text-primary",children:e.jsx(fa,{className:"h-4 w-4"})}),e.jsx(Ce,{variant:"ghost",size:"sm",onClick:()=>me(X),className:"hover:bg-destructive/20 hover:text-destructive",children:e.jsx(ba,{className:"h-4 w-4"})})]})]},X.id))})]})})]}),e.jsx(Nr,{open:w,onOpenChange:E,children:e.jsxs(Qt,{className:"bg-card/90 backdrop-blur-xl border-primary/20",children:[e.jsxs(er,{children:[e.jsx(tr,{className:"font-heading text-2xl text-primary",children:A?"Edit Player":"Create Player"}),e.jsx(Yr,{children:A?"Update player information":"Add a new player to the system"})]}),e.jsxs("form",{onSubmit:K,children:[e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ge,{htmlFor:"name",className:"font-bold uppercase tracking-wider text-xs",children:"Name *"}),e.jsx(We,{id:"name",value:T.name,onChange:X=>W({...T,name:X.target.value}),required:!0,placeholder:"Player name",className:"bg-background/50 border-primary/30 focus:ring-primary/50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ge,{htmlFor:"twitter",className:"font-bold uppercase tracking-wider text-xs",children:"Twitter Handle"}),e.jsx(We,{id:"twitter",value:T.twitter,onChange:X=>W({...T,twitter:X.target.value}),placeholder:"@username",className:"bg-background/50 border-primary/30 focus:ring-primary/50"})]}),P&&e.jsx("div",{className:"text-sm text-destructive font-bold bg-destructive/10 p-2 rounded border border-destructive/20",children:P})]}),e.jsxs(Xr,{children:[e.jsx(Ce,{type:"button",variant:"ghost",onClick:()=>E(!1),className:"font-bold uppercase tracking-wider",children:"Cancel"}),e.jsx(Ce,{type:"submit",disabled:q,className:"font-heading font-bold uppercase tracking-wider",children:q?"Saving...":A?"Update":"Create"})]})]})]})})]})}const No=b.forwardRef(({className:r,...s},n)=>e.jsx("textarea",{className:je("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",r),ref:n,...s}));No.displayName="Textarea";function Mp(){const{toast:r}=Ss(),[s,n]=b.useState([]),[c,y]=b.useState([]),[x,h]=b.useState(null),[w,E]=b.useState(!0),[A,R]=b.useState(!1),[T,W]=b.useState(!1),[q,$]=b.useState(null),[P,M]=b.useState({title:"",event_date:"",stream_url:"",vod_link:"",description:""}),[G,ae]=b.useState(!1),[Y,le]=b.useState(null);b.useEffect(()=>{K(),he()},[]);const he=async()=>{const H=await Sr();y(H);const ne=H.find(F=>F.status==="active");ne&&h(ne.id)},K=async(H=!1)=>{H?R(!0):E(!0);const{data:ne,error:F}=await se.from("events").select("*").order("event_date",{ascending:!1});F?(console.error("Error loading events:",F),le(F.message),r({variant:"destructive",title:"Error loading events",description:F.message})):n(ne||[]),E(!1),R(!1)},me=()=>{$(null),M({title:"",event_date:"",stream_url:"",vod_link:"",description:""}),le(null),W(!0)},L=H=>{$(H);const ne=new Date(H.event_date).toISOString().slice(0,16);M({title:H.title,event_date:ne,stream_url:H.stream_url||"",vod_link:H.vod_link||"",description:H.description||""}),le(null),W(!0)},X=async H=>{H.preventDefault(),ae(!0),le(null);try{if(!P.event_date)throw new Error("Event date and time are required.");const ne={title:P.title,event_date:new Date(P.event_date).toISOString(),stream_url:P.stream_url||null,vod_link:P.vod_link||null,description:P.description||null};if(q){const{error:F}=await se.from("events").update(ne).eq("id",q.id);if(F)throw F;r({variant:"success",title:"Event updated",description:`${P.title} has been updated successfully.`})}else{const{error:F}=await se.from("events").insert(ne);if(F)throw F;r({variant:"success",title:"Event created",description:`${P.title} has been created successfully.`})}W(!1),K(!0)}catch(ne){le(ne.message),r({variant:"destructive",title:"Error",description:ne.message})}finally{ae(!1)}},oe=async H=>{if(!confirm(`Are you sure you want to delete "${H.title}"? Matches will be kept but unlinked from this event.`))return;const{error:ne}=await se.from("events").delete().eq("id",H.id);ne?r({variant:"destructive",title:"Error deleting event",description:ne.message}):(r({variant:"success",title:"Event deleted",description:`${H.title} has been deleted.`}),K(!0))},Ne=H=>new Date(H).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs(Fe,{className:"bg-card/50 border-border/50",children:[e.jsx(Ye,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(Ze,{className:"font-heading text-2xl text-primary",children:"Event Management"}),e.jsx(it,{children:"Create, edit, and delete events"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ce,{onClick:()=>K(!0),variant:"outline",size:"icon",disabled:A,className:"bg-background/50 border-primary/30 hover:bg-primary/20",children:e.jsx(xs,{className:`h-4 w-4 ${A?"animate-spin":""}`})}),e.jsxs(Ce,{onClick:me,className:"font-heading font-bold uppercase tracking-wider",children:[e.jsx(xa,{className:"h-4 w-4 mr-2"}),"New Event"]})]})]})}),e.jsxs(Pe,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-background/30 p-2 rounded-lg border border-border/30 w-fit",children:[e.jsx("label",{className:"text-sm font-bold uppercase tracking-wider text-muted-foreground px-2",children:"Season:"}),e.jsxs(vs,{value:(x==null?void 0:x.toString())??"",onValueChange:H=>h(parseInt(H)),children:[e.jsx(Hr,{className:"w-48 bg-transparent border-none focus:ring-0 font-heading font-bold text-primary",children:e.jsx(ys,{})}),e.jsxs(qr,{children:[c.filter(H=>H.status==="active").map(H=>e.jsxs(Rt,{value:H.id.toString(),children:[H.name," (Active)"]},H.id)),c.filter(H=>H.status==="archived").sort((H,ne)=>H.id-ne.id).map(H=>e.jsxs(Rt,{value:H.id.toString(),children:[H.name," (Archived)"]},H.id))]})]})]}),w?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),"Loading..."]}):e.jsx("div",{className:"rounded-md border border-border/40 overflow-hidden",children:e.jsxs(Ns,{children:[e.jsx(ks,{className:"bg-muted/50",children:e.jsxs(Nt,{className:"hover:bg-transparent border-border/40",children:[e.jsx(rt,{className:"font-heading font-bold text-primary",children:"Title"}),e.jsx(rt,{className:"font-heading font-bold text-primary",children:"Date"}),e.jsx(rt,{className:"font-heading font-bold text-primary",children:"Description"}),e.jsx(rt,{className:"text-right font-heading font-bold text-primary",children:"Actions"})]})}),e.jsx(_s,{children:s.length===0?e.jsx(Nt,{children:e.jsx(Ue,{colSpan:4,className:"text-center text-muted-foreground py-8",children:"No events found"})}):s.map(H=>e.jsxs(Nt,{className:"hover:bg-primary/5 border-border/40 transition-colors",children:[e.jsx(Ue,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Hh,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"font-heading font-bold",children:H.title})]})}),e.jsx(Ue,{className:"font-mono text-sm text-muted-foreground",children:Ne(H.event_date)}),e.jsx(Ue,{className:"max-w-xs truncate text-muted-foreground italic",children:H.description||"-"}),e.jsxs(Ue,{className:"text-right space-x-2",children:[e.jsx(Ce,{variant:"ghost",size:"sm",onClick:()=>L(H),className:"hover:bg-primary/20 hover:text-primary",children:e.jsx(fa,{className:"h-4 w-4"})}),e.jsx(Ce,{variant:"ghost",size:"sm",onClick:()=>oe(H),className:"hover:bg-destructive/20 hover:text-destructive",children:e.jsx(ba,{className:"h-4 w-4"})})]})]},H.id))})]})})]}),e.jsx(Nr,{open:T,onOpenChange:W,children:e.jsxs(Qt,{className:"max-w-2xl bg-card/90 backdrop-blur-xl border-primary/20",children:[e.jsxs(er,{children:[e.jsx(tr,{className:"font-heading text-2xl text-primary",children:q?"Edit Event":"Create Event"}),e.jsx(Yr,{children:q?"Update event information":"Add a new event to the system"})]}),e.jsxs("form",{onSubmit:X,children:[e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ge,{htmlFor:"title",className:"font-bold uppercase tracking-wider text-xs",children:"Title *"}),e.jsx(We,{id:"title",value:P.title,onChange:H=>M({...P,title:H.target.value}),required:!0,placeholder:"Event title",className:"bg-background/50 border-primary/30 focus:ring-primary/50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ge,{htmlFor:"event_date",className:"font-bold uppercase tracking-wider text-xs",children:"Date & Time *"}),e.jsx("input",{id:"event_date",type:"datetime-local",className:"flex h-9 w-full rounded-md border border-primary/30 bg-background/50 px-3 py-1 text-sm text-foreground shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-primary/50 disabled:cursor-not-allowed disabled:opacity-50 [color-scheme:dark]",value:P.event_date,onChange:H=>M({...P,event_date:H.target.value}),min:new Date().toISOString().slice(0,16),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ge,{htmlFor:"stream_url",className:"font-bold uppercase tracking-wider text-xs",children:"Stream URL"}),e.jsx(We,{id:"stream_url",type:"url",value:P.stream_url,onChange:H=>M({...P,stream_url:H.target.value}),placeholder:"https://twitch.tv/...",className:"bg-background/50 border-primary/30 focus:ring-primary/50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ge,{htmlFor:"vod_link",className:"font-bold uppercase tracking-wider text-xs",children:"VOD Link"}),e.jsx(We,{id:"vod_link",type:"url",value:P.vod_link,onChange:H=>M({...P,vod_link:H.target.value}),placeholder:"https://youtube.com/...",className:"bg-background/50 border-primary/30 focus:ring-primary/50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ge,{htmlFor:"description",className:"font-bold uppercase tracking-wider text-xs",children:"Description"}),e.jsx(No,{id:"description",value:P.description,onChange:H=>M({...P,description:H.target.value}),placeholder:"Event description",rows:3,className:"bg-background/50 border-primary/30 focus:ring-primary/50"})]}),Y&&e.jsx("div",{className:"text-sm text-destructive font-bold bg-destructive/10 p-2 rounded border border-destructive/20",children:Y})]}),e.jsxs(Xr,{children:[e.jsx(Ce,{type:"button",variant:"ghost",onClick:()=>W(!1),className:"font-bold uppercase tracking-wider",children:"Cancel"}),e.jsx(Ce,{type:"submit",disabled:G,className:"font-heading font-bold uppercase tracking-wider",children:G?"Saving...":q?"Update":"Create"})]})]})]})})]})}function Cp(){const{toast:r}=Ss(),[s,n]=b.useState([]),[c,y]=b.useState([]),[x,h]=b.useState([]),[w,E]=b.useState([]),[A,R]=b.useState(null),[T,W]=b.useState(!0),[q,$]=b.useState(!1),[P,M]=b.useState(!1),[G,ae]=b.useState(null),[Y,le]=b.useState({player1_id:"",player2_id:"",winner_id:"",player1_score:"",player2_score:"",event_id:"",match_order:"0",vod_link:""}),[he,K]=b.useState(!1),[me,L]=b.useState(null),[X,oe]=b.useState("all"),[Ne,H]=b.useState(new Map),[ne,F]=b.useState(new Set);b.useEffect(()=>{S(),fe()},[]);const fe=async()=>{const U=await Sr();E(U);const ve=U.find(Re=>Re.status==="active");ve&&R(ve.id)},S=async(U=!1,ve=A)=>{U?$(!0):W(!0);let Re=se.from("matches").select("*").order("id",{ascending:!1}).limit(100);ve!=null&&(Re=Re.eq("season_id",ve));const[Te,Je,He]=await Promise.all([Re,se.from("players").select("*").order("name"),se.from("events").select("*").order("event_date",{ascending:!1})]);Te.error?(console.error("Error loading matches:",Te.error),r({variant:"destructive",title:"Error loading matches",description:Te.error.message})):n(Te.data||[]),Je.error?console.error("Error loading players:",Je.error):y(Je.data||[]),He.error?console.error("Error loading events:",He.error):h(He.data||[]),W(!1),$(!1)};b.useEffect(()=>{A!==null&&S(!1,A)},[A]);const D=U=>{var ve;return((ve=c.find(Re=>Re.id===U))==null?void 0:ve.name)||"Unknown"},z=U=>{var ve;return U?((ve=x.find(Re=>Re.id===U))==null?void 0:ve.title)||"Unknown":"-"},ce=()=>{ae(null),le({player1_id:"",player2_id:"",winner_id:"none",player1_score:"",player2_score:"",event_id:"none",match_order:"0",vod_link:""}),L(null),M(!0)},ke=U=>{ae(U),le({player1_id:String(U.player1_id),player2_id:String(U.player2_id),winner_id:U.winner_id?String(U.winner_id):"none",player1_score:U.player1_score!==void 0&&U.player1_score!==null?String(U.player1_score):"",player2_score:U.player2_score!==void 0&&U.player2_score!==null?String(U.player2_score):"",event_id:U.event_id?String(U.event_id):"none",match_order:U.match_order?String(U.match_order):"0",vod_link:U.vod_link||""}),L(null),M(!0)},we=async U=>{U.preventDefault(),K(!0),L(null);try{if(Y.player1_id===Y.player2_id)throw new Error("Player 1 and Player 2 must be different");if(Y.winner_id&&Y.winner_id!=="none"&&Y.winner_id!==Y.player1_id&&Y.winner_id!==Y.player2_id)throw new Error("Winner must be one of the two players");const ve=Y.winner_id&&Y.winner_id!=="none"?parseInt(Y.winner_id):null,Re=Y.player1_score!==""?parseInt(Y.player1_score):null,Te=Y.player2_score!==""?parseInt(Y.player2_score):null;if((ve!==null||Re!==null||Te!==null)&&(ve===null||Re===null||Te===null))throw new Error("To complete a match, enter both scores and select a winner");const He={player1_id:parseInt(Y.player1_id),player2_id:parseInt(Y.player2_id),winner_id:ve,player1_score:Re,player2_score:Te,event_id:Y.event_id&&Y.event_id!=="none"?parseInt(Y.event_id):null,match_order:Y.match_order?parseInt(Y.match_order):0,vod_link:Y.vod_link||null,season_id:A??0},ht=He.winner_id!==null,Mr=(G==null?void 0:G.winner_id)!==null,Cr=G&&Mr&&ht&&(G.winner_id!==He.winner_id||G.player1_score!==He.player1_score||G.player2_score!==He.player2_score),rr=!G&&ht,Ms=Cr||rr||G&&ht;let sr=null;if(G){const{error:gt}=await se.from("matches").update(He).eq("id",G.id);if(gt)throw gt;ht&&!Mr&&await se.from("players").update({has_played_this_season:!0}).in("id",[He.player1_id,He.player2_id]),r({title:"Match updated",description:ht?"Match updated. Calculating ratings...":"Match has been updated successfully."}),Ms&&(sr=G.id)}else{const{data:gt,error:Zr}=await se.from("matches").insert(He).select();if(Zr)throw Zr;rr&&await se.from("players").update({has_played_this_season:!0}).in("id",[He.player1_id,He.player2_id]),r({title:"Match created",description:rr?"Match created. Calculating ratings...":"Match has been created successfully."}),rr&&gt&&gt[0]&&(sr=gt[0].id)}if(M(!1),S(!0),sr){const gt=await wo(sr);gt.success?(r({variant:"success",title:"Ratings updated",description:"Player ratings have been calculated."}),await S(!0)):r({variant:"destructive",title:"Rating update failed",description:gt.error||"Failed to update ratings."})}}catch(ve){L(ve.message),r({variant:"destructive",title:"Error",description:ve.message})}finally{K(!1)}},B=async U=>{if(!confirm("Are you sure you want to delete this match?"))return;const{error:ve}=await se.from("matches").delete().eq("id",U.id);ve?r({variant:"destructive",title:"Error deleting match",description:ve.message}):(r({variant:"success",title:"Match deleted",description:"Match has been deleted."}),S(!0))},ge=async U=>{F(Re=>new Set(Re).add(U));const ve=await wa(U);return H(Re=>new Map(Re).set(U,ve.canRollback)),F(Re=>{const Te=new Set(Re);return Te.delete(U),Te}),ve},ye=async U=>{const ve=await ge(U.id);if(!ve.canRollback){r({variant:"destructive",title:"Cannot rollback match",description:ve.reason||"This match cannot be rolled back"});return}const Re=D(U.player1_id),Te=D(U.player2_id);if(!confirm(`Rollback match "${Re} vs ${Te}"?

This will revert the match to an upcoming state and recalculate all ratings.`))return;K(!0);const Je=await vo(U.id);Je.success?(r({variant:"success",title:"Match rolled back",description:"The match was reverted to upcoming and ratings have been recalculated."}),S(!0)):r({variant:"destructive",title:"Rollback failed",description:Je.error||"Failed to rollback match"}),K(!1)},xe=X==="all"?s:s.filter(U=>U.event_id===parseInt(X));return e.jsxs(Fe,{className:"bg-card/80 backdrop-blur-md border-border/60 shadow-lg overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-primary/50 to-transparent"}),e.jsx(Ye,{className:"border-b border-border/30 bg-muted/20",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs(Ze,{className:"font-heading uppercase tracking-widest text-xl flex items-center gap-2",children:[e.jsx("span",{className:"text-primary",children:""})," Match Management"]}),e.jsx(it,{className:"font-body",children:"Create, edit, and delete matches"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ce,{onClick:()=>S(!0),variant:"outline",size:"icon",disabled:q,className:"border-primary/30 hover:bg-primary/10 hover:text-primary transition-colors",children:e.jsx(xs,{className:`h-4 w-4 ${q?"animate-spin":""}`})}),e.jsxs(Ce,{onClick:ce,className:"bg-primary text-primary-foreground hover:bg-primary/90 font-heading uppercase tracking-wider font-bold",children:[e.jsx(xa,{className:"h-4 w-4 mr-2"}),"New Match"]})]})]})}),e.jsxs(Pe,{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex gap-4 flex-wrap bg-card/50 p-4 rounded-lg border border-border/30",children:[e.jsxs(vs,{value:(A==null?void 0:A.toString())??"",onValueChange:U=>R(U==="0"?0:parseInt(U,10)),children:[e.jsx(Hr,{className:"w-full sm:w-64 bg-background/50 border-primary/30 focus:ring-primary/50",children:e.jsx(ys,{placeholder:"Select a season"})}),e.jsxs(qr,{children:[w.filter(U=>U.status==="active").map(U=>e.jsxs(Rt,{value:U.id.toString(),children:[U.name," (Active)"]},U.id)),w.filter(U=>U.status==="archived").sort((U,ve)=>U.id-ve.id).map(U=>e.jsxs(Rt,{value:U.id.toString(),children:[U.name," (Archived)"]},U.id))]})]}),e.jsx(Et,{value:X,onValueChange:oe,options:[{value:"all",label:"All Events"},{value:"0",label:"No Event"},...x.map(U=>({value:String(U.id),label:U.title}))],placeholder:"Filter by event",searchPlaceholder:"Search events...",className:"w-[250px]"})]}),T?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):e.jsx("div",{className:"rounded-md border border-border/30 overflow-hidden",children:e.jsxs(Ns,{children:[e.jsx(ks,{className:"bg-muted/30",children:e.jsxs(Nt,{className:"hover:bg-transparent border-b border-border/30",children:[e.jsx(rt,{className:"font-heading uppercase tracking-wider text-xs font-bold text-muted-foreground",children:"Player 1"}),e.jsx(rt,{className:"font-heading uppercase tracking-wider text-xs font-bold text-muted-foreground",children:"Player 2"}),e.jsx(rt,{className:"font-heading uppercase tracking-wider text-xs font-bold text-muted-foreground",children:"Score"}),e.jsx(rt,{className:"font-heading uppercase tracking-wider text-xs font-bold text-muted-foreground",children:"Winner"}),e.jsx(rt,{className:"font-heading uppercase tracking-wider text-xs font-bold text-muted-foreground",children:"Event"}),e.jsx(rt,{className:"text-right font-heading uppercase tracking-wider text-xs font-bold text-muted-foreground",children:"Actions"})]})}),e.jsx(_s,{children:xe.length===0?e.jsx(Nt,{children:e.jsx(Ue,{colSpan:6,className:"text-center text-muted-foreground py-8 italic",children:"No matches found"})}):xe.map(U=>e.jsxs(Nt,{className:"hover:bg-primary/5 transition-colors border-b border-border/20 last:border-0",children:[e.jsx(Ue,{className:"font-medium",children:D(U.player1_id)}),e.jsx(Ue,{className:"font-medium",children:D(U.player2_id)}),e.jsxs(Ue,{className:"font-mono",children:[U.player1_score??"?"," - ",U.player2_score??"?"]}),e.jsx(Ue,{children:U.winner_id?e.jsx("span",{className:"text-green-500 font-bold",children:D(U.winner_id)}):e.jsx("span",{className:"text-muted-foreground italic",children:"Upcoming"})}),e.jsx(Ue,{className:"text-muted-foreground",children:z(U.event_id)}),e.jsxs(Ue,{className:"text-right space-x-2",children:[e.jsx(Ce,{variant:"ghost",size:"sm",onClick:()=>ke(U),className:"hover:text-primary hover:bg-primary/10",children:e.jsx(fa,{className:"h-4 w-4"})}),U.winner_id&&e.jsx(Ce,{variant:"ghost",size:"sm",onClick:()=>ye(U),disabled:he,title:"Rollback match",className:"hover:text-yellow-500 hover:bg-yellow-500/10",children:e.jsx(Wn,{className:"h-4 w-4"})}),e.jsx(Ce,{variant:"ghost",size:"sm",onClick:()=>B(U),className:"hover:text-red-500 hover:bg-red-500/10",children:e.jsx(ba,{className:"h-4 w-4"})})]})]},U.id))})]})})]}),e.jsx(Nr,{open:P,onOpenChange:M,children:e.jsxs(Qt,{className:"max-w-2xl bg-card/95 backdrop-blur-xl border-primary/50",children:[e.jsxs(er,{children:[e.jsx(tr,{className:"font-heading uppercase tracking-widest text-xl text-primary",children:G?"Edit Battle":"New Battle"}),e.jsx(Yr,{children:G?"Update match information":"Add a new match to the system"})]}),e.jsxs("form",{onSubmit:we,children:[e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ge,{htmlFor:"player1_id",className:"font-heading uppercase text-xs tracking-wider",children:"Player 1 *"}),e.jsx(Et,{value:Y.player1_id,onValueChange:U=>le({...Y,player1_id:U}),options:c.map(U=>({value:String(U.id),label:U.name})),placeholder:"Select player 1",searchPlaceholder:"Search players..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ge,{htmlFor:"player2_id",className:"font-heading uppercase text-xs tracking-wider",children:"Player 2 *"}),e.jsx(Et,{value:Y.player2_id,onValueChange:U=>le({...Y,player2_id:U}),options:c.map(U=>({value:String(U.id),label:U.name})),placeholder:"Select player 2",searchPlaceholder:"Search players..."})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ge,{htmlFor:"player1_score",className:"font-heading uppercase text-xs tracking-wider",children:"Player 1 Score"}),e.jsx(We,{id:"player1_score",type:"number",min:"0",value:Y.player1_score,onChange:U=>le({...Y,player1_score:U.target.value}),placeholder:"Leave empty for upcoming",className:"bg-background/50 border-primary/30 focus:ring-primary/50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ge,{htmlFor:"player2_score",className:"font-heading uppercase text-xs tracking-wider",children:"Player 2 Score"}),e.jsx(We,{id:"player2_score",type:"number",min:"0",value:Y.player2_score,onChange:U=>le({...Y,player2_score:U.target.value}),placeholder:"Leave empty for upcoming",className:"bg-background/50 border-primary/30 focus:ring-primary/50"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ge,{htmlFor:"winner_id",className:"font-heading uppercase text-xs tracking-wider",children:"Winner (leave empty for upcoming match)"}),e.jsx(Et,{value:Y.winner_id,onValueChange:U=>le({...Y,winner_id:U}),options:[{value:"none",label:"No winner (upcoming)"},...Y.player1_id?[{value:Y.player1_id,label:D(parseInt(Y.player1_id))}]:[],...Y.player2_id?[{value:Y.player2_id,label:D(parseInt(Y.player2_id))}]:[]],placeholder:"Select winner",searchPlaceholder:"Search..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ge,{htmlFor:"event_id",className:"font-heading uppercase text-xs tracking-wider",children:"Event"}),e.jsx(Et,{value:Y.event_id,onValueChange:U=>le({...Y,event_id:U}),options:[{value:"none",label:"No event"},...x.map(U=>({value:String(U.id),label:U.title}))],placeholder:"Select event",searchPlaceholder:"Search events..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ge,{htmlFor:"match_order",className:"font-heading uppercase text-xs tracking-wider",children:"Match Order"}),e.jsx(We,{id:"match_order",type:"number",min:"0",value:Y.match_order,onChange:U=>le({...Y,match_order:U.target.value}),className:"bg-background/50 border-primary/30 focus:ring-primary/50"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ge,{htmlFor:"vod_link",className:"font-heading uppercase text-xs tracking-wider",children:"VOD Link"}),e.jsx(We,{id:"vod_link",type:"url",value:Y.vod_link,onChange:U=>le({...Y,vod_link:U.target.value}),placeholder:"https://youtube.com/...",className:"bg-background/50 border-primary/30 focus:ring-primary/50"})]}),me&&e.jsx("div",{className:"text-sm text-destructive font-bold",children:me})]}),e.jsxs(Xr,{children:[e.jsx(Ce,{type:"button",variant:"ghost",onClick:()=>M(!1),children:"Cancel"}),e.jsx(Ce,{type:"submit",disabled:he,className:"bg-primary text-primary-foreground hover:bg-primary/90 font-heading uppercase tracking-wider font-bold",children:he?"Saving...":G?"Update":"Create"})]})]})]})})]})}function Ap(){const{toast:r}=Ss(),[s,n]=b.useState([]),[c,y]=b.useState(""),[x,h]=b.useState([]),[w,E]=b.useState([]),[A,R]=b.useState(!1),[T,W]=b.useState(!1),[q,$]=b.useState(!1),[P,M]=b.useState(null),[G,ae]=b.useState({player1_score:"",player2_score:"",winner_id:""}),[Y,le]=b.useState(!1),[he,K]=b.useState(null);b.useEffect(()=>{me(),L()},[]),b.useEffect(()=>{c&&X()},[c]);const me=async()=>{const{data:D,error:z}=await se.from("events").select("*").order("event_date",{ascending:!1});z?(console.error("Error loading events:",z),r({variant:"destructive",title:"Error loading events",description:z.message})):(n(D||[]),D&&D.length>0&&!c&&y(String(D[0].id)))},L=async()=>{const{data:D,error:z}=await se.from("players").select("*").order("name");z?console.error("Error loading players:",z):E(D||[])},X=async(D=!1)=>{if(!c)return;D?W(!0):R(!0);const{data:z,error:ce}=await se.from("matches").select("*").eq("event_id",parseInt(c)).order("match_order");ce?(console.error("Error loading matches:",ce),r({variant:"destructive",title:"Error loading matches",description:ce.message})):h(z||[]),R(!1),W(!1)},oe=D=>{var z;return((z=w.find(ce=>ce.id===D))==null?void 0:z.name)||"Unknown"},Ne=D=>{M(D),ae({player1_score:D.player1_score!==void 0&&D.player1_score!==null?String(D.player1_score):"",player2_score:D.player2_score!==void 0&&D.player2_score!==null?String(D.player2_score):"",winner_id:D.winner_id?String(D.winner_id):""}),K(null),$(!0)},H=async D=>{if(D.preventDefault(),!!P){le(!0),K(null);try{const z=G.player1_score!==""?parseInt(G.player1_score):null,ce=G.player2_score!==""?parseInt(G.player2_score):null,ke=G.winner_id?parseInt(G.winner_id):null,we=z!==null||ce!==null||ke!==null;if(we){if(z===null||ce===null||ke===null)throw new Error("To complete a match, enter both scores and select a winner");if(ke!==P.player1_id&&ke!==P.player2_id)throw new Error("Winner must be one of the two players")}const ge=P.winner_id!==null&&we&&(P.winner_id!==ke||(P.player1_score??null)!==z||(P.player2_score??null)!==ce),{error:ye}=await se.from("matches").update({player1_score:z,player2_score:ce,winner_id:ke}).eq("id",P.id);if(ye)throw ye;if(we&&await se.from("players").update({has_played_this_season:!0}).in("id",[P.player1_id,P.player2_id]),r({title:"Score updated",description:we?"Match updated. Calculating ratings...":"Match kept as upcoming."}),$(!1),X(!0),we){const xe=await wo(P.id);xe.success?(r({variant:"success",title:"Ratings updated",description:"Player ratings have been calculated."}),await X(!0)):r({variant:"destructive",title:"Rating update failed",description:xe.error||"Failed to update ratings."})}}catch(z){K(z.message),r({variant:"destructive",title:"Error",description:z.message})}finally{le(!1)}}},ne=async D=>{const z=await wa(D.id);if(!z.canRollback){r({variant:"destructive",title:"Cannot rollback match",description:z.reason||"This match cannot be rolled back"});return}const ce=oe(D.player1_id),ke=oe(D.player2_id);if(!confirm(`Rollback match "${ce} vs ${ke}"?

This will revert the match to an upcoming state and recalculate all ratings.`))return;le(!0);const we=await vo(D.id);we.success?(r({variant:"success",title:"Match rolled back",description:"The match was reverted to upcoming and ratings have been recalculated."}),X(!0)):r({variant:"destructive",title:"Rollback failed",description:we.error||"Failed to rollback match"}),le(!1)},F=s.find(D=>D.id===parseInt(c)),fe=x.filter(D=>D.winner_id!==null),S=x.filter(D=>D.winner_id===null);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(Fe,{className:"bg-card/50 border-border/50",children:[e.jsx(Ye,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(Ze,{className:"font-heading text-2xl text-primary",children:"Event Dashboard"}),e.jsx(it,{children:"Register scores for matches within an event"})]}),c&&e.jsx(Ce,{onClick:()=>X(!0),variant:"outline",size:"icon",disabled:T,className:"bg-background/50 border-primary/30 hover:bg-primary/20",children:e.jsx(xs,{className:`h-4 w-4 ${T?"animate-spin":""}`})})]})}),e.jsxs(Pe,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ge,{className:"font-bold uppercase tracking-wider text-xs text-muted-foreground",children:"Select Event"}),e.jsx(Et,{value:c,onValueChange:y,options:s.map(D=>({value:String(D.id),label:`${D.title} - ${new Date(D.event_date).toLocaleDateString()}`})),placeholder:"Choose an event",searchPlaceholder:"Search events...",className:"w-full"})]}),F&&e.jsxs("div",{className:"p-4 bg-background/30 rounded-lg border border-border/30",children:[e.jsx("h3",{className:"font-heading font-bold text-xl text-primary mb-2",children:F.title}),e.jsx("p",{className:"text-sm text-muted-foreground font-mono",children:new Date(F.event_date).toLocaleString()}),F.description&&e.jsx("p",{className:"text-sm mt-2 italic text-muted-foreground",children:F.description}),e.jsxs("div",{className:"flex gap-4 mt-3 text-sm font-bold uppercase tracking-wider",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bi,{className:"h-4 w-4 text-green-500"}),e.jsxs("span",{children:[fe.length," completed"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fi,{className:"h-4 w-4 text-orange-500"}),e.jsxs("span",{children:[S.length," upcoming"]})]})]})]})]})]}),c&&!A&&e.jsxs(e.Fragment,{children:[S.length>0&&e.jsxs(Fe,{className:"bg-card/50 border-border/50",children:[e.jsxs(Ye,{children:[e.jsxs(Ze,{className:"flex items-center gap-2 font-heading text-xl text-orange-500",children:[e.jsx(Fi,{className:"h-5 w-5"}),"Upcoming Matches"]}),e.jsx(it,{children:"Click to register scores"})]}),e.jsx(Pe,{children:e.jsx("div",{className:"space-y-3",children:S.map(D=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-border/40 rounded-lg hover:bg-primary/5 hover:border-primary/30 cursor-pointer transition-all group",onClick:()=>Ne(D),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground font-mono bg-background/50 px-2 py-1 rounded",children:["#",D.match_order||0]}),e.jsxs("div",{className:"font-heading font-bold text-lg group-hover:text-primary transition-colors",children:[oe(D.player1_id)," ",e.jsx("span",{className:"text-muted-foreground text-sm mx-1",children:"VS"})," ",oe(D.player2_id)]})]}),e.jsx(Ce,{size:"sm",variant:"outline",className:"font-bold uppercase tracking-wider text-xs bg-background/50 border-primary/30 group-hover:bg-primary group-hover:text-primary-foreground",children:"Register Score"})]},D.id))})})]}),fe.length>0&&e.jsxs(Fe,{className:"bg-card/50 border-border/50",children:[e.jsxs(Ye,{children:[e.jsxs(Ze,{className:"flex items-center gap-2 font-heading text-xl text-green-500",children:[e.jsx(Bi,{className:"h-5 w-5"}),"Completed Matches"]}),e.jsx(it,{children:"Click to edit scores"})]}),e.jsx(Pe,{children:e.jsx("div",{className:"space-y-3",children:fe.map(D=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-border/40 rounded-lg hover:bg-primary/5 hover:border-primary/30 transition-all group",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1 cursor-pointer",onClick:()=>Ne(D),children:[e.jsxs("div",{className:"text-sm text-muted-foreground font-mono bg-background/50 px-2 py-1 rounded",children:["#",D.match_order||0]}),e.jsxs("div",{className:"flex items-center gap-4 font-heading text-lg",children:[e.jsx("span",{className:`${D.winner_id===D.player1_id?"text-primary font-bold drop-shadow-[0_0_5px_rgba(var(--primary-rgb),0.5)]":"text-muted-foreground"}`,children:oe(D.player1_id)}),e.jsxs("span",{className:"text-muted-foreground font-mono text-sm bg-background/30 px-2 py-1 rounded border border-border/30",children:[D.player1_score??"?"," - ",D.player2_score??"?"]}),e.jsx("span",{className:`${D.winner_id===D.player2_id?"text-primary font-bold drop-shadow-[0_0_5px_rgba(var(--primary-rgb),0.5)]":"text-muted-foreground"}`,children:oe(D.player2_id)})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-yellow-500/10 px-3 py-1 rounded-full border border-yellow-500/20",children:[e.jsx(Un,{className:"h-3 w-3 text-yellow-500"}),e.jsx("span",{className:"font-bold text-sm text-yellow-500 uppercase tracking-wider",children:oe(D.winner_id)})]}),e.jsx(Ce,{size:"sm",variant:"ghost",onClick:z=>{z.stopPropagation(),ne(D)},disabled:Y,title:"Rollback match (only if both players have no matches afterwards)",className:"hover:bg-destructive/20 hover:text-destructive",children:e.jsx(Wn,{className:"h-4 w-4"})})]})]},D.id))})})]}),x.length===0&&e.jsx(Fe,{className:"bg-card/50 border-border/50",children:e.jsx(Pe,{className:"py-12 text-center text-muted-foreground italic",children:"No matches found for this event. Create matches in the Match Management section."})})]}),A&&e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),"Loading matches..."]}),e.jsx(Nr,{open:q,onOpenChange:$,children:e.jsxs(Qt,{className:"bg-card/90 backdrop-blur-xl border-primary/20",children:[e.jsxs(er,{children:[e.jsx(tr,{className:"font-heading text-2xl text-primary",children:"Register Match Score"}),e.jsx(Yr,{children:P&&e.jsxs("span",{className:"font-heading font-bold text-lg text-foreground",children:[oe(P.player1_id)," ",e.jsx("span",{className:"text-muted-foreground text-sm mx-1",children:"VS"})," ",oe(P.player2_id)]})})]}),P&&e.jsxs("form",{onSubmit:H,children:[e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Ge,{className:"font-bold uppercase tracking-wider text-xs",children:[oe(P.player1_id)," Score *"]}),e.jsx(We,{type:"number",min:"0",value:G.player1_score,onChange:D=>ae({...G,player1_score:D.target.value}),className:"bg-background/50 border-primary/30 focus:ring-primary/50 text-center font-mono text-lg font-bold"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Ge,{className:"font-bold uppercase tracking-wider text-xs",children:[oe(P.player2_id)," Score *"]}),e.jsx(We,{type:"number",min:"0",value:G.player2_score,onChange:D=>ae({...G,player2_score:D.target.value}),className:"bg-background/50 border-primary/30 focus:ring-primary/50 text-center font-mono text-lg font-bold"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ge,{className:"font-bold uppercase tracking-wider text-xs",children:"Winner *"}),e.jsx(Et,{value:G.winner_id,onValueChange:D=>ae({...G,winner_id:D}),options:[{value:String(P.player1_id),label:oe(P.player1_id)},{value:String(P.player2_id),label:oe(P.player2_id)}],placeholder:"Select winner",searchPlaceholder:"Search players...",className:"w-full"})]}),he&&e.jsx("div",{className:"text-sm text-destructive font-bold bg-destructive/10 p-2 rounded border border-destructive/20",children:he})]}),e.jsxs(Xr,{children:[e.jsx(Ce,{type:"button",variant:"ghost",onClick:()=>$(!1),className:"font-bold uppercase tracking-wider",children:"Cancel"}),e.jsx(Ce,{type:"submit",disabled:Y,className:"font-heading font-bold uppercase tracking-wider",children:Y?"Saving...":"Save Score"})]})]})]})})]})}function Ep(){pt("Admin");const{session:r,isAdmin:s,loading:n}=ya(),[c,y]=b.useState(null),[x,h]=b.useState([]),[w,E]=b.useState(!0),[A,R]=b.useState("Season Complete"),[T,W]=b.useState(!1),[q,$]=b.useState(null),[P,M]=b.useState(null),[G,ae]=b.useState(!1),[Y,le]=b.useState(null),[he,K]=b.useState(null),[me,L]=b.useState({totalMatches:0,processedMatches:0,currentMatch:0,status:"idle"}),[X,oe]=b.useState(null);b.useEffect(()=>{Ne()},[]);const Ne=async()=>{E(!0);try{const S=await ju(),D=await Sr();y(S),h(D)}catch(S){console.error("Failed to load seasons:",S)}finally{E(!1)}},H=async()=>{if(!c){alert("No active season found");return}const S=`Season ${x.filter(ce=>ce.status==="archived").length+1}`,D=` Archive "${c.name}" and start "${S}"?

This will:
 Create snapshots of all current player standings
 Mark current season as archived
 Reset all players' ratings
 Create a new active season

This action cannot be undone!`;if(!confirm(D))return;W(!0),$(null);const z=await Nu(S,ce=>{console.log("Archive progress:",ce)});$(z),W(!1),z.success&&await Ne()},ne=async S=>{const D=x.find(ke=>ke.id===S);if(!D){alert("Season not found");return}const z=` Restore "${D.name}" as the active season?

This will:
 Archive the current active season with all its matches
 Restore player ratings from ${D.name}'s snapshots
 Make ${D.name} the current active season for new matches

This action cannot be undone!`;if(!confirm(z))return;M(S),ae(!0),le(null);const ce=await _u(S,ke=>{console.log("Activate progress:",ke)});le(ce),ae(!1),ce.success&&await Ne()},F=async S=>{const D=x.find(we=>we.id===S);if(!D){alert("Season not found");return}const z=S===0,ce=z?` Recalculate ratings for "${D.name}"?

This will:
 Recalculate all matches in the current season
 Update player ratings and standings
 Preserve all match history

Existing rating data will be recalculated. Continue?`:` Calculate ratings for "${D.name}"?

This will:
 Create rating events from scratch for all matches in this season
 Calculate final player ratings and standings
 Create snapshots of the final leaderboard
 Recalculate all rating changes for matches

Existing rating data will be recalculated. Continue?`;if(!confirm(ce))return;K(S),L({totalMatches:0,processedMatches:0,currentMatch:0,status:"running"}),oe(null);const ke=z?await xo(we=>{L(we)},"Recalculate active season",0):await gp(S,we=>{L(we)});oe(ke)},fe=()=>me.totalMatches===0?0:Math.round(me.processedMatches/me.totalMatches*100);return n?e.jsx("div",{className:"container py-8",children:e.jsx("div",{className:"text-center",children:"Loading..."})}):r?s?e.jsxs("div",{className:"container py-8 space-y-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-heading font-bold text-transparent bg-clip-text bg-gradient-to-r from-primary via-primary/80 to-primary/50 drop-shadow-sm",children:"Admin Dashboard"}),e.jsx("p",{className:"text-muted-foreground font-body text-lg",children:"Manage the arena and its combatants."})]}),e.jsxs(fp,{defaultValue:"dashboard",className:"space-y-6",children:[e.jsxs(jo,{className:"bg-card/40 backdrop-blur-sm border border-border/40 p-1 h-auto flex-wrap justify-start gap-2",children:[e.jsx(Yt,{value:"dashboard",className:"font-heading font-bold uppercase tracking-wider data-[state=active]:bg-primary data-[state=active]:text-primary-foreground transition-all",children:"Event Dashboard"}),e.jsx(Yt,{value:"events",className:"font-heading font-bold uppercase tracking-wider data-[state=active]:bg-primary data-[state=active]:text-primary-foreground transition-all",children:"Events"}),e.jsx(Yt,{value:"matches",className:"font-heading font-bold uppercase tracking-wider data-[state=active]:bg-primary data-[state=active]:text-primary-foreground transition-all",children:"Matches"}),e.jsx(Yt,{value:"players",className:"font-heading font-bold uppercase tracking-wider data-[state=active]:bg-primary data-[state=active]:text-primary-foreground transition-all",children:"Players"}),e.jsx(Yt,{value:"seasons",className:"font-heading font-bold uppercase tracking-wider data-[state=active]:bg-primary data-[state=active]:text-primary-foreground transition-all",children:"Seasons"}),e.jsx(Yt,{value:"tools",className:"font-heading font-bold uppercase tracking-wider data-[state=active]:bg-primary data-[state=active]:text-primary-foreground transition-all",children:"Tools"})]}),e.jsxs("div",{className:"bg-card/30 backdrop-blur-md border border-border/40 rounded-lg p-6 shadow-xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-primary/50 to-transparent"}),e.jsx(Zt,{value:"dashboard",className:"m-0",children:e.jsx(Ap,{})}),e.jsx(Zt,{value:"events",className:"m-0",children:e.jsx(Mp,{})}),e.jsx(Zt,{value:"matches",className:"m-0",children:e.jsx(Cp,{})}),e.jsx(Zt,{value:"players",className:"m-0",children:e.jsx(Sp,{})}),e.jsxs(Zt,{value:"seasons",className:"space-y-6 m-0",children:[e.jsxs(Fe,{className:"bg-card/50 border-border/50",children:[e.jsxs(Ye,{children:[e.jsx(Ze,{className:"font-heading text-2xl text-primary",children:"Active Season"}),e.jsx(it,{children:"Current season where matches are being recorded"})]}),e.jsx(Pe,{className:"space-y-4",children:w?e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading..."}):c?e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"p-4 bg-primary/10 border border-primary/20 rounded-lg flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-heading font-bold text-primary",children:c.name}),e.jsxs("p",{className:"text-xs text-muted-foreground uppercase tracking-wider font-bold",children:["Started: ",new Date(c.start_date).toLocaleDateString()]})]}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.5)] animate-pulse"})]})}):e.jsx("p",{className:"text-sm text-destructive font-bold",children:"No active season found!"})})]}),e.jsxs(Fe,{className:"border-amber-500/30 bg-amber-500/5",children:[e.jsxs(Ye,{children:[e.jsxs(Ze,{className:"flex items-center gap-2 font-heading text-xl text-amber-500",children:[e.jsx(Qh,{className:"h-5 w-5"}),"Archive Season & Start New"]}),e.jsx(it,{children:"End the current season, create snapshots, and reset for a new season"})]}),e.jsxs(Pe,{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:[e.jsx("p",{className:"text-sm text-amber-500 font-bold uppercase tracking-wider mb-2",children:" This will:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1 list-disc list-inside font-medium",children:[e.jsx("li",{children:"Create final standings snapshots for all active players"}),e.jsx("li",{children:"Archive the current season permanently"}),e.jsx("li",{children:"Reset all player ratings to NULL (inactive)"}),e.jsx("li",{children:"Create a new active season for fresh matches"})]})]}),e.jsx(Ce,{onClick:H,disabled:T||!c,size:"lg",className:"w-full font-heading font-bold uppercase tracking-wider bg-amber-600 hover:bg-amber-700 text-white",children:T?"Archiving Season...":"Archive Season & Start New"}),q&&!q.success&&e.jsxs("div",{className:"p-4 bg-destructive/10 border border-destructive rounded-lg",children:[e.jsx("p",{className:"text-destructive font-bold uppercase tracking-wider text-xs",children:"Error"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:q.error})]}),q&&q.success&&e.jsxs("div",{className:"p-4 bg-green-500/10 border border-green-500 rounded-lg",children:[e.jsx("p",{className:"text-green-500 font-bold uppercase tracking-wider text-xs",children:" Season Archived!"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Season has been archived and a new active season created."})]})]})]}),e.jsxs(Fe,{className:"bg-card/50 border-border/50",children:[e.jsxs(Ye,{children:[e.jsx(Ze,{className:"font-heading text-2xl",children:"Season History"}),e.jsx(it,{children:'Previously archived seasons. Click "Activate" to restore a season as the current active season.'})]}),e.jsxs(Pe,{children:[w?e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading..."}):x.filter(S=>S.status==="archived").length>0?e.jsx("div",{className:"space-y-3",children:x.filter(S=>S.status==="archived").sort((S,D)=>D.id-S.id).map(S=>e.jsx("div",{className:"p-4 bg-background/50 border border-border/40 rounded-lg hover:border-primary/30 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-heading font-bold text-lg",children:S.name}),e.jsxs("p",{className:"text-xs text-muted-foreground font-mono",children:[new Date(S.start_date).toLocaleDateString(),S.end_date&&` - ${new Date(S.end_date).toLocaleDateString()}`]}),S.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1 italic",children:S.description})]}),e.jsx(Ce,{onClick:()=>ne(S.id),disabled:G&&P===S.id,size:"sm",variant:"outline",className:"font-bold uppercase tracking-wider text-xs",children:G&&P===S.id?"Activating...":"Activate"})]})},S.id))}):e.jsx("p",{className:"text-sm text-muted-foreground italic",children:"No archived seasons yet"}),Y&&!Y.success&&e.jsxs("div",{className:"mt-4 p-4 bg-destructive/10 border border-destructive rounded-lg",children:[e.jsx("p",{className:"text-destructive font-bold uppercase tracking-wider text-xs",children:"Error"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Y.error})]}),Y&&Y.success&&e.jsxs("div",{className:"mt-4 p-4 bg-green-500/10 border border-green-500 rounded-lg",children:[e.jsx("p",{className:"text-green-500 font-bold uppercase tracking-wider text-xs",children:" Season Activated!"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Season has been restored as the active season and player ratings have been restored."})]})]})]})]}),e.jsx(Zt,{value:"tools",className:"space-y-6 m-0",children:e.jsxs(Fe,{className:"bg-card/50 border-border/50",children:[e.jsxs(Ye,{children:[e.jsx(Ze,{className:"font-heading text-2xl",children:"Calculate Season Ratings"}),e.jsx(it,{children:"Calculate ratings for seasons. Select the active season to recalculate current season, or archived seasons to retroactively calculate."})]}),e.jsxs(Pe,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold uppercase tracking-wider text-muted-foreground",children:"Select Season"}),e.jsxs(vs,{value:he!==null?he.toString():"",onValueChange:S=>{const D=S?parseInt(S):null;K(D)},children:[e.jsx(Hr,{className:"w-full bg-background/50 border-primary/30",children:e.jsx(ys,{placeholder:"Choose a season..."})}),e.jsx(qr,{children:x.sort((S,D)=>S.id===0?-1:D.id===0?1:S.id-D.id).map(S=>e.jsxs(Rt,{value:S.id.toString(),children:[S.name," ",S.status==="active"?"(Active)":""]},S.id))})]})]}),e.jsx(Ce,{onClick:()=>he!==null&&F(he),disabled:he===null||me.status==="running",size:"lg",className:"w-full font-heading font-bold uppercase tracking-wider",children:me.status==="running"?"Calculating...":"Calculate Season Ratings"}),me.status==="running"&&e.jsxs("div",{className:"space-y-2 p-4 bg-background/30 rounded-lg border border-border/30",children:[e.jsxs("div",{className:"flex justify-between text-xs font-bold uppercase tracking-wider text-muted-foreground",children:[e.jsxs("span",{children:["Processing match ",me.currentMatch]}),e.jsxs("span",{children:[me.processedMatches," / ",me.totalMatches]})]}),e.jsx("div",{className:"w-full bg-secondary/50 rounded-full h-2.5 overflow-hidden",children:e.jsx("div",{className:"bg-primary h-2.5 rounded-full transition-all duration-300 shadow-[0_0_10px_rgba(var(--primary-rgb),0.5)]",style:{width:`${fe()}%`}})}),e.jsxs("div",{className:"text-center text-sm font-bold text-primary",children:[fe(),"%"]})]}),X&&!X.success&&e.jsxs("div",{className:"p-4 bg-destructive/10 border border-destructive rounded-lg",children:[e.jsx("p",{className:"text-destructive font-bold uppercase tracking-wider text-xs",children:"Error"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:X.error})]}),X&&X.success&&e.jsxs("div",{className:"p-4 bg-green-500/10 border border-green-500 rounded-lg",children:[e.jsx("p",{className:"text-green-500 font-bold uppercase tracking-wider text-xs",children:" Success!"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Created ",X.eventsCreated," rating events and snapshots for this season."]})]})]})]})})]})]})]}):e.jsx("div",{className:"container py-8",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs(Fe,{children:[e.jsxs(Ye,{children:[e.jsx(Ze,{children:"Access Denied"}),e.jsx(it,{children:"You don't have admin privileges. Please contact an administrator."})]}),e.jsxs(Pe,{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Your user ID: ",e.jsx("code",{className:"bg-muted px-1 py-0.5 rounded",children:r.user.id})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"To grant yourself admin access, run this SQL in Supabase Studio:"}),e.jsx("pre",{className:"bg-muted p-3 rounded mt-2 text-xs overflow-x-auto",children:`UPDATE auth.users
SET raw_app_meta_data = COALESCE(raw_app_meta_data, '{}'::jsonb) || jsonb_build_object('role', 'admin')
WHERE id = '${r.user.id}';`}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Then refresh this page."})]})]})})}):e.jsx(jn,{to:"/login",replace:!0})}function Zi(){pt("Upcoming Matches");const[r,s]=b.useState([]),[n,c]=b.useState([]),[y,x]=b.useState([]),[h,w]=b.useState(!0);b.useEffect(()=>{let R=!0;return(async()=>{const[T,W,q]=await Promise.all([ga(),Lh(),zh()]);R&&(s(T),c(W),x(q),w(!1))})(),()=>{R=!1}},[]);const E=b.useMemo(()=>{if(!r.length||!n.length)return[];const R=new Map(r.map(T=>[T.id,T]));return n.map(T=>({...T,matches:y.filter(W=>W.event_id===T.id).map(W=>({...W,player1:R.get(W.player1_id),player2:R.get(W.player2_id)})).sort((W,q)=>(W.match_order??0)-(q.match_order??0))}))},[r,n,y]),A=R=>{const T=new Date(R);return T.setHours(T.getHours()+3),T.toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"})};return h?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Upcoming Matches"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]}):E.length===0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Upcoming Matches"}),e.jsx(Fe,{children:e.jsx(Pe,{className:"pt-6",children:e.jsx("p",{className:"text-muted-foreground",children:"No upcoming events scheduled."})})})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-primary/30 pb-4",children:[e.jsx("h1",{className:"text-4xl font-heading font-bold text-primary drop-shadow-[0_0_10px_rgba(234,179,8,0.3)] uppercase tracking-widest",children:"Upcoming Battles"}),e.jsx("div",{className:"h-1 w-24 bg-primary/50 rounded-full"})]}),E.map(R=>e.jsxs(Fe,{className:"bg-card/80 backdrop-blur-md border-border/60 shadow-lg overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-primary/50 group-hover:bg-primary transition-colors"}),e.jsx(Ye,{className:"bg-muted/30 border-b border-border/30 pb-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs(Ze,{className:"font-heading text-2xl text-foreground tracking-wide flex items-center gap-3",children:[R.title,e.jsx("span",{className:"text-xs font-body font-normal text-muted-foreground px-2 py-0.5 border border-border rounded uppercase tracking-wider",children:"Event"})]}),e.jsxs(it,{className:"font-body text-base mt-1 flex items-center gap-2",children:[e.jsx("span",{className:"text-primary",children:""})," ",A(R.event_date)]}),R.description&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-3 italic border-l-2 border-primary/30 pl-3",children:['"',R.description,'"']})]}),R.stream_url&&e.jsx("a",{href:R.stream_url,target:"_blank",rel:"noopener noreferrer",className:"px-6 py-2 bg-primary/10 border border-primary/50 text-primary hover:bg-primary hover:text-primary-foreground transition-all duration-300 text-sm font-heading font-bold uppercase tracking-wider rounded-sm shadow-[0_0_10px_rgba(234,179,8,0.1)] hover:shadow-[0_0_15px_rgba(234,179,8,0.4)]",children:"Watch Stream"})]})}),e.jsx(Pe,{className:"pt-6",children:R.matches.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground italic font-body",children:"No battles scheduled for this event yet."}):e.jsx("div",{className:"space-y-4",children:R.matches.map((T,W)=>{const{player1:q,player2:$}=T;if(!q||!$)return e.jsxs("div",{className:"p-4 border border-destructive/30 bg-destructive/10 rounded text-destructive text-center font-heading",children:["Match ",W+1,": Player data missing"]},T.id);const P=ip(q,$);return e.jsxs("div",{className:"relative p-4 border border-border/40 bg-background/40 rounded-sm hover:border-primary/50 transition-colors group/match",children:[e.jsxs("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-background px-2 text-xs font-heading font-bold text-muted-foreground uppercase tracking-widest border border-border/30 rounded-full",children:["Match ",W+1]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsxs(Ke,{to:`/players/${q.id}`,className:"relative shrink-0 group/p1",children:[e.jsx("div",{className:"absolute inset-0 bg-primary/20 rounded-full blur-md opacity-0 group-hover/p1:opacity-100 transition-opacity"}),e.jsx(mt,{name:q.name,twitter:q.twitter,size:56,className:"h-14 w-14 border-2 border-border group-hover/p1:border-primary transition-colors relative z-10"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(Ke,{to:`/players/${q.id}`,className:"hover:text-primary transition-colors block",children:e.jsx("div",{className:"font-heading font-bold text-lg leading-tight truncate",children:q.name})}),e.jsxs("div",{className:"text-xs font-body text-muted-foreground uppercase tracking-wider mt-0.5",children:["Rating: ",e.jsx("span",{className:"text-foreground font-bold",children:q.rating===null?"Unrated":Math.round(q.rating)})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs font-bold",children:[e.jsxs("span",{className:"text-green-500 drop-shadow-[0_0_5px_rgba(34,197,94,0.3)]",children:["+",yr(P.player1.winRatingChange)]}),e.jsx("span",{className:"text-red-500 drop-shadow-[0_0_5px_rgba(239,68,68,0.3)]",children:yr(P.player1.loseRatingChange)})]})]})]}),e.jsx("div",{className:"font-heading font-black text-2xl text-primary/20 shrink-0 px-4 select-none group-hover/match:text-primary/40 transition-colors italic",children:"VS"}),e.jsxs("div",{className:"flex items-center gap-4 flex-1 flex-row-reverse text-right",children:[e.jsxs(Ke,{to:`/players/${$.id}`,className:"relative shrink-0 group/p2",children:[e.jsx("div",{className:"absolute inset-0 bg-primary/20 rounded-full blur-md opacity-0 group-hover/p2:opacity-100 transition-opacity"}),e.jsx(mt,{name:$.name,twitter:$.twitter,size:56,className:"h-14 w-14 border-2 border-border group-hover/p2:border-primary transition-colors relative z-10"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(Ke,{to:`/players/${$.id}`,className:"hover:text-primary transition-colors block",children:e.jsx("div",{className:"font-heading font-bold text-lg leading-tight truncate",children:$.name})}),e.jsxs("div",{className:"text-xs font-body text-muted-foreground uppercase tracking-wider mt-0.5",children:["Rating: ",e.jsx("span",{className:"text-foreground font-bold",children:$.rating===null?"Unrated":Math.round($.rating)})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 mt-1 text-xs font-bold",children:[e.jsxs("span",{className:"text-green-500 drop-shadow-[0_0_5px_rgba(34,197,94,0.3)]",children:["+",yr(P.player2.winRatingChange)]}),e.jsx("span",{className:"text-red-500 drop-shadow-[0_0_5px_rgba(239,68,68,0.3)]",children:yr(P.player2.loseRatingChange)})]})]})]})]})]},T.id)})})})]},R.id))]})}const ko=b.createContext(void 0);function Rp(){return typeof window>"u"?"light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Ki(r){const s=document.documentElement,n=r==="system"?Rp():r;s.classList.remove("light","dark"),n==="dark"?s.classList.add("dark"):s.classList.add("light")}function Tp({children:r,defaultTheme:s="system",storageKey:n="vite-ui-theme"}){const[c,y]=b.useState(()=>typeof window>"u"?s:window.localStorage.getItem(n)??s);b.useEffect(()=>{Ki(c);try{window.localStorage.setItem(n,c)}catch{}},[c,n]),b.useEffect(()=>{if(c!=="system"||typeof window>"u")return;const h=window.matchMedia("(prefers-color-scheme: dark)"),w=()=>Ki("system");try{h.addEventListener("change",w)}catch{h.addListener(w)}return()=>{try{h.removeEventListener("change",w)}catch{h.removeListener(w)}}},[c]);const x=b.useMemo(()=>({theme:c,setTheme:y}),[c]);return e.jsx(ko.Provider,{value:x,children:r})}function Dp(){const r=b.useContext(ko);if(!r)throw new Error("useTheme must be used within ThemeProvider");return r}function Op(){const{theme:r,setTheme:s}=Dp(),n=r==="system"?window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":r,c=n==="light"?"dark":"light",y=n==="light"?"Switch to dark":"Switch to light";return e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs(Ce,{variant:"ghost",size:"icon","aria-label":y,title:y,onClick:()=>s(c),className:"relative h-10 w-10",children:[e.jsx(uu,{className:"absolute h-6 w-6 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),e.jsx(nu,{className:"absolute h-6 w-6 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"})]})})}function zp({matchId:r,open:s,onOpenChange:n}){const{players:c,matches:y}=fs(),[x,h]=b.useState(null),[w,E]=b.useState(null),[A,R]=b.useState({}),[T,W]=b.useState(null),[q,$]=b.useState(!1),P=b.useMemo(()=>y.find(L=>L.id===r),[y,r]),M=b.useMemo(()=>P||T,[P,T]),G=c.find(L=>L.id===(M==null?void 0:M.player1_id)),ae=c.find(L=>L.id===(M==null?void 0:M.player2_id));b.useEffect(()=>{if(!r||P)return;let L=!0;return $(!0),(async()=>{try{const{data:X,error:oe}=await se.from("matches").select("id, player1_id, player2_id, winner_id, player1_score, player2_score, rating_change_p1, rating_change_p2, event_id, match_order, vod_link, season_id").eq("id",r).single();if(!L)return;if(oe){console.warn("Failed to fetch match from server:",oe),W(null),$(!1);return}X&&(console.log("Fetched match from server:",X),W(X)),$(!1)}catch(X){if(!L)return;console.warn("Error fetching match from server:",X),W(null),$(!1)}})(),()=>{L=!1}},[r,P]),b.useEffect(()=>{let L=!0;return M!=null&&M.id?((async()=>{try{const{data:X,error:oe}=await se.from("rating_events").select("player_id, rating, rating_change, event_type").eq("match_id",M.id);if(!L)return;if(oe){console.warn("Failed to fetch rating events for match",M.id,oe),R({});return}const Ne={};for(const H of X??[])(H==null?void 0:H.event_type)!=="match"||typeof(H==null?void 0:H.player_id)!="number"||(Ne[H.player_id]={rating:typeof H.rating=="number"?H.rating:H.rating??null,rating_change:typeof H.rating_change=="number"?H.rating_change:H.rating_change??null});R(Ne)}catch(X){if(!L)return;console.warn("Failed to load rating events for match",M.id,X),R({})}})(),()=>{L=!1}):(R({}),()=>{L=!1})},[M==null?void 0:M.id]);const Y=b.useMemo(()=>{if(!M)return{p1:null,p2:null};const L=(H,ne)=>{if(!H)return null;const F=y.filter(z=>z.id>M.id&&(z.player1_id===H.id||z.player2_id===H.id));let fe=H.rating??1500;for(const z of F){const ce=z.player1_id===H.id?z.rating_change_p1??0:z.rating_change_p2??0;fe-=ce}const S=ne??null,D=S!==null?fe-S:null;return{ratingAfter:Number.isFinite(fe)?fe:null,ratingBefore:D!==null&&Number.isFinite(D)?D:null,ratingChange:S}},X=(H,ne)=>{if(!H)return null;const F=A[H.id];if(!F)return null;const fe=F.rating_change??ne??null,S=F.rating??null,D=fe!==null&&S!==null?S-fe:null;return{ratingAfter:S,ratingBefore:D,ratingChange:fe}},oe=L(G,M.rating_change_p1??null),Ne=L(ae,M.rating_change_p2??null);return{p1:X(G,M.rating_change_p1??null)??oe,p2:X(ae,M.rating_change_p2??null)??Ne}},[M,G,ae,y,A]),le=Y.p1,he=Y.p2,K=(le==null?void 0:le.ratingChange)??(M==null?void 0:M.rating_change_p1)??null,me=(he==null?void 0:he.ratingChange)??(M==null?void 0:M.rating_change_p2)??null;return b.useEffect(()=>{if(!(M!=null&&M.event_id)){h(null);return}let L=!0;return(async()=>{const X=await Wr();if(!L)return;const oe=X.find(Ne=>Ne.id===M.event_id);h((oe==null?void 0:oe.title)??null)})(),()=>{L=!1}},[M==null?void 0:M.event_id]),b.useEffect(()=>{if(!(M!=null&&M.season_id)){E(null);return}let L=!0;return(async()=>{try{const{data:X,error:oe}=await se.from("seasons").select("name").eq("id",M.season_id).single();if(!L)return;if(oe){console.warn("Failed to fetch season",oe),E(null);return}E((X==null?void 0:X.name)??null)}catch(X){if(!L)return;console.warn("Failed to load season",X),E(null)}})(),()=>{L=!1}},[M==null?void 0:M.season_id]),M?e.jsx(Nr,{open:s,onOpenChange:n,children:e.jsxs(Qt,{className:"w-[95vw] max-w-4xl bg-card/90 backdrop-blur-xl border-primary/50 shadow-[0_0_50px_rgba(0,0,0,0.5)] p-0 overflow-hidden max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-primary to-transparent"}),e.jsx(er,{className:"sr-only",children:e.jsx(tr,{children:"Match Details"})}),e.jsxs("div",{className:"relative p-4 sm:p-6 md:p-10 space-y-6 md:space-y-8",children:[e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-primary/10 via-background/50 to-background pointer-events-none"}),e.jsxs("div",{className:"relative z-10 grid grid-cols-[1fr_auto_1fr] gap-2 sm:gap-4 md:gap-8 items-start",children:[e.jsx("div",{className:"flex flex-col items-center gap-2 sm:gap-4 md:gap-6",children:G&&e.jsxs(e.Fragment,{children:[e.jsxs(Ke,{className:"group flex flex-col items-center",to:`/players/${G.id}`,onClick:()=>n(!1),children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-primary/30 rounded-full blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),e.jsx(mt,{name:G.name,twitter:G.twitter,size:120,className:`h-16 w-16 sm:h-20 sm:w-20 md:h-32 md:w-32 mx-auto border-2 sm:border-4 transition-all duration-300 ${M.winner_id===M.player1_id?"border-yellow-500 shadow-[0_0_20px_rgba(234,179,8,0.5)]":"border-border group-hover:border-primary"}`})]}),e.jsx("div",{className:"font-heading font-bold text-sm sm:text-lg md:text-2xl mt-2 sm:mt-4 group-hover:text-primary transition-colors text-center tracking-wide line-clamp-2",children:G.name})]}),e.jsx("div",{className:`w-full rounded-lg border p-2 sm:p-3 md:p-4 backdrop-blur-sm transition-colors ${M.winner_id===M.player1_id?"border-yellow-500/50 bg-yellow-500/5":"border-border/50 bg-card/30"}`,children:e.jsxs("div",{className:"text-center space-y-1 sm:space-y-2 md:space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl sm:text-4xl md:text-6xl font-heading font-black mb-0.5 sm:mb-1 drop-shadow-lg",style:{color:M.winner_id===M.player1_id?"#eab308":"hsl(var(--muted-foreground))"},children:M.player1_score??"?"}),M.winner_id===M.player1_id&&e.jsx("div",{className:"text-[10px] sm:text-xs md:text-sm font-heading font-bold text-yellow-500 uppercase tracking-widest",children:"Victory"})]}),K!==null&&e.jsxs("div",{className:"pt-1 sm:pt-2 md:pt-3 border-t border-border/30 space-y-1 sm:space-y-2",children:[e.jsx("div",{className:"text-[10px] sm:text-xs text-muted-foreground font-heading uppercase tracking-widest hidden sm:block",children:"Rating"}),e.jsxs("div",{className:"inline-flex items-center gap-1 sm:gap-2 text-sm sm:text-lg md:text-xl font-bold font-mono",children:[(K??0)>=0?e.jsx(vr,{size:14,className:"text-green-500 sm:w-5 sm:h-5"}):e.jsx(br,{size:14,className:"text-red-500 sm:w-5 sm:h-5"}),e.jsx("span",{className:(K??0)>=0?"text-green-500":"text-red-500",children:Math.abs(K??0).toFixed(1)})]}),le&&le.ratingBefore!==null&&le.ratingAfter!==null&&e.jsxs("div",{className:"hidden sm:flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm text-muted-foreground font-mono",children:[e.jsx("span",{className:"font-semibold text-foreground",children:Math.round(le.ratingBefore)}),e.jsx("span",{className:(K??0)>=0?"text-green-500":"text-red-500",children:""}),e.jsx("span",{className:"font-semibold text-foreground",children:Math.round(le.ratingAfter)})]})]})]})})]})}),e.jsx("div",{className:"flex flex-col items-center justify-center py-2 sm:py-4 md:py-0",children:e.jsx("div",{className:"text-2xl sm:text-4xl md:text-7xl font-heading font-black text-transparent bg-clip-text bg-gradient-to-b from-yellow-300 to-yellow-700 drop-shadow-[0_2px_4px_rgba(0,0,0,0.8)] italic",children:"VS"})}),e.jsx("div",{className:"flex flex-col items-center gap-2 sm:gap-4 md:gap-6",children:ae&&e.jsxs(e.Fragment,{children:[e.jsxs(Ke,{className:"group flex flex-col items-center",to:`/players/${ae.id}`,onClick:()=>n(!1),children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-primary/30 rounded-full blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),e.jsx(mt,{name:ae.name,twitter:ae.twitter,size:120,className:`h-16 w-16 sm:h-20 sm:w-20 md:h-32 md:w-32 mx-auto border-2 sm:border-4 transition-all duration-300 ${M.winner_id===M.player2_id?"border-yellow-500 shadow-[0_0_20px_rgba(234,179,8,0.5)]":"border-border group-hover:border-primary"}`})]}),e.jsx("div",{className:"font-heading font-bold text-sm sm:text-lg md:text-2xl mt-2 sm:mt-4 group-hover:text-primary transition-colors text-center tracking-wide line-clamp-2",children:ae.name})]}),e.jsx("div",{className:`w-full rounded-lg border p-2 sm:p-3 md:p-4 backdrop-blur-sm transition-colors ${M.winner_id===M.player2_id?"border-yellow-500/50 bg-yellow-500/5":"border-border/50 bg-card/30"}`,children:e.jsxs("div",{className:"text-center space-y-1 sm:space-y-2 md:space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl sm:text-4xl md:text-6xl font-heading font-black mb-0.5 sm:mb-1 drop-shadow-lg",style:{color:M.winner_id===M.player2_id?"#eab308":"hsl(var(--muted-foreground))"},children:M.player2_score??"?"}),M.winner_id===M.player2_id&&e.jsx("div",{className:"text-[10px] sm:text-xs md:text-sm font-heading font-bold text-yellow-500 uppercase tracking-widest",children:"Victory"})]}),me!==null&&e.jsxs("div",{className:"pt-1 sm:pt-2 md:pt-3 border-t border-border/30 space-y-1 sm:space-y-2",children:[e.jsx("div",{className:"text-[10px] sm:text-xs text-muted-foreground font-heading uppercase tracking-widest hidden sm:block",children:"Rating"}),e.jsxs("div",{className:"inline-flex items-center gap-1 sm:gap-2 text-sm sm:text-lg md:text-xl font-bold font-mono",children:[(me??0)>=0?e.jsx(vr,{size:14,className:"text-green-500 sm:w-5 sm:h-5"}):e.jsx(br,{size:14,className:"text-red-500 sm:w-5 sm:h-5"}),e.jsx("span",{className:(me??0)>=0?"text-green-500":"text-red-500",children:Math.abs(me??0).toFixed(1)})]}),he&&he.ratingBefore!==null&&he.ratingAfter!==null&&e.jsxs("div",{className:"hidden sm:flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm text-muted-foreground font-mono",children:[e.jsx("span",{className:"font-semibold text-foreground",children:Math.round(he.ratingBefore)}),e.jsx("span",{className:(me??0)>=0?"text-green-500":"text-red-500",children:""}),e.jsx("span",{className:"font-semibold text-foreground",children:Math.round(he.ratingAfter)})]})]})]})})]})})]}),(M.event_id||M.vod_link||w)&&e.jsxs("div",{className:"relative z-10 flex flex-col sm:flex-row items-center justify-center gap-2 sm:gap-4 md:gap-6 pt-4 sm:pt-6 border-t border-border/30",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 sm:gap-4",children:[w&&e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1 rounded-full bg-muted/20 border border-border/30",children:[e.jsx("span",{className:"text-[10px] sm:text-xs text-muted-foreground uppercase tracking-wider font-heading",children:"Season"}),e.jsx("span",{className:"font-bold text-xs sm:text-sm",children:w})]}),M.event_id&&e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1 rounded-full bg-muted/20 border border-border/30",children:[e.jsx("span",{className:"text-[10px] sm:text-xs text-muted-foreground uppercase tracking-wider font-heading",children:"Event"}),e.jsx(Ke,{className:"text-primary hover:text-primary/80 hover:underline font-bold text-xs sm:text-sm transition-colors max-w-[100px] sm:max-w-none truncate",to:`/events/${M.event_id}`,onClick:()=>n(!1),children:x??"Loading..."})]})]}),M.vod_link&&e.jsxs("a",{href:M.vod_link,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 sm:gap-2 px-3 sm:px-4 py-1.5 sm:py-2 rounded bg-red-600 hover:bg-red-700 text-white font-heading font-bold text-xs sm:text-sm uppercase tracking-wider transition-colors shadow-lg hover:shadow-red-600/20",children:[M.vod_link.includes("youtube.com")||M.vod_link.includes("youtu.be")?e.jsx(Hn,{className:"h-3 w-3 sm:h-4 sm:w-4"}):M.vod_link.includes("twitch.tv")?e.jsx("svg",{className:"h-3 w-3 sm:h-4 sm:w-4",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M11.571 4.714h1.715v5.143H11.57zm4.715 0H18v5.143h-1.714zM6 0L1.714 4.286v15.428h5.143V24l4.286-4.286h3.428L22.286 12V0zm14.571 11.143l-3.428 3.428h-3.429l-3 3v-3H6.857V1.714h13.714Z"})}):e.jsx(Pn,{className:"h-3 w-3 sm:h-4 sm:w-4"}),"Watch"]})]})]})]})}):e.jsx(Nr,{open:s,onOpenChange:n,children:e.jsxs(Qt,{children:[e.jsx(er,{children:e.jsx(tr,{children:"Match Not Found"})}),q?e.jsx("p",{className:"text-muted-foreground text-sm",children:"Fetching match data from server..."}):e.jsx("p",{className:"text-muted-foreground text-sm",children:"The match you're looking for doesn't exist."})]})})}function Ip(){const{session:r,loading:s,signOut:n}=ya(),[c,y]=b.useState(!1),{matchId:x,closeMatch:h}=js();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"min-h-screen bg-background text-foreground font-body selection:bg-primary selection:text-primary-foreground",children:[e.jsx("nav",{className:"border-b border-border/60 bg-card/50 backdrop-blur-sm sticky top-0 z-50",children:e.jsxs("div",{className:"container flex items-center gap-4 md:gap-8 py-3 md:py-4 flex-wrap",children:[e.jsx(zt,{to:"/",className:"shrink-0 group",children:e.jsx("div",{className:"bg-red-800 px-4 py-2 rounded-md shadow-lg group-hover:shadow-xl transition-all group-hover:scale-105 border border-red-700",children:e.jsx("span",{className:"font-heading font-black text-xl tracking-widest text-white",children:"OFC"})})}),e.jsxs("div",{className:"hidden md:flex gap-6 text-sm font-heading font-bold tracking-wider uppercase",children:[e.jsx(zt,{to:"/rankings",className:({isActive:w})=>`transition-colors hover:text-primary ${w?"text-primary drop-shadow-[0_0_8px_rgba(234,179,8,0.4)]":"text-muted-foreground"}`,children:"Rankings"}),e.jsx(zt,{to:"/matches",className:({isActive:w})=>`transition-colors hover:text-primary ${w?"text-primary drop-shadow-[0_0_8px_rgba(234,179,8,0.4)]":"text-muted-foreground"}`,children:"Matches"}),e.jsx(zt,{to:"/events",className:({isActive:w})=>`transition-colors hover:text-primary ${w?"text-primary drop-shadow-[0_0_8px_rgba(234,179,8,0.4)]":"text-muted-foreground"}`,children:"Events"})]}),e.jsxs("div",{className:"ml-auto flex items-center gap-2 md:gap-4 min-w-0",children:[s?e.jsx("div",{className:"h-8 w-24 animate-pulse rounded-md bg-muted","aria-hidden":!0}):r?e.jsx(Ce,{variant:"ghost",size:"sm",onClick:n,className:"font-heading uppercase tracking-wider hover:text-primary hover:bg-primary/10",children:"Sign out"}):e.jsx(Ce,{asChild:!0,variant:"outline",size:"sm",className:"font-heading uppercase tracking-wider border-primary/50 hover:border-primary hover:bg-primary/10 text-primary",children:e.jsx(zt,{to:"/login",children:"Login"})}),e.jsx(Op,{}),e.jsx("button",{type:"button","aria-label":"Toggle menu","aria-expanded":c,className:"inline-flex h-9 w-9 items-center justify-center rounded-md hover:bg-accent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring md:hidden text-primary",onClick:()=>y(w=>!w),children:c?e.jsx(bs,{className:"h-5 w-5"}):e.jsx(au,{className:"h-5 w-5"})})]}),e.jsx("div",{className:`${c?"block":"hidden"} w-full md:hidden border-t border-border/50 mt-2`,onClick:()=>y(!1),children:e.jsxs("div",{className:"flex flex-col gap-2 pt-4 pb-3 text-sm font-heading font-bold tracking-wider uppercase",children:[e.jsx(zt,{to:"/rankings",className:({isActive:w})=>w?"text-primary pl-2 border-l-2 border-primary":"text-muted-foreground pl-2 border-l-2 border-transparent",children:"Rankings"}),e.jsx(zt,{to:"/matches",className:({isActive:w})=>w?"text-primary pl-2 border-l-2 border-primary":"text-muted-foreground pl-2 border-l-2 border-transparent",children:"Matches"}),e.jsx(zt,{to:"/events",className:({isActive:w})=>w?"text-primary pl-2 border-l-2 border-primary":"text-muted-foreground pl-2 border-l-2 border-transparent",children:"Events"})]})})]})}),e.jsx("main",{className:"container py-8 md:py-12",children:e.jsxs(Ac,{children:[e.jsx(ut,{path:"/",element:e.jsx(Zi,{})}),e.jsx(ut,{path:"/rankings",element:e.jsx(Su,{})}),e.jsx(ut,{path:"/players",element:e.jsx(jn,{to:"/rankings",replace:!0})}),e.jsx(ut,{path:"/players/:id",element:e.jsx(hp,{})}),e.jsx(ut,{path:"/matches",element:e.jsx(rp,{})}),e.jsx(ut,{path:"/events",element:e.jsx(sp,{})}),e.jsx(ut,{path:"/events/:id",element:e.jsx(op,{})}),e.jsx(ut,{path:"/upcoming",element:e.jsx(Zi,{})}),e.jsx(ut,{path:"/profile",element:e.jsx(lp,{})}),e.jsx(ut,{path:"/login",element:e.jsx(pp,{})}),e.jsx(ut,{path:"/admin",element:e.jsx(Ep,{})}),e.jsx(ut,{path:"*",element:e.jsx(mp,{})})]})})]}),e.jsx(zp,{matchId:x,open:x!==null,onOpenChange:w=>!w&&h()})]})}function Lp(){return e.jsx(tp,{children:e.jsx(Ip,{})})}ia.createRoot(document.getElementById("root")).render(e.jsx(bn.StrictMode,{children:e.jsx(up,{children:e.jsx(Tp,{defaultTheme:"dark",storageKey:"scelo-theme",children:e.jsx(Th,{children:e.jsx(Ec,{children:e.jsx(Lp,{})})})})})}));
